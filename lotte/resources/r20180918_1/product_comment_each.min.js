!function(a,b,c){"use strict";var d=b.module("lotteVideo",[]);d.controller("LotteVideoCtrl",["$scope",function(a){}]),d.directive("lotteVideo",["$window","$timeout","LotteUtil",function(c,d,e){return{controller:"LotteVideoCtrl",link:function(c,f,g,h){function i(){n.src="",d(function(){n.src=j},300),q.appObj.isIOS||n.removeAttribute("controls"),c.movMode=0,c.$apply()}c.movMode=0,c.mute=!1;var j=g.lvSrc,k=g.lvDetailUrl,l=g.lvNoAlert,m=g.lvPoster,n=b.element(f).find("video")[0],o=g.lvTime||2e3;n.setAttribute("poster",m),n.addEventListener("ended",i,!1);var p={play:function(){a.videoStateModel.setPlay(!0,String(9999999*Math.random()))},pause:function(){a.videoStateModel.setPlay(!1)}};n.addEventListener("play",p.play,!1),n.addEventListener("pause",p.pause,!1);var q=e.getAbsScope(c);c.playVideo=function(){if(l||confirm("3G/LTE에서 재생시 데이터 요금이 부과할 수 있으니 유의하세요~")){var a=b.element(document.body).data("play_video")||"";if(a){var e=b.element("#"+a);if(e&&e.length>0){e[0].pause();var g=e.scope();g.movMode=0}}c.movMode=1,n.src||(n.src=j),n.play(),b.element(document.body).data("play_video",b.element(n).attr("id")),d(function(){1==c.movMode&&$(f).find(".btns").fadeOut(600,function(){c.movMode=2,$(this).attr("style",""),c.$apply()})},o)}},c.clickCover=function(){c.movMode=1,d(function(){1==c.movMode&&$(f).find(".btns").fadeOut(600,function(){c.movMode=2,$(this).attr("style",""),c.$apply()})},o)},c.stopVideo=function(){n.pause(),c.movMode=0},c.muteVideo=function(){n.muted?(c.mute=!1,n.muted=!1):(c.mute=!0,n.muted=!0)},c.fullVideo=function(){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.webkitEnterFullscreen&&n.webkitEnterFullscreen(),q.appObj.isIOS||n.setAttribute("controls","controls")},c.goDetailPage=function(){location.href=k},b.element(f).find("video").bind("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(a){var b=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen,d=b?"FullscreenOn":"FullscreenOff";"FullscreenOff"==d&&(c.stopVideo(),q.appObj.isIOS||n.removeAttribute("controls"),c.$apply())})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("product-sub-header",[]);d.directive("productSubHeader",["$http","$timeout","$window","$location","LotteCommon","LotteCookie","LotteStorage","LotteUtil",function(a,b,c,d,e,f,g,h){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_sub_header.html",replace:!0,link:function(a,b,c){a.gotoPrepage=function(){a.jsonLoading=!0,a.sendTclick("m_RDC_header_new_pre"),a.appObj.isNativeHeader?appSendBack():history.go(-1)}}}}]),"undefined"!=typeof module&&module.exports&&(module.exports=d.name)}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","product-sub-header","lotteVideo"]);d.controller("ProductCommentEachCtrl",["$window","$http","$scope","$timeout","$compile","LotteCommon","commInitData","LotteGA",function(a,d,e,f,g,h,i,j){function k(a,b,d){return a!=c&&null!=a&&""!=a&&(a=a.split(b).join(d)),a}e.showWrap=!0,e.contVisible=!0,e.productSubTitle="상품평 상세보기",e.screenID="product_comment_each",e.jsonLoading=!1,e.gaCtgName="MO_상품상세_상품평 상세보기",e.pageUI={gdasNo:null,goodsNo:null,usmGoodsNo:"",loadData:null},e.dummyUrl="http://image.lotte.com/lotte/mo2018/reviews/default_profile.png",e.pageUI.goodsNo=i.query.goods_no?i.query.goods_no:"",e.pageUI.gdasNo=i.query.gdas_no?i.query.gdas_no:null,e.pageUI.usmGoodsNo=i.query.usm_goods_no||"",e.addZero=function(a,b){for(var c=a+"",d=b||2;c.length<d;)c="0"+c;return c},e.loadData=function(){e.jsonLoading=!0,d.get(h.isTestFlag?"/json/product/comment_each_"+e.pageUI.goodsNo+".json":"/json/product_new/comment_each.json",{params:{goods_no:e.pageUI.goodsNo,gdas_no:e.pageUI.gdasNo,usm_goods_no:e.pageUI.usmGoodsNo}}).success(function(a){a.data&&(e.pageUI.loadData=a.data,a.data.critList&&a.data.critList.items&&a.data.critList.items[0]&&(e.pageUI.loadData.item=a.data.critList.items[0],e.pageUI.loadData.item.critCont&&(e.pageUI.loadData.item.critContHtml=k(e.pageUI.loadData.item.critCont,"\r\n","<br />"))))}).error(function(){console.log("Data Error : 상품평 상세보기 데이터 로드 실패")})["finally"](function(){e.jsonLoading=!1})},e.loadData(),e.recommClick=function(b){if(j.evtTag(e.gaCtgName,"개별상품평","추천하기"),e.loginInfo.isLogin)b.regRecommUrl&&(b.myRecomm=!0,d.get(b.regRecommUrl).success(function(a){if(a.data){if(alert(a.data.resultMsg),a.data.resultCode)switch(a.data.resultCode){case"01":case"02":b.recommCnt=b.recommCnt+1;case"03":b.recommYn=!0;case"04":break;case"05":break;case"06":b.recommYn=!1}}else alert("다시 한번 시도해주시기 바랍니다."),b.recommYn=!1}));else{alert("로그인을 해주세요.");var c="&targetUrl="+encodeURIComponent(a.location.href,"UTF-8");a.location.href=h.loginUrl+"?"+e.baseParam+c}},e.showReportPop=function(c){if(j.evtTag(e.gaCtgName,"개별상품평","신고하기"),e.loginInfo.isLogin){if(!e.pageUI.loadData.badList.items)return;d.get(h.checkCommentReport,{params:{goods_no:e.pageUI.goodsNo,gdas_no:e.pageUI.gdasNo}}).success(function(a){return a&&a.data?void("02"==a.data.resultCode||"03"==a.data.resultCode?a.data.resultMsg&&alert(a.data.resultMsg):"01"==a.data.resultCode&&(e.dimmedOpen({target:"pop_report",callback:e.hideReportPop}),e.LotteDimm.dimmedOpacity="0.6",f(function(){b.element("#lotteDimm").css("z-index","210")}),e.pageUI.gdasItem=c,e.pageUI.loadData.reportList=e.pageUI.loadData.badList.items)):void alert("다시 한번 시도해주시기 바랍니다.")}).error(function(){alert("다시 한번 시도해주시기 바랍니다.")})}else{alert("로그인을 해주세요.");var g="&targetUrl="+encodeURIComponent(a.location.href,"UTF-8");a.location.href=h.loginUrl+"?"+e.baseParam+g}},e.hideReportPop=function(){e.pageUI.loadData.reportList=null,e.dimmedClose({target:"pop_report"}),b.element("#lotteDimm").css("z-index","100")},e.productClick=function(){if(e.pageUI.goodsNo){j.evtTag(e.gaCtgName,"리뷰 상품","상품상세로 이동",e.pageUI.goodsNo);var b=h.productviewUrl+"?"+e.baseParam+"&goods_no="+e.pageUI.goodsNo;f(function(){a.location.href=b},300)}},e.showReviewOne=function(a,b,c){e.dimmedOpen({callback:e.hideReviewOne,scrollEventFlag:!1}),f(function(){for(var d=0;d<a.length;d++)a[d].videoUrl=b;e.arrReviewOne=a,$("#lotteDimm").css("z-index","115"),f(function(){e.reviewSwipeCurIdx=parseInt(c,10),e.sb_review_index=parseInt(c,10)+1,e.swipeReviewControl.moveIndex(e.reviewSwipeCurIdx)},300)},200),j.evtTag(e.gaCtgName,"개별상품평","사진",e.addZero(c+1))},e.hideReviewOne=function(){e.arrReviewOne=[]},e.reviewSwipeCurIdx=0,e.sb_review_index=1,e.swipeReviewEnd=function(a){a!=e.reviewSwipeCurIdx&&(e.swipeReviewVideoStop(),e.sb_review_index=a+1,e.reviewSwipeCurIdx=a)},e.swipeReviewVideoStop=function(){$(".lv_wrap video").each(function(a,b){$(b).siblings(".stop_cover:visible, .click_cover:visible").length>=1&&f(function(){$(b).siblings(".btn_stop").trigger("click")},10)})},e.getReviewSwipeControl=function(a){e.swipeReviewControl=a,e.reviewSwipeCurIdx=e.swipeReviewControl.getIndex()},e.swipeBeforeReview=function(){0===e.reviewSwipeCurIdx?e.reviewSwipeCurIdx=e.arrReviewOne.length:e.reviewSwipeCurIdx--,e.swipeReviewControl.moveIndex(e.reviewSwipeCurIdx),1==e.sb_review_index?e.sb_review_index=e.arrReviewOne.length:e.sb_review_index--},e.swipeNextReview=function(){e.reviewSwipeCurIdx===e.arrReviewOne.length-1?e.reviewSwipeCurIdx=0:e.reviewSwipeCurIdx++,e.swipeReviewControl.moveIndex(e.reviewSwipeCurIdx),e.sb_review_index==e.arrReviewOne.length?e.sb_review_index=1:e.sb_review_index++}}]),d.directive("lotteContainer",["LotteGA","$timeout",function(a,b){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_comment_each_container.html",replace:!0,link:function(c,d,e){c.isShowBtnTalk=!1,c.goReviewerHome=function(d){if(d.reviewerHomeUrl){if(d.reviewerHomeUrl.indexOf("revr_mbr_no=")>-1){var e=d.reviewerHomeUrl.split("revr_mbr_no=");try{a.evtTag(c.gaCtgName,"리뷰어","리뷰어홈가기",e[1].split("&")[0])}catch(f){}}else d.reviewerHomeUrl.indexOf("/mylotte_crit_view.do")>-1&&a.evtTag(c.gaCtgName,"리뷰어","리뷰어홈가기",c.loginInfo.mbrNo);b(function(){location.href=d.reviewerHomeUrl.indexOf("?")>-1?d.reviewerHomeUrl+"&"+c.baseParam:d.reviewerHomeUrl+"?"+c.baseParam},300)}},c.getFlagStyle=function(a){return a?1==parseInt(a)?{"background-color":"#e6899C"}:parseInt(a)<=10?{"background-color":"#7691c6"}:{}:{}}}}}]),d.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),d.filter("starScorePolicy",function(){return function(a,b){if(!a)return 0;var d=5,e=Math.ceil(2*a)/2;return b!=c&&(e=e/d*b),e}}),d.directive("onErrorSrc",function(){return{link:function(a,b,c){b.bind("error",function(){a.pageUI.loadData.item.reviewerImgUrl!=a.dummyUrl&&(a.pageUI.loadData.item.reviewerImgUrl=a.dummyUrl)})}}}),d.directive("reportPop",["$window","$location","LotteCommon","$timeout","$parse","$http","LotteGA",function(a,b,c,d,e,f,g){return{scope:!0,link:function(b,d,e){b.sendReport=function(){if(d.find("input[type=radio]:checked").length)if(b.loginInfo.isLogin)f.get(c.commentReport,{params:{mbr_no:b.loginInfo.mbrNo,site_no:1,goods_no:b.pageUI.goodsNo,gdas_no:b.pageUI.gdasNo,dcl_accp_tp_cd:d.find("input[type=radio]:checked").val()}}).success(function(a){return a&&a.data?void(a.data.resultMsg&&(alert(a.data.resultMsg),b.hideReportPop())):void alert("다시 한번 시도해주시기 바랍니다.")}).error(function(){alert("다시 한번 시도해주시기 바랍니다.")});else{alert("로그인을 해주세요.");var e="&targetUrl="+encodeURIComponent(a.location.href,"UTF-8");a.location.href=c.loginUrl+"?"+b.baseParam+e}}}}}])}(window,window.angular);