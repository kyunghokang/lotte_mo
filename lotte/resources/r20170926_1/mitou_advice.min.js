!function(a,b,c){"use strict";b.module("dearpetSubCategory",["lotteComm"]).controller("petMallSubCtgCtrl",["$scope","commInitData",function(a,c){function d(c){var d=null;return b.forEach(a.pet_cate_data,function(a,e){return d?d:(c!=a.disp_no||d||(d=a),void b.forEach(a.sub_cate_list,function(a,e){c!=a.disp_no||d||(d=a),b.forEach(a.sub_cate_list,function(a,b){c!=a.disp_no||d||(d=a)})}))}),d}function e(b){if(b){a.pet_cate_data=b;var e=[c.query.beforeNo||null,c.query.curDispNo||null,c.query.cate3||null];e[1]==e[2]&&e.splice(2,1);for(var f=0;f<e.length;++f)if(e[f]){var g=d(e[f]);if(g&&a.pet_cate_linemap.push(g),!g.sub_cate_list)break}for(var h=a.pet_cate_linemap.length,f=h;3>f;++f){var i=a.pet_cate_linemap[a.pet_cate_linemap.length-1];if((i.sub_cate_list&&i.sub_cate_list.length||i.extra)&&g){var j=i.extra?i.extra[0]:i.sub_cate_list[0];a.pet_cate_linemap.push(j)}}a.connectCategoryDirectiveFunc&&a.connectCategoryDirectiveFunc()}}a.pet_cate_linemap=[],a.$emit("getSubCateData",e),a.connectCategoryDirectiveFunc=null,a.directiveIsCallController=function(b){return a.pet_cate_data?void b():void(a.connectCategoryDirectiveFunc=b)}}]).directive("petMallSubCtg",["$window","$timeout","LotteCommon","commInitData",function(c,d,e,f){return{templateUrl:"/lotte/resources_dev/mall/pet/dearpet_mall_sub_category.html",restrict:"E",replace:!0,link:function(g,h,i){function j(a){for(var b=0;b<g.pet_cate_linemap.length;++b)a!=b&&(g.pet_cate_linemap[b].active=!1)}function k(a){var b=e.petMallProdListUrl;if(("5566305"==a||"5566436"==a||"5566437"==a||"5566438"==a)&&(b=e.petMallgalleryUrl),"5585896"==a&&(b=e.petMalleventUrl),"5585895"==a&&(b=e.petMallStoryUrl),"5572261"==a){var c=g.pet_cate_data[6].sub_cate_list[0].disp_no;b=5585896==c?e.petMalleventUrl:e.petMallStoryUrl}return b}function l(a){if(!a)return[];if(a.length<10)return[a];for(var b=a.length/10,c=[],d=0;b>d;++d){for(var e=[],f=0;10>f;++f)a[10*d+f]&&e.push(a[10*d+f]);e.length&&c.push(e)}return c}function m(a){if(g.pet_cate_linemap[a].disp_no){switch(String(a)){case"0":g.currentCateList=l(g.pet_cate_data);break;default:g.currentCateList=l(g.pet_cate_linemap[a-1].sub_cate_list)}g.select_depth_index=a,g.swipeIndex=0,g.select_disp_no=g.pet_cate_linemap[a].disp_no}}function n(){var a=b.element(c).width();return 360>a?13:a>450&&640>a?19:a>640?31:18}function o(){for(var a=0,b=n(),c=0;c<g.pet_cate_linemap.length;++c)a+=g.pet_cate_linemap[c].disp_nm.length;if(a>b){var d=a-b,e=g.pet_cate_linemap[g.pet_cate_linemap.length-1];e.cut_name=e.disp_nm.substr(0,e.disp_nm.length-d)+"..."}}g.currentCateList,g.select_disp_no,g.chkNo,g.swipeIndex=0,g.select_depth_index=-1,g.swipe_item_width=b.element(".dearpet_mall_sub_category").width(),g.swipeSlideFinish=function(a){g.swipeIndex=a},g.subcateClick=function(a){j(a),g.currentCateList=null,g.select_disp_no=null,g.pet_cate_linemap[a].active=!g.pet_cate_linemap[a].active,g.pet_cate_linemap[a].disp_no&&g.sendTclick("m_DC_SpeDisp_Dearpet_Clk_"+g.pet_cate_linemap[a].disp_no),g.pet_cate_linemap[a].active&&m(a)},g.subcateClose=function(){g.currentCateList=null,g.select_disp_no=null,g.select_depth_index=-1,j(null)},g.subcateLink=function(b,c){if(console.log(b+"####"),b){var d="",e="",f="",h=2,i=k(b);switch(String(g.select_depth_index)){case"0":e=b;try{d=g.pet_cate_data[c].sub_cate_list[0].disp_no,d||(d=b)}catch(j){d=b}break;case"1":e=g.pet_cate_linemap[0].disp_no,d=b,h=3;break;case"2":e=g.pet_cate_linemap[0].disp_no,d=g.pet_cate_linemap[1].disp_no,f=d===b?"":b,h=3}i+="?"+g.baseParam+"&beforeNo="+e+"&curDispNo="+d+"&cate3="+f+"&chkDepth="+h,i+="&tclick=m_DC_SpeDisp_Dearpet_Clk_"+b,a.location.href=i}},g.swipeObj={getCtrl:function(a){g.swipeObj.ctrl=a},ctrl:null},g.currentSwipeCategory=function(a){a&&d(function(){g.swipeObj.ctrl.moveIndex(a)},500)},g.directiveIsCallController(function(){d(function(){try{var a=1;f.query.chkDepth&&3==g.pet_cate_linemap.length&&(a=Number(f.query.chkDepth)-1),g.pet_cate_linemap[a].active=!0,g.select_disp_no=g.pet_cate_linemap[a].disp_no,g.chkNo=a,m(a)}catch(b){}})}),b.element(c).bind("resize",function(a){o()})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","dearpetSubCategory","lotteSns"]);d.controller("MitouAdviceCtrl",["$http","$scope","$window","$location","LotteCommon","commInitData","LotteStorage","$timeout",function(c,d,e,f,g,h,i,j){function k(){o=b.element(".plan_bannerWrap iframe")[0],p=o.contentWindow,b.element(o).attr("onLoad","angular.element(this).scope().iframeOnLoaded()"),o.height="auto",a.onmessage=n,m(),a.onload=m,a.onresize=l,l(),q=a.innerWidth}function l(){if(Math.ceil(q)!=Math.ceil(a.innerWidth)){q=a.innerWidth;var c=b.element(o).attr("src");b.element(o).attr("src",c)}}function m(){p.postMessage("lotte.com","*")}function n(a){r||(r=!0,m(),"dearpet"===a.data.type&&(d.frameHeight=event.data.height+"px",o.height=event.data.height+"px"))}d.isMain=!1,d.showWrap=!0,d.contVisible=!0,d.pageLoading=!0,d.dispNo="",d.productListLoading=!0,d.productMoreScroll=!0,d.shareRendingURL=location.href,d.shareCodeis="MIMI TOUTOU",d.screenID="DearpetAdvice",h.query.beforeNo="5572261",(d.screenDataReset=function(){d.screenData={page:0,disp_name:"",dispNo:"",curDispNo:"",cateNodeName:[],cate_list:[]}})(),d.getHeight=function(){var a=b.element(".plan_bannerWrap iframe").height();return{"min-height":+a+"px"}},d.loadScreenData=function(a){if(console.log("스크린 데이터 로드..."),d.pageLoading){var b=g.petMalleventData;c.get(b).then(function(a){var b=[],c=a.data;b=c.dearpet_news,d.screenData.cate_list.length||(d.screenData.cate_list=b.cate_list.items,d.sendCategoryData(b.cate_list.items)),d.pageLoading=!1})}},d.getSubCateDataFunc,d.$on("getSubCateData",function(a,b){!d.getSubCateDataFun&&b&&(d.getSubCateDataFunc=b);try{d.screenData.cate_list.length&&d.sendCategoryData(d.screenData.cate_list)}catch(c){}}),d.sendCategoryData=function(a){d.getSubCateDataFunc&&(b.forEach(a,function(a,b){"5572261"==a.disp_no&&(a.extra=[{disp_nm:"상담"}])}),d.getSubCateDataFunc(a))},d.subTitle=d.screenData.disp_name="상담",d.petShare=function(a){d.sendTclick("m_DC_SpeDisp_Dearpet_Clk_Shr"),d.showSharePop({tclick:"m_DC_SpeDisp_Dearpet_Clk_Shr"}),j(function(){getScope().noCdnUrl=location.href},300)},d.loadScreenData(),a.onload=function(){k()};var o,p,q,r=!1;d.iframeOnLoaded=function(){r=!1,o.height="0px",b.element(a).scrollTop(0),m()}}]),d.directive("lotteContainer",["$window","LotteCommon",function(a,b){return{templateUrl:"/lotte/resources_dev/mall/pet/mitou_advice_container.html",replace:!0,link:function(c,d,e){c.mallMainClick=function(d){var e=b.petMallMainUrl+"?"+c.baseParam;d&&(e+="&tclick="+d),a.location.href=e}}}}]),d.directive("subHeaderEach",["$window","AppDownBnrService","$timeout",function(a,c,d){return{replace:!0,link:function(a,e,f){a.subHeaderFixed=!0;b.element(e),a.subHeaderHeight;a.$on("winScroll",function(b,e){e.scrollPos>=c.appDownBnrInfo.height||e.scrollPos<0?a.headerFixed=!0:a.headerFixed=!1,d(function(){a.$apply()})})}}}])}(window,window.angular);