!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteNgSwipe"]);d.controller("ProdListCtrl",["$http","$scope","$window","$location","LotteCommon","commInitData","LotteStorage","$timeout",function(d,e,f,g,h,i,j,k){e.showWrap=!0,e.contVisible=!0,e.subTitle="gucci_main",e.curDispNo="",e.productListLoading=!0,e.productMoreScroll=!0,(e.screenDataReset=function(){e.screenData={isWine:!1,wineParam:"",page:0,disp_name:"",dispNo:"",curDispNo:"",cateNodeName:[],showAllCategory:!1,selectCate1:0,selectCate2:0,selectCate3:0,selectedCategory:0,cate_list:[],dispGoodsList:[],sortIdx:10,moneySelect:"",moneyStart:"",moneyEnd:"",lastGoodsNo:0}})(),i.query.isWine&&(e.screenData.isWine="Y"==i.query.isWine?!0:!1,e.screenData.isWine&&(e.screenData.wineParam="&isWine=Y",e.subTitle="와인&스토리 Vine")),i.query.isComm&&(e.screenData.isComm="Y"==i.query.isComm?!0:!1,e.screenData.isComm&&(e.subTitle=i.query.title!=c?decodeURIComponent(i.query.title):"")),i.query.curDispNo&&(e.screenData.curDispNo=i.query.curDispNo),e.getCateNodeName=function(a,b){var c=[];switch(""!=a&&(c=a.split(",")),b){case 1:for(var d=0;d<e.screenData.cate_list.length;d++)null!=e.screenData.cate_list[d].sub_cate_list&&e.getCateNodeName(d+"",b+1);break;case 2:for(var d=0;d<e.screenData.cate_list[c[0]].sub_cate_list.length;d++)if(null!=e.screenData.cate_list[c].sub_cate_list[d].sub_cate_list)e.getCateNodeName(a+","+d,b+1);else if(e.screenData.cate_list[c[0]].sub_cate_list[d].disp_no==e.screenData.curDispNo)return e.screenData.cateNodeName[0]=e.screenData.cate_list[c[0]].disp_nm,e.screenData.cateNodeName[1]=e.screenData.cate_list[c[0]].sub_cate_list[d].disp_nm,void(e.screenData.cateNodeName[2]="");break;case 3:for(var d=0;d<e.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list.length;d++)if(e.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list[d].disp_no==e.screenData.curDispNo)return e.screenData.cateNodeName[0]=e.screenData.cate_list[c[0]].disp_nm,e.screenData.cateNodeName[1]=e.screenData.cate_list[c[0]].sub_cate_list[c[1]].disp_nm,void(e.screenData.cateNodeName[2]=e.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list[d].disp_nm)}},e.loadScreenData=function(){console.log("스크린 데이터 로드..."),e.screenData.page++,e.productListLoading=!0;var a=h.specialBoothSubData+"?curDispNo="+e.screenData.curDispNo+"&upCurDispNo="+e.screenData.curDispNo+"&sort="+e.screenData.sortIdx+"&beforeNo=&detail=&size=&moneyStart="+e.screenData.moneyStart+"&moneyEnd="+e.screenData.moneyEnd+"&page="+e.screenData.page+"&last_goods_no="+e.screenData.lastGoodsNo+e.screenData.wineParam;d.get(a).success(function(a){e.screenData.page<=1?(e.screenData.cate_list=a.cateList.items,e.getCateNodeName("",1),e.screenData.dispGoodsList=a.prdList,e.screenData.dispGoodsList.length&&(e.screenData.lastGoodsNo=e.screenData.dispGoodsList[e.screenData.dispGoodsList.length-1].goods_no)):a.prdList?e.screenData.dispGoodsList=e.screenData.dispGoodsList.concat(a.prdList):e.productMoreScroll=!1,a.prdList!=c&&a.prdList.length>5&&(e.productListLoading=!1)})};var l=j.getSessionStorage(e.screenID+"Loc"),m=j.getSessionStorage(e.screenID+"Data"),n=j.getSessionStorage(e.screenID+"ScrollY");if(l==a.location.href&&e.locationHistoryBack){var o=JSON.parse(m);e.pageLoading=!1,e.pageOptions=o.pageOptions,e.screenData=o.screenData,k(function(){b.element(f).scrollTop(n)},800)}else e.loadScreenData();b.element(f).on("unload",function(a){var c={};c.pageOptions=e.pageOptions,c.screenData=e.screenData,!i.query.localtest&&e.leavePageStroage&&(j.setSessionStorage(e.screenID+"Loc",g.absUrl()),j.setSessionStorage(e.screenID+"Data",c,"json"),j.setSessionStorage(e.screenID+"ScrollY",b.element(f).scrollTop()))}),e.sortClick=function(){e.screenData.page=0,e.screenData.lastGoodsNo=0,e.loadScreenData()},e.moneyClick=function(a){if(a){var b=a.split("_");e.screenData.moneyStart=b[0],e.screenData.moneyEnd=b[1]}else e.screenData.moneyStart="",e.screenData.moneyEnd="";e.screenData.page=0,e.screenData.lastGoodsNo=0,e.loadScreenData()}}]),d.directive("lotteContainer",["$window","LotteCommon",function(c,d){return{templateUrl:"/lotte/resources_dev/category/m/prod_list_container.html",replace:!0,link:function(e,f,g){e.menuCategoryClick=function(a){e.menuCategory1Click(a),e.screenData.showAllCategory=!1},e.menuCategory1Click=function(b){""!=b.link_url?a.location.href=d.specialMallSubUrl+"?"+e.baseParam+"&curDispNo="+b.disp_no+"&cateDepth="+b.cate_depth+"&title="+b.disp_nm+e.screenData.wineParam:(e.screenData.selectCate1==b.disp_no?e.screenData.selectCate1=0:e.screenData.selectCate1=b.disp_no,e.screenData.showAllCategory=!1)},e.menuCategory2Click=function(b,c){c||(c=""),""!=b.link_url?a.location.href=d.specialMallSubUrl+"?"+e.baseParam+"&curDispNo="+b.disp_no+"&beforeNo="+c.disp_no+"&cateDepth="+b.cate_depth+"&title="+b.disp_nm+e.screenData.wineParam:(e.screenData.selectCate2==b.disp_no?e.screenData.selectCate2=0:e.screenData.selectCate2=b.disp_no,e.screenData.showAllCategory=!1)},e.menuCategory3Click=function(b,c){""!=b.link_url?a.location.href=d.specialMallSubUrl+"?"+e.baseParam+"&curDispNo="+b.disp_no+"&beforeNo="+c.disp_no+"&cateDepth="+b.cate_depth+"&title="+b.disp_nm+e.screenData.wineParam:(e.screenData.selectCate3==b.disp_no?e.screenData.selectCate3=0:e.screenData.selectCate3=b.disp_no,e.screenData.showAllCategory=!1)},e.GucciMenuCategoryClick=function(a){e.GucciMenuCategory1Click(a),e.screenData.showAllCategory=!1},e.GucciMenuCategory1Click=function(b){""!=b.link_url?a.location.href=b.link_url:(e.screenData.selectCate1==b.disp_no?e.screenData.selectCate1=0:e.screenData.selectCate1=b.disp_no,e.screenData.showAllCategory=!1)},e.GucciMenuCategory2Click=function(b,c){c||(c=""),""!=b.link_url?a.location.href=b.link_url:(e.screenData.selectCate2==b.disp_no?e.screenData.selectCate2=0:e.screenData.selectCate2=b.disp_no,e.screenData.showAllCategory=!1)},e.GucciMenuCategory3Click=function(b,c){""!=b.link_url?a.location.href=b.link_url:(e.screenData.selectCate3==b.disp_no?e.screenData.selectCate3=0:e.screenData.selectCate3=b.disp_no,e.screenData.showAllCategory=!1)},e.showAllCategoryClick=function(){e.screenData.showAllCategory?e.screenData.showAllCategory=!1:e.screenData.showAllCategory=!0},e.planshopBannerClick=function(b){a.location.href=b.link_url},e.gucciBannerClick=function(b){a.location.href=b.img.link_url+"&"+e.baseParam},e.productClick=function(b){if(e.screenData.isWine){var c=e.tClickBase+"SpeDisp2_Clk_Prd_B"+this.$index;a.location.href=d.prdviewUrl+"?"+e.$parent.baseParam+"&goods_no="+b.goods_no+"&tclick="+c}else{var c=e.tClickBase+"SpeDisp1_Clk_Prd_B"+this.$index;a.location.href=d.prdviewUrl+"?"+e.$parent.baseParam+"&goods_no="+b.goods_no+"&tclick="+c}};var h=b.element(c),i=b.element("body"),j=h.height(),k=i[0].scrollHeight,l=4;h.on("scroll",function(a){!e.productMoreScroll||e.productListLoading||e.pageLoading||(k=i[0].scrollHeight,l=h.width()>=640?2:4,k-j*l>j&&h.scrollTop()+j>=k-j*l&&e.loadScreenData())}),e.hideSubCate=function(){e.screenData.selectCate1=!1}}}}]),d.directive("subHeaderEach",["$window",function(a){return{replace:!0,link:function(c,d,e){function f(){c.appObj.isNativeHeader&&(i=0),h.scrollTop()>=43?g.attr("style","z-index:10;position:fixed;top:"+i+"px;width:100%"):g.removeAttr("style")}c.gotoPrepage=function(){c.sendTclick("m_RDC_header_new_pre"),history.go(-1)};var g=b.element(d),h=b.element(a),i=c.subHeaderHeight;h=b.element(a),i=c.subHeaderHeight,h.on("scroll",function(a){f(),setTimeout(f,300)})}}}])}(window,window.angular);