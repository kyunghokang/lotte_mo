!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteProduct","lotteNgSwipe","lotteMainPop"]);d.controller("CateHolidayMidListCtrl",["$window","$location","$http","$scope","$timeout","$filter","LotteStorage","LotteCommon","commInitData",function(d,e,f,g,h,i,j,k,l){function m(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}g.showWrap=!0,g.contVisible=!0,g.productMoreScroll=!0,g.screenID="HolidaycateTpl",g.pageLoading=!0,g.subTitle=" ",j.delSessionStorage("cateListLoc"),j.delSessionStorage("cateListData"),j.delSessionStorage("cateListScrollY"),g.screenDataReset=function(){g.screenData={page:0,disp_name:null,disp_no:null,mGrpNo:"",idx:"",smallCate:[],rankingBestBuy:[]}},g.screenDataReset(),l.query.curDispNo!=c&&(g.screenData.disp_no=l.query.curDispNo),l.query.idx!=c&&(g.screenData.idx=l.query.idx),l.query.title!=c&&(g.subTitle=decodeURIComponent(l.query.title)),g.curDispNo=g.screenData.disp_no,g.curDispNoSctCd=65,g.loadScreenData=function(){return g.screenData.endPage?!1:(g.screenData.page++,g.productListLoading=!0,void f.get(k.smallHolidayCategoryData+"?curDispNo="+g.screenData.disp_no+"&cateDiv=MIDDLE&idx="+g.screenData.idx+"&page="+g.screenData.page).success(function(a){var d=[];a.max!=c&&(d=a.max,d.mgrp_no&&(g.screenData.mGrpNo=d.mgrp_no),null==g.screenData.disp_name&&(g.subTitle=g.screenData.disp_name=d.disp_nm),g.screenData.smallCate.length||(g.screenData.smallCate=d.small_cate.items),d.ranking_best_buy&&(d.ranking_best_buy.items.length?b.forEach(d.ranking_best_buy.items,function(a,b){g.screenData.rankingBestBuy.push(a)}):g.productMoreScroll=!1),g.productListLoading=!1),g.pageLoading=!1}).error(function(a){g.pageLoading=!1,g.productListLoading=!1}))},g.gotoLinkP=function(a,b,c){10>c&&(c="0"+c);var e="/product/m/product_list.do?"+g.baseParam+"&curDispNo="+a+"&tClick="+b+c;d.location.href=e},g.totalPagePad=function(a){return Math.ceil(a/2)};var n=j.getSessionStorage(g.screenID+"Loc"),o=j.getSessionStorage(g.screenID+"Data"),p=j.getSessionStorage(g.screenID+"ScrollY");if(n==a.location.href&&g.locationHistoryBack){var q=JSON.parse(o);g.pageLoading=!1,g.screenData=q.screenData,g.subTitle=g.screenData.disp_name,h(function(){b.element(d).scrollTop(p)},800)}else g.loadScreenData();b.element(d).on("unload",function(a){var c={};c.screenData=b.copy(g.screenData),!l.query.localtest&&g.leavePageStroage&&(j.setSessionStorage(g.screenID+"Loc",e.absUrl()),j.setSessionStorage(g.screenID+"Data",c,"json"),j.setSessionStorage(g.screenID+"ScrollY",b.element(d).scrollTop()))}),g.cateDepth1={},g.depthCurDispNo={},g.paramCurDispNo=m("curDispNo"),g.paramCateDepth1=m("cateDepth1"),""==m("cateDepth1")?g.cateDepth1="":g.paramCateDepth1.length>=1&&(g.cateDepth1=g.paramCateDepth1),""==m("paramCurDispNo")?g.depthCurDispNo="":g.paramCurDispNo.length>=1&&(g.depthCurDispNo=g.paramCurDispNo)}]),d.directive("lotteContainer",["$window","LotteCommon",function(a,b){return{templateUrl:"/lotte/resources_dev/category/m/cate_holiday_mid_list_anglr_container.html",replace:!0,link:function(d,e,f){d.subCateClick=function(e){d.cateDepth1="";for(var f=0;f<d.sideCtgData.ctgAll.length;f++)for(var g=0;g<d.sideCtgData.ctgAll[f].lctgs.length;g++)if(d.sideCtgData.ctgAll[f].lctgs[g].name==d.subTitle){d.cateDepth1=d.sideCtgData.ctgAll[f].name;break}var h="&tclick="+d.tClickBase+"side_cate_catesmall_"+e.disp_no+"&curDispNoSctCd=65",i=b.cateHolidayProdListUrl+"?"+d.baseParam+"&curDispNo="+e.disp_no+"&cateDiv=MIDDLE&idx="+d.screenData.idx+"&mGrpNo="+e.mgrp_no+"&curDispNo2="+d.curDispNo+"&cateDepth1="+d.cateDepth1+"&cateDepth2="+d.subTitle+"&title="+encodeURIComponent(e.disp_nm)+h;e.sort!=c&&(i+="&sort="+e.sort),a.location.href=i},d.isTotal=!0}}}])}(window,window.angular);var callDownCpn;!function(a,b,c){"use strict";var d=b.module("lotteMainPop",[]);d.controller("lotteMainPopCtrl",["$scope","$window","$location","$http","LotteCommon","LotteUtil","LotteCookie","LotteStorage","AppDownBnrService","LotteLink","commInitData",function(a,c,d,e,f,g,h,i,j,k,l){a.loadMainPopup=function(d){function m(){e.get(f.mainPopupData,{params:o}).success(function(b){if(!i.getSessionStorage("appDownBnrHide")&&!a.appObj.isApp){var c=j.appDownBnrLoadDefer;b.app_down_popup&&b.app_down_popup.length>0&&c.resolve(b.app_down_popup)}a.mainPop=b.current_page_popup,a.hideActionBar=g.isApp()&&"F"==a.mainPop.ppp_prt_tp_cd&&"20"!=d.pppTgtPgCd&&"30"!=d.pppTgtPgCd?!0:!1,0!=a.mainPop.ppp_sn&&(callDownCpn=function(){a.dupCouponIssue("88045"),a.sendTclick("m_abtest_naverbanner_01")},a.dupCouponIssue=function(b){if(a.loginInfo.isLogin)b.length>0&&e({url:f.couponRegCouponData+"?"+a.baseParam,data:"cpn_issu_no="+b,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(b){b.result=b.result.replace("\\n"," "),"undefined"!=typeof g.getParameter("cn")&&"140924"==g.getParameter("cn")&&b.result.indexOf("발급받은")>-1?(alert("이달의 앱 쿠폰을 모두 받으셨습니다. 참좋은혜택 등급 쿠폰도 확인하세요!"),location.href=f.gdBenefitUrl+"?"+a.baseParam):alert(b.result),a.popClose()}).error(function(a){"1000"==a.error.response_code?alert(a.error.response_msg):ajaxResponseErrorHandler(a,function(){})});else{var c="?"+a.baseParam;c+="&targetUrl="+encodeURIComponent(location.href),i.setSessionStorage("alliancePopupPPPSN",a.mainPop.ppp_sn),location.href=f.loginUrl+c}},a.cookieName=a.mainPop.cookie_nm,null!=i.getSessionStorage("alliancePopupPPPSN")&&a.loginInfo.isLogin?a.dupCouponIssue(a.mainPop.cpn_no):a.screenType>1&&10==d.pppTgtPgCd||(a.isOpenPop=!0,a.popOpen()),i.delSessionStorage("alliancePopupPPPSN"))}).error(function(a){console.log("Error Data :  메인팝업")})}var n=l.query,o={ppp_tgt_pg_cd:d.pppTgtPgCd,cn:n.cn,udid:n.udid,schema:n.schema};g.getParameter("testDate")&&(o.testDate=g.getParameter("testDate")),a.hideActionBar=!1,a.cookieName=null,a.appActionBarHide=function(){a.appObj.isApp&&a.hideActionBar&&(location.href="lottebridge://lotteapps/fullscreenhide")},a.appActionBarShow=function(){a.appObj.isApp&&a.hideActionBar&&(location.href="lottebridge://lotteapps/fullscreenshow")},a.popOpen=function(){b.element(".main_popup").show()},a.popClose=function(){a.sendTclick("m_RDC_popup_Close"),b.element(".main_popup").remove()},a.popToday=function(){a.sendTclick("m_RDC_popup_stoptoday"),h.setCookie(a.cookieName,"Y",1),a.popClose()},a.chkAlliancePopupObj={flag:!0,imgPath:"",deepLinkFlag:!0,tclick:""},a.closeAlliancePopup=function(){a.chkAlliancePopupObj.flag=!1},a.allianceExcuteApp=function(b){var c=a.chkAlliancePopupObj.deepLinkFlag?null:"http://m.lotte.com";a.chkAlliancePopupObj.tclick?a.chkAlliancePopupObj.tclick:null;k.appDeepLink("lotte",c,a.chkAlliancePopupObj.tclick,b)},b.element(c).on("load",m)}}]),d.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/)}]),d.directive("lotteMainPopup",["$window",function(a){return{templateUrl:"/lotte/resources_dev/layer/main_popup.html",controller:"lotteMainPopCtrl",replace:!0,link:function(a,b,c){a.isOpenPop=!1,a.loadMainPopup(c)}}}]),d.controller("appDownBnrCtrl",["$scope","AppDownBnrService",function(a,b){a.appBnrInfo=null,b.appDownSettingData().then(function(b){a.appBnrInfo=b})}]),d.directive("appDownBnr",["$location","LotteLink","LotteStorage","AppDownBnrService",function(a,b,c,d){return{templateUrl:"/lotte/resources_dev/layer/app_down_bnr.html",controller:"appDownBnrCtrl",replace:!0,link:function(e,f,g){e.appDown=function(){var c=null,f=d.appDownBnrInfo.linkUrl+"",g=""!=d.appDownBnrInfo.tclick?d.appDownBnrInfo.tclick:null;"./"!=f&&(c="http"==f.substring(0,4)?d.appDownBnrInfo.linkUrl:"/"==f.substring(0,1)?a.protocol()+"://"+a.host()+f:a.protocol()+"://"+a.host()+"/"+f),g&&e.sendTclick(g),b.appDeepLink("lotte",c,null,d.appDownBnrInfo.referrer)},e.appDownBnrClose=function(){return c.setSessionStorage("appDownBnrHide",!0),d.appDownBnrInfo.isShowFlag=!1,!1}}}}])}(window,window.angular);