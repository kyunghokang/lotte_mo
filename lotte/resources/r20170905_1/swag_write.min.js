function calcBytes(a){var b=0;for(i=0;i<a.length;i++){var c=a.charAt(i);escape(c).length>4?b+=2:"\n"==c?"\r"!=a.charAt(i-1)&&(b+=1):b+="<"==c||">"==c?4:1}return b}function maxLengthCheck(a,b,c,d){var e,f,g=c.value.length,h=parseInt(a),i="",j=0;if(0==g)null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h);else for(k=0;k<g;k++){if(e=c.value.charAt(k),"\n"==e&&j++,escape(e).length>4?h-=2:h--,0>h){alert("총 한글 "+a/2+"자 영문 "+a+"자 까지 쓰실 수 있습니다."),c.value=i;break}if(null!=b&j>parseInt(b)){alert("라인수 "+b+"라인을 넘을 수 없습니다."),j=0,f=i.length-1,c.value=i.substring(0,f);break}null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h),i+=e}}!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter"]);d.controller("SwagWriteCtrl",["$http","$scope","LotteCommon","LotteUtil","LotteForm","$timeout","$window",function(a,c,d,e,f,g,h){function i(){return!0}function j(){a.get("/json/mall/swag_write.json",{}).success(function(a){c.input.login_id=a.swag_write.login_id,c.input.mbr_email=a.swag_write.mbr_email,c.input.mbr_nm=a.swag_write.mbr_nm,c.input.mbr_no=a.swag_write.mbr_no,c.input.site_no=a.swag_write.site_no}).error(function(a){ajaxResponseErrorHandler(a)})}c.showWrap=!0,c.contVisible=!0,c.subTitle="뽐내기 작성",c.screenID="뽐내기 작성",c.input={},c.input.swagTxt="",c.isNewestApp=i(),b.element(document).ready(function(){g(function(){if(c.appObj.isApp){var a=b.element(".appPhotoArea");if(c.appObj.isAndroid)try{h.lottepetswag.callAndroid("swag://position?top="+a.offset().top)}catch(d){}else location.href="swag://position?top="+a.offset().top,console.log("SEND APP TOP POSI",a.offset().top)}},200)}),c.attachImage=function(){c.appObj.isApp?location.href="ghost://CommentWithPhoto":confirm("롯데닷컴 앱에서 이용 가능합니다. 지금 설치하시겠습니까?")&&(location.href=d.appDown+"?"+c.baseParam)},c.cancel=function(){confirm("뽐내기 작성을 취소하시겠습니까?")&&location.replace(d.petMallgalleryUrl+"?"+c.baseParam+"&curDispNo=5566438&beforeNo=5564054&cateDepth=2&title=뽐내기")},c.save=function(){var a=c.input.swagTxt,b=document.querySelector("#reviewTxt");return 0==a.trim().length?(alert("뽐내기를 작성해 주세요."),b.focus(),!1):calcBytes(a)<6?(alert("뽐내기를 한글 3자 이상 입력하세요."),b.focus(),!1):calcBytes(a)>2e3?(alert("뽐내기는 1000자[한글기준] 이내로 제한되어 있습니다."),b.focus(),!1):(f.FormSubmitForAjax(d.swagWriteCheckData+"?swagTxt="+a).success(function(a){if("0000"!=a.chk_swag_cont.response_code)alert(a.chk_swag_cont.response_msg);else{if(c.appObj.isApp){var b="swag://writeSwag";return b+="?swagTxt="+encodeURIComponent(c.input.swagTxt),b+="&loginId="+c.input.login_id,b+="&mbrNo="+c.input.mbr_no,b+="&mbrNm="+c.input.mbr_nm,b+="&mbrEmail="+c.input.mbr_email,b+="&site_no="+c.input.site_no,b+="&imageServerURL=/mobile/swagPetImgParamReq.lotte",b+="&returnUrlData=/mall/pet/dearpet_gallery.do?"+c.baseParam+"&curDispNo=5566438&beforeNo=5564054&cateDepth=2&title=뽐내기",c.isNewestApp||(b+="&radio1=",b+="&radio2=",b+="&radio3=",b+="&radio4=",b+="&radio5=",b+="&radio6=",b+="&check_cont=",b+="&img_no=",b+="&img_file_1=",b+="&img_file_2=",b+="&img_file_3=",b+="&img_file_4=",b+="&img_path_1=",b+="&img_path_2=",b+="&img_path_3=",b+="&img_path_4=",b+="&prdt_clor_eval_desc=",b+="&prdt_size_eval_desc=",b+="&use_flag=",b+="&wrtr_pur_dt="),console.log(b),void g(function(){location.href=b},200)}var b=d.swagWriteData+"?bbcNo="+c.bbc_no+c.baseParam;f.FormSubmitForAjax(b,c.input).success(function(a){g(function(){location.replace(d.petMallgalleryUrl+"?"+c.baseParam+"&curDispNo=5566438&beforeNo=5564054&cateDepth=2&title=뽐내기")},200)}).error(function(a){ajaxResponseErrorHandler(a)})}}),!1)},j()}]),d.directive("lotteContainer",["$timeout","$http",function(a,b){return{templateUrl:"/lotte/resources_dev/mall/pet/swag_write_container.html",replace:!0,link:function(a,b,c){}}}])}(window,window.angular);var ajaxResponseErrorHandler=function(a,b){if(a.error){var c=a.error.response_code,d=a.error.response_msg;if("9004"==c){var e="targetUrl="+encodeURIComponent(location.href,"UTF-8");location.href="/login/m/loginForm.do?"+e}else alert("["+c+"] "+d)}else alert("처리중 오류가 발생하였습니다.");b&&b()};