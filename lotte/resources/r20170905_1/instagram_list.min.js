!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","angular-carousel"]);d.controller("instagramListCtrl",["$scope","$window","$http","LotteCommon",function(c,d,e,f){function g(a){return a=(a+"").indexOf("?")>-1?a:a+"?","?"!=a.substring(a.length-1,a.length)&&(a+="&"),a+c.baseParam}c.ajaxLoadFlag=!1,c.showWrap=!0,c.contVisible=!0,c.subTitle="DearPetgram",c.screenID="인스타그램 피드 컨텐츠 페이지",c.pageLoading=!0,c.productListLoading=!1,(c.screenDataReset=function(){c.screenData={page:0,goodsPage:0,pageSize:5,pageEnd:!1,tocken:"1168706956.360887b.6059697a811e486580628a071b04d523",cliientId:"360887b5534c4842a7f6c81353ad2ad1",dispNoCode:[],instaData:{},goodsData:{},instaText:[],tclickIndex:[]}})();var h="https://api.instagram.com/v1/tags/dearpet/media/recent?count="+c.screenData.pageSize+"&access_token="+c.screenData.tocken+"&callback=JSON_CALLBACK";c.loadData=function(a){return c.ajaxLoadFlag?!1:(c.ajaxLoadFlag=!0,void(-1==h.indexOf("undefined")?e.jsonp(h).success(function(a){0==c.screenData.page?c.screenData.instaData=a.data:(c.productListLoading=!0,c.screenData.instaData=c.screenData.instaData.concat(a.data));var b=[];if(a.data.length>0){var d=0,e=0,f=0;for(d;d<a.data.length;d++){b[f]=[];var g=[];for(c.screenData.instaText[d]=a.data[d].caption.text.replace(/\n/gi,"<br/>"),a.data[d].caption.text=c.screenData.instaText[d],e=0;e<a.data[d].tags.length;e++)-1!=a.data[d].tags[e].indexOf("상품번호")&&g.push(a.data[d].tags[e].replace(/상품번호/g,""));0==g.length&&g.push("0"),b[f]=g.join(","),f++}}"200"==a.meta.code&&(c.screenData.page++,h=a.pagination.next_url+"&callback=JSON_CALLBACK"),c.screenDataReset.dispNoCode=b})["finally"](function(){c.goodsData()}):(c.productListLoading=!1,c.screenData.pageEnd=!0,console.info("::::: 추가페이지 없음 :::::"))))},c.loadData();var i=1,j=0;c.goodsData=function(){c.productListLoading=!0;var a=f.instagramGoodsData;e({method:"POST",url:a,data:{goodsArr:c.screenDataReset.dispNoCode}}).success(function(a){for(var b=0;b<a.max.length;b++)c.screenData.instaData[j]&&(c.screenData.instaData[j].goodsData=a.max[b].items,a.max[b].items&&a.max[b].items.length>0&&(c.screenData.instaData[j].tabIdx=i,i++),j++);c.pageLoading=!1,c.productListLoading=!1}).error(function(){console.info("상품 데이터 연동 오류"),c.pageLoading=!1,c.ajaxLoadFlag=!1})["finally"](function(){c.screenData.goodsPage++,c.ajaxLoadFlag=!1})},c.linkUrl=function(d,e,f,h){if(e)c.sendOutLink(d),f&&c.sendTclick(f);else{var d=g(d);if(h&&b.forEach(h,function(a,b){d+="&"+b+"="+a}),f&&(d+="&tclick="+f),-1!=(d+"").indexOf("main_phone.do?dispNo=")){f&&c.sendTclick(f);var i=d.indexOf("dispNo=")+7,j=d.substr(i,7);c.headerMenuClick(j)}else a.location.href=d}}}]),d.directive("lotteContainer",["LotteCommon","commInitData",function(a,c){return{templateUrl:"/lotte/resources_dev/instagram/instagram_list_container.html",replace:!0,link:function(c,d,e){var f=b.element("body")[0];c.instaCommentMore=function(a){c.screenData.instaData[a].more_open=c.screenData.instaData[a].more_open?!1:!0},c.$on("winScroll",function(a,b){c.screenData.pageEnd!==!0&&!c.ajaxLoadFlag&&f.scrollHeight-2*b.winHeight<=b.scrollPos+b.winHeight&&(c.productListLoading=!0,c.loadData())}),c.gotoLinkM=function(b,d,e,f,g){var h="m_DC_SpeDisp2_Clk_Prd_"+d;null!=e&&(10>e?h=h+"0"+e:h+=e),null!=g&&(b=a.prdviewUrl+"?"+c.baseParam+"&goods_no="+g.goods_no);var i={};c.linkUrl(b,!1,h,i)}}}}])}(window,window.angular);
//# sourceMappingURL=/instagram_list.min.js.map