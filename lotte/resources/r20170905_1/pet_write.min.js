!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteSideMylotte","lotteCommFooter","hwSwipe"]);d.controller("PetWriteCtrl",["$scope","LotteCommon","commInitData","$http","$window",function(d,e,f,g,h){function i(a){console.log(a)}function j(a,b){if(!b||!b.length)return[];var c=d.formOptions.checkList[a],e=[];for(var f in c)for(var g=0;g<b.length;++g)c[f].cd==b[g]&&(e[f]=c[f]);return e}function k(a){return a.length>10?a.substr(0,10):a}function l(a){if(a&&a.items&&a.items.length){var e=a.items.length,g=a.items;d.formList=[],d.dataForm={};for(var h=[],i={},l=f.query.bidx,m=0;e>m;++m){var n=d.randomId(),o=g[m].worry||[],p=g[m].birthday.replace(/\./gi,""),q=p.substr(0,4),r=p.substr(4,2),s=p.substr(6,2);p=q+"-"+r+"-"+s,h.push(n),i[n]={active:"Y"==g[m].active||"boolean"==typeof g[m].active&&g[m].active||"string"==typeof g[m].active&&"true"==g[m].active?!0:!1,gender:g[m].gender,name:k(g[m].name),size:g[m].size,type:g[m].type,photo:g[m].img_url||null,birthday:new Date(p),checklist:j(g[m].type,o),bbc_no:g[m].bbc_no||g[m].bbs_no,worryList:d.getCheckList(g[m].type),cateList:d.getArray(b.copy(d.formOptions.size[g[m].type]),!0),rotateCode:g[m].rotate_code},l&&null!=l&&l!=c&&l==(g[m].bbs_no||g[m].bbc_no)&&(d.eformIndex=m)}d.formList=h,d.dataForm=i}}function m(){var a=e.petMallpetFormCodeData;"edit"==d.isDisplayMode&&(a=e.petMallpetEditData),d.Request({requestURL:a,method:"get",result:function(a){if(!a.dearpet_baby_write.login_id&&!d.loginInfo.isLogin){alert("로그인 후 이용하실 수 있습니다.");var b="targetUrl="+encodeURIComponent(location.href,"UTF-8");return void(h.location.href=e.loginUrl+"?"+d.baseParam+"&"+b)}"edit"==d.isDisplayMode?(n(a.dearpet_baby_write.cainim_clss_cd.items||[]),a.dearpet_baby_write.pet_list?(a.dearpet_baby_write.pet_list.items||(a.dearpet_baby_write.pet_list=[]),a.dearpet_baby_write.pet_list.items.length?l(a.dearpet_baby_write.pet_list):(d.formList=[d.randomId()],d.noList=!0)):(d.formList=[d.randomId()],d.noList=!0)):(n(a.dearpet_baby_write.cainim_clss_cd.items||[]),d.formList=[d.randomId()])}})}function n(a){var b=a||[];if(d.formOptions.type=[],d.formOptions.size={},d.formOptions.checkList=[],b&&b.length)for(var c=0;c<b.length;++c){var e=b[c];d.formOptions.type.push({cd_nm:e.cd_nm,cd:e.cd});var f=e.canim_sz_cd.items||[];f.length||(f=e.canim_clss_dtl_cd.items),d.formOptions.size[e.cd]=f,d.formOptions.checkList[e.cd]=e.canim_cncn_sct_cd.items||[]}}d.showWrap=!0,d.contVisible=!0,d.subTitle="우리 아이 등록",d.dataForm={},d.eformIndex,d.loadingState=!1,d.isDisplayMode=f.query.dispMode||"edit",d.formBaseName="write_form_ID_",d.mbr_no;try{d.mbr_no=getLoginInfo().mbrNo}catch(o){}d.useDeviceis,d.appObj.isIOS&&(b.element("html,body").addClass("device_ios"),d.useDeviceis="iOS"),d.appObj.isAndroid&&(b.element("html,body").addClass("device_android"),d.useDeviceis="Android"),d.randomId=function(){return parseInt(99999999*Math.random())},d.formOptions={type:[{cd_nm:"강아지",cd:"dog"},{cd_nm:"고양이",cd:"cat"},{cd_nm:"소동물",cd:"etc"}],size:{dog:[{cd_nm:"소형견",cd:"small"},{cd_nm:"중형견",cd:"middle"},{cd_nm:"대형견",cd:"large"}],cat:[{cd_nm:"소형묘",cd:"small"},{cd_nm:"중형묘",cd:"middle"},{cd_nm:"대형묘",cd:"large"}],etc:[{cd_nm:"고슴도치",cd:"1"},{cd_nm:"토끼",cd:"2"},{cd_nm:"햄스터",cd:"3"},{cd_nm:"관상어",cd:"4"},{cd_nm:"애완곤충/파충류",cd:"5"}]},gender:[{cd_nm:"남아",cd:"M"},{cd_nm:"여아",cd:"F"}],checkList:{dog:[{cd_nm:"종합영양제",cdcd:"1"},{cd_nm:"피부/털",cd:"2"},{cd_nm:"뼈/관절",cd:"3"},{cd_nm:"눈//귀",cd:"4"},{cd_nm:"소화기",cd:"5"},{cd_nm:"신장/요로",cd:"6"},{cd_nm:"과체중",cd:"7"},{cd_nm:"저체중",cd:"8"},{cd_nm:"심장/스트레스",cd:"8"},{cd_nm:"해충방지",cd:"10"},{cd_nm:"면연력/식변증",cd:"11"}],cat:[{cd_nm:"헤어볼",cd:"1"},{cd_nm:"종합영양제",cd:"2"},{cd_nm:"치아",cd:"3"},{cd_nm:"피부/털",cd:"4"},{cd_nm:"신장/요로",cd:"5"},{cd_nm:"심장/스트레스",cd:"6"},{cd_nm:"소화기",cd:"7"},{cd_nm:"과체중",cd:"8"},{cd_nm:"저체중",cd:"9"},{cd_nm:"뼈/관절",cd:"10"},{cd_nm:"눈/귀",cd:"11"},{cd_nm:"해충방지/기타",cd:"12"}],etc:[]}},d.addZero=function(a){return 10>a?"0"+a:a},d.deletePet_list=[],d.isErrorState=!1,d.Request=function(a){g({method:a.method,url:a.requestURL,data:JSON.stringify(a.data)}).then(function(b){console.log(a.requestURL,b),200!=b.status?(console.log("http status",b.status),d.isErrorState||(alert('"전송실패" 접속이 원활하지 않습니다.'),d.isErrorState=!0),a.result&&a.result(null)):a.result&&a.result(b.data)},a.error||i)},d.goPage=function(b){b&&(a.location.href=b)},d.addNewForm=function(){b.element(b.element(".pet_form_foot_buttons").children()[0]).trigger("click")},d.getCheckList=function(a){return d.getArray(b.copy(d.formOptions.checkList[a]))},d.getArray=function(a,b){b=!0;for(var c=a,d=[],e=c.length/3,f=0;e>f;++f){for(var g=[],h=0;3>h;++h)b?c[3*f+h]&&g.push(c[3*f+h]):g.push(c[3*f+h]);d.push(g)}return d},d.getOrientation=function(a,b){var c=new FileReader;c.onload=function(a){var c=new DataView(a.target.result);if(65496!=c.getUint16(0,!1))return b(-2);for(var d=c.byteLength,e=2;d>e;){var f=c.getUint16(e,!1);if(e+=2,65505==f){if(1165519206!=c.getUint32(e+=2,!1))return b(-1);var g=18761==c.getUint16(e+=6,!1);e+=c.getUint32(e+4,g);var h=c.getUint16(e,g);e+=2;for(var i=0;h>i;i++)if(274==c.getUint16(e+12*i,g))return b(c.getUint16(e+12*i+8,g))}else{if(65280!=(65280&f))break;e+=c.getUint16(e,!1)}}return b(-1)},c.readAsArrayBuffer(a)},d.fakeRotation=function(a,b){switch(String(a)){case"2":b.addClass("horizontal");break;case"3":b.addClass("rotate180");break;case"6":b.addClass("rotate90");break;case"8":b.addClass("rotate-90");break;case"4":b.addClass("vertical");break;case"5":b.addClass("horizontal_rotate90");break;case"7":b.addClass("horizontal_rotate-90")}},d.getForm=function(a){return b.element(d.formBaseName+a)},d.noList,m()}]),d.directive("dearpetPetWrite",["$timeout","LotteCommon","$rootScope",function(d,e,f){return{templateUrl:"/lotte/resources_dev/mall/pet/dearpet_pet_write_tmpl.html",replace:!0,link:function(f,g,h){function i(a,b){var c=e.petMallpetDeleteData+"?bbc_no="+a;console.log("삭제",a,c),f.Request({method:"GET",requestURL:c,result:function(a){console.log("삭제 결과",a),f.deleteResults.push(a),p.length==q&&f.deleteResults.length==f.deletePet_list.length&&(o(q,p.length?null:"삭제되었습니다."),q=0)}})}function j(){k(),"edit"==f.isDisplayMode||f.activeChange()||(f.dataForm[f.formList[0]].active=!0),"edit"==f.isDisplayMode&&f.noList&&(f.dataForm[f.formList[0]].active=!0),null!=f.eformIndex&&f.eformIndex!=c&&f.setMoiveFnc(f.eformIndex),f.appObj.isApp&&f.appObj.isAndroid&&(!f.appObj.isSktApp&&f.appObj.verNumber<s||f.appObj.isSktApp&&f.appObj.verNumber<t)&&(f.AccessUpload=!1)}function k(){for(var a=0;a<f.formList.length;++a)f.dataForm[f.formList[a]]||(f.dataForm[f.formList[a]]={},f.dataForm[f.formList[a]].type=f.formOptions.type[0].cd,f.dataForm[f.formList[a]].size=f.formOptions.size[f.dataForm[f.formList[a]].type][0].cd,f.dataForm[f.formList[a]].gender="M",f.dataForm[f.formList[a]].worryList=f.getCheckList(f.dataForm[f.formList[a]].type),f.dataForm[f.formList[a]].cateList=f.getArray(b.copy(f.formOptions.size[f.dataForm[f.formList[a]].type]),!0))}function l(a){return"image/jpeg"==a||"image/png"==a?!0:!1}function m(a){for(var b=0;b<f.formList.length;++b)if(a==f.formList[b])return b;return null}function n(a){"bind"==a?b.element(".pet_write_forms form").bind("submit",function(a){var c=new FormData($(this)[0]),d=f.dataForm[b.element(this).attr("dataID")],g=d.bbc_no||d.bbs_no?e.petMallpetReWrite:e.petMallpetWriteData;console.log(g),$.ajax({url:g,type:"post",data:c,async:!1,ache:!1,contentType:!1,processData:!1,success:function(a){console.log("success",a,-1!=a.indexOf("reg_success")?"reg_success":"reg_error"),p.push(-1!=a.indexOf("reg_success")?"reg_success":"reg_error"),console.log(p),p.length==q&&f.deleteResults.length==f.deletePet_list.length&&(o(q),q=0)},error:function(a){console.log(a)}}),a.preventDefault()}):b.element(".pet_write_forms form").unbind("submit")}function o(b,c){for(var d,g=b>1?"등록이 모두 완료 되었습니다.":"등록되었습니다.",h=0,i=0;i<p.length;++i)"reg_success"!=p[i]&&h++;if(h){if(h===p.length)return alert(d||"등록실패"),void u(!1);alert(h+"개의 데이타가 등록 실패하였습니다.")}else alert(c||g);p=[],a.location.href=e.petMallMainUrl+"?"+f.baseParam}var p=[],q=0,r=8,s=292,t=217,u=function(a){return(null!=a||a!=c)&&(b.element("body").scope().loadingState=a),b.element("body").scope().loadingState};f.swipereset,f.swipeCtrl,f.setMoiveFnc,f.updateTotal=function(a){var c=b.element(a.currentTarget).val(),d=/[^(가-힣ㄱ-ㅎㅏ-ㅣa-zA-Z0-9)]/gi;length=c.length,d.test(c)&&b.element(a.currentTarget).val(c.replace(d,"")),"keydown"==a.tpye&&c.length>=10?a.preventDefault():"keyup"==a.type&&c.length>10&&b.element(a.currentTarget).val(c.substr(0,9))},f.dateArrow=!0,f.typeis=function(a,c){if(f.dataForm[a].type!=c){f.getForm(a);f.dataForm[a].size=null,f.dataForm[a].gender=null,f.dataForm[a].checklist=[],f.dataForm[a].worryList=f.getCheckList(c),f.dataForm[a].cateList=f.getArray(b.copy(f.formOptions.size[c]),!0),f.defaultSetting(a,c)}},f.defaultSetting=function(a,b){f.dataForm[a].type&&(f.dataForm[a].size=f.formOptions.size[b][0].cd,f.dataForm[a].gender="M")},f.setWorry=function(a,b,c){try{f.dataForm[b].checklist||(f.dataForm[b].checklist=[])}catch(d){f.dataForm[b].checklist=[]}f.dataForm[b].checklist[c]?f.dataForm[b].checklist[c]=null:f.dataForm[b].checklist[c]=a},f.AccessUpload=!0,f.userVersionCheck=function(){if(confirm("롯데닷컴 앱 업데이트 후 이용 가능합니다. 지금 업데이트 하시겠습니까?")){var a="market://details?id=com.lotte";f.appObj.isSktApp&&(a="https://www.onestore.co.kr/userpoc/apps/view?pid=0000677011"),location.href=a}},f.photoPreview=function(a){if(f.AccessUpload){var d=a.files[0],e=b.element(a).attr("gi"),g=(new FileReader,1024*r*1e3),h=b.element(a).parent().find("figure");h.children().remove(),f.dataForm[e].photo=null,f.dataForm[e].rotateCode=null;try{f.$apply()}catch(i){}if(d&&d!=c){if(h.attr("class",""),!l(d.type))return void alert("jpg/png 파일만 업로드 가능합니다.");if(d.size>g)return void alert("우리 아이 사진 용량이 "+r+"MB 초과하였습니다.");u(!0),loadImage(d,function(a){try{f.dataForm[e].photo=a.toDataURL()}catch(b){h.append(a)}u(!1);try{f.$apply()}catch(b){}},{maxWidth:800,minWidth:216,minHeight:216,cover:!0,canvas:!0}),f.getOrientation(d,function(a){f.dataForm[e].rotateCode=a;try{f.$apply()}catch(b){}})}}},f.formADD=function(){if(!u()){if(u(!0),d(function(){u(!1);try{f.$apply()}catch(a){}},1500),0==f.swpIdx&&2==b.element(".pet_write_forms .form").children().length){var a=!1,e=f.dataForm[f.formList[f.formList.length-1]];for(var g in e)g&&g!=c&&e[g]&&(a=!0);if(!a)return void f.swipeCtrl("next")}f.formList.push(f.randomId()),k(),d(function(){try{f.swipereset(!0),f.swipeCtrl("end"),f.$apply()}catch(a){}},300)}},f.deleteResults=[],f.formDelete=function(a,c){var e=f.dataForm[a];if(!u()){if(u(!0),d(function(){u(!1);try{f.$apply()}catch(a){}},1e3),e&&null!=e&&(e.bbs_no||e.bbc_no)&&f.deletePet_list.push(e.bbs_no||e.bbc_no),f.formList.length<2){if(console.log("2개이하"),!confirm("작성중인 내용도 모두 삭제 됩니다. 삭제 하시겠습니다?"))return;if(f.deletePet_list.length)for(var g=0;g<f.deletePet_list.length;++g)i(f.deletePet_list[g],!0);var h=f.formOptions.type[0].cd;return f.dataForm[f.formList[0]]={active:!0,type:h},b.element(".pet_write_forms .form input[type=file]").val(""),void f.defaultSetting(f.formList[0],h)}if(confirm("작성중인 내용도 모두 삭제 됩니다. 삭제 하시겠습니다?")){var h=f.formOptions.type[0].cd,j=f.dataForm[a].active;delete f.dataForm[a];for(var g=0;g<f.formList.length;++g)a==f.formList[g]&&f.formList.splice(g,1);j&&(f.dataForm[f.formList[0]].active=!0),d(function(){try{f.swipereset(!0);var a=c==f.formList.length?c-1:c;0>a&&(a=0),f.setMoiveFnc(a),f.$apply()}catch(b){}},300)}}},f.getSizeList=function(a){return f.getArray(b.copy(f.formOptions.size[a]))},f.dateFocus=function(a){},f.activeChange=function(a){var b;for(var c in f.formList)a!=f.formList[c]&&f.dataForm[f.formList[c]].active&&(b=f.dataForm[f.formList[c]]);return b&&null!=a&&(confirm("이미 설정한 대표 아이가 있습니다.\n변경하시겠습니까?")?b.active=!1:d(function(){f.dataForm[a].active=!1,f.$apply()},300)),b},f.requestState=!1,f.submit=function(){if(!f.requestState){f.requestState=!0,p=[],f.deleteResults=[];var a=[],g=[];f.isErrorState=!1;for(var h=0;h<f.formList.length;++h){var j=f.dataForm[f.formList[h]],k={name:!1,type:!1,size:!1,birthday:!1,gender:!1},l=0;for(var o in j){var r=j[o];for(var s in k)o==s&&r&&r!=c&&(k[s]=!0,l++)}l>0&&5>l&&g.push(f.formList[h]),k.name&&k.type&&k.size&&k.birthday&&k.gender&&a.push([j,f.formList[h]])}if(g.length){alert("필수값(*)이 모두 입력되지 않았습니다.");var t=m(g[0]);return null!=t&&f.setMoiveFnc&&f.setMoiveFnc(t),void(f.requestState=!1)}if(a.length){if(u(!0),n("bind"),q=a.length,f.deletePet_list.length)for(var h=0;h<f.deletePet_list.length;++h)i(f.deletePet_list[h]);d(function(){for(var c=0;c<a.length;++c){var g=a[c],h=b.element("#"+f.formBaseName+a[c][1]),i=(e.petMallpetWriteData,b.element("#"+f.formBaseName+a[c][1]+" input[type=date]").val());b.element("#"+f.formBaseName+a[c][1]+" input[name=birthday]").val(i.replace(/[^(0-9)]/gi,"")),b.element("#"+f.formBaseName+a[c][1]+" input[name=active]").val(g[0].active?!0:!1),console.log(g),h.submit()}d(function(){n("remove")},1e3)},300)}else alert("아이 정보를 입력해주세요.")}},d(j)}}}]),d.directive("touhchBlockingLoading",[function(a){return{template:'<div ng-if="loadingState" class="overlay_loading"><div class="loading"></div></div>'}}]),d.directive("lotteContainer",["$timeout","LotteCommon",function(a,b){return{templateUrl:"/lotte/resources_dev/mall/pet/dearpet_pet_write_container.html"}}]),d.directive("subHeaderEach",["$window",function(a){return{replace:!0,link:function(c,d,e){var f=d[0].offsetHeight;b.element("body");c.gotoPrepage=function(){c.sendTclick("m_header_new_pre"),history.go(-1)},b.element(a).on("scroll",function(a){this.pageYOffset>0?(b.element("body").css("paddingTop",f+"px"),d[0].style.cssText="z-index:800;position:fixed;top:"+c.headerHeight+"px;width:100%;"):(b.element("body").css("paddingTop","0px"),d[0].style.cssText="")})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("hwSwipe",["ngTouch"]);d.directive("hwSwipe",["$timeout","$window","$compile",function(d,e,f){return{scope:{swipeIndex:"=?",swipeTotal:"=?",swipeController:"=?",swipeReset:"=?",swiepeMove:"=?"},link:function(f,g,h){function i(a){clearTimeout(z.play);try{b.element("[copy-item-id="+C+"]").remove(),z.copy=!1}catch(c){}j()}function j(){z={parentwrap:b.element(g).parent(),containerWidth:0,wrap:b.element(g),wrapWidth:0,siwpeContainer:b.element(g)[0],spaceX:h.spaceX||10,infinite:"true"==h.infinite?!0:!1,resphones:50,auto:"true"==h.rolling?!0:!1,interval:h.interval||null,view:1,w320:h.width320||1,w640:h.width640,w900:h.width900,itemsList:[],posX:0,width:0,height:0,touchPos:0,touchPosY:0,slicew:0,viewgroup:[],swipe:!0,swipepage:0,swipeIndex:0,input:!0,copy:!1,play:null,moveY:!1,side:"",swipeResponseX:50},A[0].innerWidth<640&&(z.view=z.w320),A[0].innerWidth>640&&A[0].innerWidth<900&&(z.view=z.w640||z.w320||1),A[0].innerWidth>900&&(z.view=z.w900||z.w640||z.w320),b.element(g).children().length<z.view&&(z.view=b.element(g).children().length,z.infinite=!1,z.swipe=!1),z.resphones=1==z.view?100:50,m(),n(),p(z.swipeIndex),E||x(),y()}function k(a){return a?{"-webkit-transition":"-webkit-transform ease .3s","-moz-transition":"-webkit-transform ease .3s","-o-transition":"-webkit-transform ease .3s",transition:"-webkit-transform ease .3s"}:{"-webkit-transition":"-webkit-transform ease 0s","-moz-transition":"-webkit-transform ease 0s","-o-transition":"-webkit-transform ease 0s",transition:"-webkit-transform ease 0s"}}function l(){var a=0,c=2*z.wrap.children().length;c<3*z.view&&(c=3*z.view);for(var d=z.wrap.children().length;c>d;++d){var e=b.element(b.element(z.wrap.children()[a]).clone(!0,!0)[0]);e.attr("index",d),e.attr("ng-repeat",""),e.attr("copy-item-id",C),e.css({width:z.slicew,left:d*z.slicew+"px",position:"absolute"}),z.wrap.append(e);var f=b.element(z.wrap.children()[d]);z.itemsList.push([f,f.attr("index")||d]),a++}z.wrap.css({position:"relative",width:z.wrapWidth,height:z.height})}function m(){z.containerWidth=z.parentwrap[0].clientWidth,z.slicew=z.containerWidth/z.view,z.width=z.containerWidth;var a=z.wrap.children();D&&z.infinite&&z.wrap.children().remove(),z.wrapWidth=0,b.forEach(a,function(a,c){var d=b.element(a);D&&z.infinite&&z.wrap.append(d),d.attr("index",c),d[0].removeAttribute("ng-repeat"),d.css({width:z.slicew,left:z.wrapWidth,position:"absolute"}),z.wrapWidth+=d[0].clientWidth,z.itemsList.push([a,d.attr("index")||c]),z.height||(z.height=d[0].clientHeight)}),z.wrap.css({position:"relative",width:z.wrapWidth,height:z.height}),D&&w(0),D=!1,z.wrap.children().length<3*z.view&&z.infinite&&(z.wrap.children().length%z.view==0&&2*z.wrap.children().length>=3*z.view?(l(),z.copy=!0):z.infinite=!1)}function n(){z.swipepage=Math.ceil(z.itemsList.length/z.view);for(var a=0;a<z.swipepage;++a){for(var b=[],c=0;c<z.view;++c){var d=z.itemsList[a*z.view+c];d&&b.push(d)}z.viewgroup.push(b)}f.swipeTotal=z.copy?z.viewgroup.length/2:z.viewgroup.length;try{f.$apply()}catch(e){}}function o(){var a=b.element(z.wrap.children()[0]),c=b.element(z.wrap.children()[z.wrap.children().length-1]);if("prev"==z.side)for(var d=Math.ceil(Math.abs(a.offset().left)/z.slicew),e=0;e<Math.ceil(z.view-d);++e)u("prev");if("next"==z.side)for(var d=Math.floor(Math.abs(c.offset().left-z.containerWidth)/z.slicew),e=0;e<Math.ceil(z.view-d);++e)u("next")}function p(a,b){if(z.swipeIndex=a,z.copy?f.swipeIndex=a%f.swipeTotal:f.swipeIndex=a,!b)try{f.$apply()}catch(c){}}function q(a){for(var b={posx:null},c=0;c<z.viewgroup.length;++c)for(var d=0;d<z.viewgroup[c].length;++d){var e=z.viewgroup[c][d],f=z.viewgroup[c];a==e[1]&&(b={index:f.length<z.view?f[f.length-1][1]:f[0][1],page:c,minus:z.view-f.length,side:f.length<z.view?"last":"first"})}return o(),b}function r(a){return Number(b.element(a).css("left").replace("px",""))}function s(a){var c=null;return b.forEach(z.wrap.children(),function(d,e){var f=b.element(d);null==c&&a==f.attr("index")&&(c={posx:r(f),index:f.index()})}),c}function t(){var a,c=null,d=z.containerWidth;if(b.forEach(z.wrap.children(),function(e,f){if(!(c>0)){var g=b.element(e),h=g.offset().left,i=(g[0].clientWidth,("prev"==z.side?h+z.slicew:d-h)/d*100);"prev"==z.side&&h>d/2||"next"==z.side&&h<(1==z.view?0:d/2)||(0>i&&(i=0),i>100&&(i=100),i>z.spaceX&&i<z.resphones&&(c=Number(g.attr("index"))+1,a=r(g)))}}),null==c)return{posx:z.posX};var e={index:c>0?c-1:c,posx:a},f=q(e.index),g=s(f.index);return e.page=f.page,e.itemIndex=f.index,e.targetIndex=g.index,e.posx=g.posx,"last"==f.side&&(e.posx-=d-z.slicew),e}function u(a){if(z.infinite){var c=b.element(z.wrap.children()[0]),d=b.element(z.wrap.children()[z.wrap.children().length-1]);return c.offset().left>=-z.slicew&&c.offset().left<z.containerWidth||"prev"==a?(z.wrap.prepend(b.element(d.clone(!0,!0)[0]).css("left",r(c)-z.slicew+"px")),void d.remove()):d.offset().left<z.containerWidth+z.slicew&&d.offset().left>-z.slicew||"next"==a?(z.wrap.append(b.element(c.clone(!0,!0)[0]).css("left",r(d)+z.slicew+"px")),void c.remove()):void 0}}function v(a,b){var d=z.posX-a,e={};!z.infinite&&b&&(e=t(),d=e.index!=c&&null!=e.index?-e.posx:e.posx),z.infinite&&b&&(e=t(),d=null!=e.index?-e.posx:e.posx,u()),w(d,b,e.page)}function w(a,b,e,g){var h=k(b);h["-webkit-transform"]="translateX("+a+"px)",z.wrap.css(h),null!=z.play&&(clearTimeout(z.play),z.play=null),b&&(z.input=!1,z.posX=a,d(function(){z.input=!0,y()},600)),(null!=e||e!=c)&&p(e,g);try{g||f.$apply()}catch(i){}}function x(){E||(E=!0,b.element(document.body).attr("ondragstart","return false"),b.element(document.body).attr("onselectstart","return false"),z.wrap.bind("touchstart touchmove touchend",function(a){if(!(z.wrap.children().length<2)){var b=a.originalEvent.changedTouches[0].clientX,c=a.originalEvent.changedTouches[0].clientY;switch(a.type){case"touchstart":z.touchPos=b,z.touchPosY=c;break;case"touchmove":var d=z.touchPos-b;if(Math.abs(d)<z.swipeResponseX)return;z.side=z.touchPos<b?"prev":"next",v(0>d?d+z.swipeResponseX:d-z.swipeResponseX);break;case"touchend":v(z.touchPos-b,!0),z.touchPos=0}u()}}))}function y(){z.interval&&z.auto&&null==z.play&&(z.play=setTimeout(function(){null!=z.play&&f.swipeController("next")},z.interval))}var z,A=b.element(e),B=b.element(e).innerWidth(),C=Math.floor(9999999*Math.random()),D=!1,E=!1;A.bind("resize",function(){var a=b.element(e).innerWidth();Math.ceil(B)!=Math.ceil(a)&&(D=!0,i())}),f.swipeReset=i,f.swiepeMove=function(a){if("number"==typeof a&&1==z.view&&!z.infinite){var b=z.wrap.children()[a].offsetLeft;w(-b,!0,a,!0)}},f.swipeController=function(a){if(null!=a&&a!=c&&z.input)switch(a){case"next":z.side="next",o();var b=z.swipeIndex<z.viewgroup.length-1?z.swipeIndex+1:0,d=z.viewgroup[b],e=d.length<z.view?d[d.length-1][1]:d[0][1],f=s(e);d.length<z.view&&(f.posx=f.posx-(z.containerWidth-z.slicew)),w(-f.posx,!0,b,!0);break;case"prev":z.side="prev",o();var b=z.swipeIndex>0?z.swipeIndex-1:z.viewgroup.length-1,d=z.viewgroup[b],e=d[0][1],f=s(e);w(-f.posx,!0,b,!0);break;case"end":z.side="next",o();var g=z.wrap.children().length-1,h=z.wrap.children()[g].offsetLeft;w(-h,!0,g,!0);break;default:p(a)}},a.onbeforeunload=function(a){clearTimeout(z.play)},d(j)}}}]),d.filter("range",function(){return function(a){for(var b=[],c=0;a>c;c++)b.push(c);return b}})}(window,window.angular),!function(a){"use strict";function b(a,c,d){var e,f=document.createElement("img");return f.onerror=function(e){return b.onerror(f,e,a,c,d)},f.onload=function(e){return b.onload(f,e,a,c,d)},"string"==typeof a?(b.fetchBlob(a,function(c){c?(a=c,e=b.createObjectURL(a)):(e=a,d&&d.crossOrigin&&(f.crossOrigin=d.crossOrigin)),f.src=e},d),f):b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a)?(e=f._objectURL=b.createObjectURL(a),e?(f.src=e,f):b.readFile(a,function(a){var b=a.target;b&&b.result?f.src=b.result:c&&c(a)})):void 0}function c(a,c){!a._objectURL||c&&c.noRevoke||(b.revokeObjectURL(a._objectURL),delete a._objectURL)}var d=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.fetchBlob=function(a,b,c){b()},b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.transform=function(a,b,c,d,e){c(a,e)},b.onerror=function(a,b,d,e,f){c(a,f),e&&e.call(a,b)},b.onload=function(a,d,e,f,g){c(a,g),f&&b.transform(a,g,f,e,{})},b.createObjectURL=function(a){return!!d&&d.createObjectURL(a)},b.revokeObjectURL=function(a){return!!d&&d.revokeObjectURL(a)},b.readFile=function(a,b,c){if(window.FileReader){var d=new FileReader;if(d.onload=d.onerror=b,c=c||"readAsDataURL",d[c])return d[c](a),d}return!1},"function"==typeof define&&define.amd?define(function(){return b}):"object"==typeof module&&module.exports?module.exports=b:a.loadImage=b}(window),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],a):a("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(a){"use strict";var b=a.transform;a.transform=function(c,d,e,f,g){b.call(a,a.scale(c,d,g),d,e,f,g)},a.transformCoordinates=function(){},a.getTransformedOptions=function(a,b){var c,d,e,f,g=b.aspectRatio;if(!g)return b;c={};for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c.crop=!0,e=a.naturalWidth||a.width,f=a.naturalHeight||a.height,e/f>g?(c.maxWidth=f*g,c.maxHeight=f):(c.maxWidth=e,c.maxHeight=e/g),c},a.renderImageToCanvas=function(a,b,c,d,e,f,g,h,i,j){return a.getContext("2d").drawImage(b,c,d,e,f,g,h,i,j),a},a.hasCanvasOption=function(a){return a.canvas||a.crop||!!a.aspectRatio},a.scale=function(b,c,d){function e(){var a=Math.max((i||v)/v,(j||w)/w);a>1&&(v*=a,w*=a)}function f(){var a=Math.min((g||v)/v,(h||w)/w);1>a&&(v*=a,w*=a)}c=c||{};var g,h,i,j,k,l,m,n,o,p,q,r=document.createElement("canvas"),s=b.getContext||a.hasCanvasOption(c)&&r.getContext,t=b.naturalWidth||b.width,u=b.naturalHeight||b.height,v=t,w=u;if(s&&(c=a.getTransformedOptions(b,c,d),m=c.left||0,n=c.top||0,c.sourceWidth?(k=c.sourceWidth,void 0!==c.right&&void 0===c.left&&(m=t-k-c.right)):k=t-m-(c.right||0),c.sourceHeight?(l=c.sourceHeight,void 0!==c.bottom&&void 0===c.top&&(n=u-l-c.bottom)):l=u-n-(c.bottom||0),v=k,w=l),g=c.maxWidth,h=c.maxHeight,i=c.minWidth,j=c.minHeight,s&&g&&h&&c.crop?(v=g,w=h,q=k/l-g/h,0>q?(l=h*k/g,void 0===c.top&&void 0===c.bottom&&(n=(u-l)/2)):q>0&&(k=g*l/h,void 0===c.left&&void 0===c.right&&(m=(t-k)/2))):((c.contain||c.cover)&&(i=g=g||i,j=h=h||j),c.cover?(f(),e()):(e(),f())),s){if(o=c.pixelRatio,o>1&&(r.style.width=v+"px",r.style.height=w+"px",v*=o,w*=o,r.getContext("2d").scale(o,o)),p=c.downsamplingRatio,p>0&&1>p&&k>v&&l>w)for(;k*p>v;)r.width=k*p,r.height=l*p,a.renderImageToCanvas(r,b,m,n,k,l,0,0,r.width,r.height),m=0,n=0,k=r.width,l=r.height,b=document.createElement("canvas"),b.width=k,b.height=l,a.renderImageToCanvas(b,r,0,0,k,l,0,0,k,l);return r.width=v,r.height=w,a.transformCoordinates(r,c),a.renderImageToCanvas(r,b,m,n,k,l,0,0,v,w)}return b.width=v,b.height=w,b}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],a):a("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(a){"use strict";var b=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.blobSlice=b&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},a.metaDataParsers={jpeg:{65505:[]}},a.parseMetaData=function(b,c,d,e){d=d||{},e=e||{};var f=this,g=d.maxMetaDataSize||262144,h=!(window.DataView&&b&&b.size>=12&&"image/jpeg"===b.type&&a.blobSlice);!h&&a.readFile(a.blobSlice.call(b,0,g),function(b){if(b.target.error)return console.log(b.target.error),void c(e);var g,h,i,j,k=b.target.result,l=new DataView(k),m=2,n=l.byteLength-4,o=m;if(65496===l.getUint16(0)){for(;n>m&&(g=l.getUint16(m),g>=65504&&65519>=g||65534===g);){if(h=l.getUint16(m+2)+2,m+h>l.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=a.metaDataParsers.jpeg[g])for(j=0;j<i.length;j+=1)i[j].call(f,l,m,h,e,d);m+=h,o=m}!d.disableImageHead&&o>6&&(k.slice?e.imageHead=k.slice(0,o):e.imageHead=new Uint8Array(k).subarray(0,o))}else console.log("Invalid JPEG file: Missing JPEG marker.");c(e)},"readAsArrayBuffer")||c(e)},a.hasMetaOption=function(a){return a&&a.meta};var c=a.transform;a.transform=function(b,d,e,f,g){a.hasMetaOption(d)?a.parseMetaData(f,function(g){c.call(a,b,d,e,f,g)},d,g):c.apply(a,arguments)}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],a):"object"==typeof module&&module.exports?a(require("./load-image"),require("./load-image-meta")):a(window.loadImage)}(function(a){"use strict";"fetch"in window&&"Request"in window&&(a.fetchBlob=function(b,c,d){return a.hasMetaOption(d)?fetch(new Request(b,d)).then(function(a){return a.blob()}).then(c)["catch"](function(a){console.log(a),c()}):void c()})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],a):"object"==typeof module&&module.exports?a(require("./load-image"),require("./load-image-meta")):a(window.loadImage)}(function(a){"use strict";a.ExifMap=function(){return this},a.ExifMap.prototype.map={Orientation:274},a.ExifMap.prototype.get=function(a){return this[a]||this[this.map[a]]},a.getExifThumbnail=function(a,b,c){var d,e,f;if(!c||b+c>a.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(d=[],e=0;c>e;e+=1)f=a.getUint8(b+e),d.push((16>f?"0":"")+f.toString(16));return"data:image/jpeg,%"+d.join("%")},a.exifTagTypes={1:{getValue:function(a,b){return a.getUint8(b)},size:1},2:{getValue:function(a,b){return String.fromCharCode(a.getUint8(b))},size:1,ascii:!0},3:{getValue:function(a,b,c){return a.getUint16(b,c)},size:2},4:{getValue:function(a,b,c){return a.getUint32(b,c)},size:4},5:{getValue:function(a,b,c){return a.getUint32(b,c)/a.getUint32(b+4,c)},size:8},9:{getValue:function(a,b,c){return a.getInt32(b,c)},size:4},10:{getValue:function(a,b,c){return a.getInt32(b,c)/a.getInt32(b+4,c)},size:8}},a.exifTagTypes[7]=a.exifTagTypes[1],a.getExifValue=function(b,c,d,e,f,g){var h,i,j,k,l,m,n=a.exifTagTypes[e];if(!n)return void console.log("Invalid Exif data: Invalid tag type.");if(h=n.size*f,i=h>4?c+b.getUint32(d+8,g):d+8,i+h>b.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===f)return n.getValue(b,i,g);for(j=[],k=0;f>k;k+=1)j[k]=n.getValue(b,i+k*n.size,g);if(n.ascii){for(l="",k=0;k<j.length&&(m=j[k],"\x00"!==m);k+=1)l+=m;return l}return j},a.parseExifTag=function(b,c,d,e,f){var g=b.getUint16(d,e);f.exif[g]=a.getExifValue(b,c,d,b.getUint16(d+2,e),b.getUint32(d+4,e),e)},a.parseExifTags=function(a,b,c,d,e){var f,g,h;if(c+6>a.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(f=a.getUint16(c,d),g=c+2+12*f,g+4>a.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(h=0;f>h;h+=1)this.parseExifTag(a,b,c+2+12*h,d,e);return a.getUint32(g,d)},a.parseExifData=function(b,c,d,e,f){if(!f.disableExif){var g,h,i,j=c+10;if(1165519206===b.getUint32(c+4)){if(j+8>b.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==b.getUint16(c+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(b.getUint16(j)){case 18761:g=!0;break;case 19789:g=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==b.getUint16(j+2,g))return void console.log("Invalid Exif data: Missing TIFF marker.");h=b.getUint32(j+4,g),e.exif=new a.ExifMap,h=a.parseExifTags(b,j,j+h,g,e),h&&!f.disableExifThumbnail&&(i={exif:{}},h=a.parseExifTags(b,j,j+h,g,i),i.exif[513]&&(e.exif.Thumbnail=a.getExifThumbnail(b,j+i.exif[513],i.exif[514]))),e.exif[34665]&&!f.disableExifSub&&a.parseExifTags(b,j,j+e.exif[34665],g,e),e.exif[34853]&&!f.disableExifGps&&a.parseExifTags(b,j,j+e.exif[34853],g,e)}}},a.metaDataParsers.jpeg[65505].push(a.parseExifData)}),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],a):"object"==typeof module&&module.exports?a(require("./load-image"),require("./load-image-exif")):a(window.loadImage)}(function(a){"use strict";a.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",
41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},a.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},a.ExifMap.prototype.getText=function(a){var b=this.get(a);switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[a][b];case"ExifVersion":case"FlashpixVersion":if(!b)return;return String.fromCharCode(b[0],b[1],b[2],b[3]);case"ComponentsConfiguration":if(!b)return;return this.stringValues[a][b[0]]+this.stringValues[a][b[1]]+this.stringValues[a][b[2]]+this.stringValues[a][b[3]];case"GPSVersionID":if(!b)return;return b[0]+"."+b[1]+"."+b[2]+"."+b[3]}return String(b)},function(a){var b,c=a.tags,d=a.map;for(b in c)c.hasOwnProperty(b)&&(d[c[b]]=b)}(a.ExifMap.prototype),a.ExifMap.prototype.getAll=function(){var a,b,c={};for(a in this)this.hasOwnProperty(a)&&(b=this.tags[a],b&&(c[b]=this.getText(b)));return c}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],a):"object"==typeof module&&module.exports?a(require("./load-image"),require("./load-image-scale"),require("./load-image-meta")):a(window.loadImage)}(function(a){"use strict";var b=a.hasCanvasOption,c=a.hasMetaOption,d=a.transformCoordinates,e=a.getTransformedOptions;a.hasCanvasOption=function(c){return!!c.orientation||b.call(a,c)},a.hasMetaOption=function(b){return b&&b.orientation===!0||c.call(a,b)},a.transformCoordinates=function(b,c){d.call(a,b,c);var e=b.getContext("2d"),f=b.width,g=b.height,h=b.style.width,i=b.style.height,j=c.orientation;if(j&&!(j>8))switch(j>4&&(b.width=g,b.height=f,b.style.width=i,b.style.height=h),j){case 2:e.translate(f,0),e.scale(-1,1);break;case 3:e.translate(f,g),e.rotate(Math.PI);break;case 4:e.translate(0,g),e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI),e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI),e.translate(0,-g);break;case 7:e.rotate(.5*Math.PI),e.translate(f,-g),e.scale(-1,1);break;case 8:e.rotate(-.5*Math.PI),e.translate(-f,0)}},a.getTransformedOptions=function(b,c,d){var f,g,h=e.call(a,b,c),i=h.orientation;if(i===!0&&d&&d.exif&&(i=d.exif.get("Orientation")),!i||i>8||1===i)return h;f={};for(g in h)h.hasOwnProperty(g)&&(f[g]=h[g]);switch(f.orientation=i,i){case 2:f.left=h.right,f.right=h.left;break;case 3:f.left=h.right,f.top=h.bottom,f.right=h.left,f.bottom=h.top;break;case 4:f.top=h.bottom,f.bottom=h.top;break;case 5:f.left=h.top,f.top=h.left,f.right=h.bottom,f.bottom=h.right;break;case 6:f.left=h.top,f.top=h.right,f.right=h.bottom,f.bottom=h.left;break;case 7:f.left=h.bottom,f.top=h.right,f.right=h.top,f.bottom=h.left;break;case 8:f.left=h.bottom,f.top=h.left,f.right=h.top,f.bottom=h.right}return f.orientation>4&&(f.maxWidth=h.maxHeight,f.maxHeight=h.maxWidth,f.minWidth=h.minHeight,f.minHeight=h.minWidth,f.sourceWidth=h.sourceHeight,f.sourceHeight=h.sourceWidth),f}});