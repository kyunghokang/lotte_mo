!function(a,b,c){"use strict";var d=b.module("lotteSns",[]),e="[롯데닷컴 이거어때?]\n";d.controller("smsBoxCtrl",["$scope","$http","LotteCommon",function(a,b,c){a.sendSMSData=function(){var d={msg:a.smsTxt,phone_no:a.sms_phoneNo};b({url:c.sendEventSms,data:$.param(d),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(b){b.indexOf("정상적으로 처리되었습니다")>-1?alert("문자가 발송되었습니다."):alert(b),a.hideSharePop()}).error(function(a){console.log("Error Data : 데이터 로딩 에러")})}}]),d.directive("shareBox",["$window","$location","LotteCommon","commInitData","$http","$timeout",function(d,e,f,g,h,i){return{templateUrl:"/lotte/resources_dev/sns/share_box.html",replace:!0,link:function(e,j,k){function l(a){return 10>a?"0"+a:a+""}function m(a,b,c,d,e,f){var g=new Date(a,b,c,d,e,f);return a&&b&&c&&(g.setFullYear(a),g.setMonth(b-1),g.setDate(c),d&&g.setHours(d),e&&g.setMinutes(e),f&&g.setSeconds(f)),g.getTime()}function n(a){return(a+"").length>1?a:"0"+a}function o(){return g.query.goods_no?void h.get("/product/regBestProd.do",{params:{goods_no:g.query.goods_no,sum_dt:v}}).success(function(a){}).error(function(){}):!1}function p(){if(e.share_img&&""!=e.share_img)var a=e.share_img;else if(y<m(2017,4,24,0,0))var a="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg";else var a="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png";e.cnShareUrl=e.cnShareUrl.replace(/(&)/g,"%26"),e.subTitle=e.getDearPetShareTitle(e.subTitle).replace(/(&)/g,"")+e.prdComment.replace(/(&)/g,"");var b="http://m.facebook.com/sharer.php?s=100&u="+encodeURIComponent(f.facebookUrl+"?fb_yn=Y&shareUrl="+e.cnShareUrl+"&shareTitle="+e.getDearPetShareTitle(e.subTitle)+"&shareImg="+a);d.open(b)}function q(){var a=(e.subTitle+e.prdComment,"https://twitter.com/share?text="+encodeURIComponent(e.getDearPetShareTitle(e.subTitle)+e.prdComment+" ")+"&url="+encodeURIComponent(e.cnShareUrl));d.open(a)}var r=new Date,s=r.getFullYear()+"",t=r.getMonth()+1+"",u=r.getDate()+"",v=s+n(t)+n(u),w=new Date,x=w.getFullYear()+l(w.getMonth()+1)+l(w.getDate()),y=w.getTime();if(g.query.testDate){g.query.testDate;x=g.query.testDate,y=m(x.substring(0,4),x.substring(4,6),x.substring(6,8),x.substring(8,10),x.substring(10,12),x.substring(12,14))}var z=function(){i(function(){b.element(document.querySelector("#sms_phoneNo")).focus()})};e.shareSNS=function(a,b){if(("/product/m/product_view.do"==d.location.pathname||"/product/m/product_view_dev.html"==d.location.pathname)&&o(),e.loginInfo.isLogin){var g=f.baseUrl+"/event/regEvent.do?"+e.baseParam,i=f.baseUrl+"/event/saveClover.do?"+e.baseParam,j=e.share_evt_no;b!=c&&""!=b&&(j=b);h({method:"POST",url:g,data:{evt_no:j},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),h({method:"POST",url:i,data:{evt_no:j},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}if(e.appObj.isApp)return e.sendAppShare(a),!1;switch(a){case"sms":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.smsCdn,e.showSmsBox();break;case"kakaotalk":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.talkCdn,e.sendKakaoTalk();break;case"kakaostory":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.stotyCdn,e.sendKakaoStory();break;case"facebook":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.faceCdn,e.sendFacebook();break;case"twitter":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.twitCdn,e.sendTwitter();break;case"url_copy":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.urlCdn,e.urlCopyClick(e.cnShareUrl)}},e.urlCopyClick=function(a){e.sendTclick(e.tClickBase+"share_Clk_Pop_5"),e.urlCopyFlag=!e.urlCopyFlag},e.showSmsBox=function(){if(e.sendTclick(e.tClickBase+"share_Clk_Pop_6"),e.appObj.isTablet)e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl,b.element(document).on("focus","input, textarea",function(a){j[0].style.cssText=""});else if(e.appObj.isAndroid)if(e.appObj.isTablet)e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl;else{var c=encodeURIComponent(e.getDearPetShareTitle(e.subTitle).replace(/(&)/g,"%26")+e.prdComment.replace(/(&)/g,"%26")+" "+e.cnShareUrl.replace(/(&)/g,"%26"));a.open("sms:?body="+c)}else e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl,z()},e.sendAppShare=function(a){"sms"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_6"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.smsCdn),"kakaotalk"==a&&(e.appObj.isOldApp?e.kakaoType="":e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_1"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.talkCdn),"kakaostory"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_4"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.stotyCdn),"facebook"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_2"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.faceCdn),"twitter"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_3"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.twitCdn),"url_copy"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_5"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.urlCdn),"moreapp"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_8"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.appCdn),"mail"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_7"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.mailCdn),e.share_img&&""!=e.share_img?e.share_img=e.share_img:y<m(2017,4,24,0,0)?e.share_img="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.share_img="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png";var b={url:e.cnShareUrl,title:e.kakaoType+e.getDearPetShareTitle(e.subTitle).replace(/#/gi,"")+e.prdComment.replace(/#/gi,""),imageUrl:e.share_img};e.appObj.isAndroid?d.lotteshare.callAndroid("lotteshare://"+a+"/query?"+JSON.stringify(b)):e.appObj.isIOS&&(d.location="lotteshare://"+a+"/query?"+JSON.stringify(b))},e.sendKakaoStory=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_4"),e.share_img&&""!=e.share_img?e.share_img=e.share_img:y<m(2017,4,24,0,0)?e.share_img="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.share_img="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png",Kakao.Story.open({url:e.cnShareUrl,text:e.getDearPetShareTitle(e.subTitle)+e.prdComment+"\n",urlInfo:{images:[e.share_img]}})},e.sendKakaoTalk=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_1"),e.share_img&&""!=e.share_img?e.img_url=e.share_img:y<m(2017,4,24,0,0)?e.img_url="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.img_url="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png",e.appShareUrl=e.cnShareUrl.replace("http","mlotte001"),Kakao.Link.sendTalkLink({label:e.getDearPetShareTitle(e.subTitle)+e.prdComment+"\n"+e.cnShareUrl,image:{src:e.img_url,width:"280",height:"280"},appButton:{text:"롯데닷컴",execParams:{iphone:{executeurl:e.appShareUrl},android:{executeurl:e.appShareUrl}}},installTalk:!0})},e.sendFacebook=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_2"),p()},e.sendTwitter=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_3"),q()}}}}]),d.directive("smsBox",["$window",function(a){return{templateUrl:"/lotte/resources_dev/sns/sms_box.html",controller:"smsBoxCtrl",link:function(a,c,d){a.focusInput=!0,a.sendShareSMS=function(){$.isNumeric(a.sms_phoneNo)&&a.sms_phoneNo.length<=11&&a.sms_phoneNo.length>=10?a.sendSMSData():alert("휴대폰 번호를 정상적으로 입력해주세요.")},a.appObj.isIOS&&b.element(document).on("focus","input, textarea",function(a){c[0].style.cssText=""})}}}]),d.directive("numericOnly",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){var b=a?a.replace(/[^\d.-]/g,""):null;return b!=a&&(d.$setViewValue(b),d.$render()),b})}}}),d.directive("sharePop",["$window","$location","LotteCommon","$timeout",function(d,f,g,h){return{templateUrl:"/lotte/resources_dev/sns/share_pop.html",replace:!0,link:function(d,f,i){function j(){var b={};return a.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,c,d){b[c]=d}),b}function k(){var a=j(),b=["c","cdn","cn","schema","tclick","udid","v"],c="",d="";for(var e in a)b.indexOf(e)>=0||(c+=d+e+"="+a[e],d="&");return c}d.isBeforeShareBox=!1,d.sharePopVisible=!1,d.shareBoxVisible=!1,d.snsTitle="친구에게 공유하기",d.getDearPetShareTitle=function(a){try{d.shareCodeis&&(a="["+d.shareCodeis+" "+d.subTitle+"]\n",e="")}catch(b){}try{"DearpetGallary"==d.screenID||"Mombaby"==d.screenID||d.shareNoFixMessage||(a=e+a)}catch(b){a=e+a}try{a=a.replace("[[","["),a=a.replace("]]","]")}catch(b){console.log("shareTitle replace err")}return a},d.showSharePop=function(a,e){try{Kakao.cleanup(),1==d.appObj.isSktApp?Kakao.init("7a460fb5cdebe4589041db57d906ddda"):Kakao.init("574659987ca46095c123d71f72abac14")}catch(f){if(console.log("PC-MODE"),location.host.indexOf("localhost")<0)return}d.prdComment="",d.share_path=location.pathname,d.testParam=j();try{a.prdComment=a.prdComment.replace(/[<]br[/][>]/gi,"\n")}catch(f){}var i=new Date,l=i.getFullYear().toString(),m=(i.getMonth()+1).toString(),n=i.getDate().toString();switch(d.nowDate=l+(m[1]?m:"0"+m[0])+(n[1]?n:"0"+n[0]),d.nowDate>=20171101&&d.nowDate<20171201?d.share_evt_no="329938":d.nowDate>=20171201&&d.nowDate<20180101?d.share_evt_no="329939":d.nowDate>=20171001&&d.nowDate<20171101?d.share_evt_no="326343":d.share_evt_no="302853","/mylotte/product/m/mylotte_crit_view.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," "),b.isDefined(a.goodsNo)?d.goodsNo=a.goodsNo:d.goodsNo="",b.isDefined(a.shareImg)?d.share_img=a.shareImg:d.share_img=""):"/product/m/product_view.do"==d.share_path||"/product/m/sub/product_comment.do"==d.share_path||"/product/m/sub/product_comment_detail.do"==d.share_path?(d.share_path="/product/m/product_view.do",b.isDefined(a.prdComment)?"Y"==a.healthfood_yn?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.goodsNm,d.prdComment=""):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.goodsNm,d.prdComment="")):"/product/m/photoreview.do"==d.share_path?"Y"==a.healthfood_yn?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.mgoods_nm,d.prdComment=""):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/mall/pet/mitou_gallery.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.bbsNo=a.bbsNo,d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/mall/baby/baby_main.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/product/m/product_list.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg):"/planshop/m/planshop_view.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg):"/product/m/product_view_gucci.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=d.$$childHead.BasicData.product.mgoods_nm):(d.snsTitle="친구에게 공유하기",d.prdComment="",d.share_img=""),d.param="","/product/m/product_view.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo),"/product/m/photoreview.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo,d.share_path="/product/m/product_view.do"),"/mylotte/product/m/mylotte_crit_view.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo),("/product/m/comment_rewrite.do"==d.share_path||"/product/m/comment_write.do"==d.share_path)&&(d.param="?goods_no="+d.testParam.goods_no),"/product/m/product_list.do"==d.share_path&&(b.isDefined(d.testParam.ss_yn)?d.testParam.ss_yn="&ss_yn="+d.testParam.ss_yn:d.testParam.ss_yn="",b.isDefined(d.testParam.shoppingholicYn)?d.testParam.shoppingholicYn="&shoppingholicYn="+d.testParam.shoppingholicYn:d.testParam.shoppingholicYn="",b.isDefined(d.testParam.planShopGubun)?d.testParam.planShopGubun="&planShopGubun="+d.testParam.planShopGubun:d.testParam.planShopGubun="",d.param="?curDispNo="+d.testParam.curDispNo+d.testParam.ss_yn+d.testParam.shoppingholicYn+d.testParam.planShopGubun),"/planshop/m/planshop_view.do"==d.share_path&&(d.param="?spdp_no="+d.testParam.spdp_no),"/event/m/eventSaunMain.do"==d.share_path&&(d.param="?evt_no="+d.testParam.evt_no),"/styleshop/styleshop.do"==d.share_path&&(d.param="?disp_no="+d.testParam.disp_no),"/styleshop/styleshopmen.do"==d.share_path&&(d.param="?keyword="+d.testParam.keyword),"/mall/pet/dearpet_gallery.do"==d.share_path&&(d.param="?curDispNo="+d.testParam.curDispNo+"&beforeNo="+d.testParam.beforeNo+"&cateDepth="+d.testParam.cateDepth),"/mall/baby/baby_main.do"==d.share_path&&(d.param="?dispNo="+d.testParam.dispNo+"&dcate="+d.testParam.dcate+"&mcate="+d.testParam.mcate),"/event/m/kids/experience_view.do"==d.share_path&&(d.param="?evt_no="+d.testParam.evt_no),"/product/m/product_view_gucci.do"==d.share_path&&(d.param="?goods_no="+d.testParam.goods_no),"/category/m/brand_prod_list.do"==d.share_path&&(d.param="?upBrdNo="+(d.testParam.upBrdNo||"")),"/brand/bestbrandMain.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/brand/bestbrandSub.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/mall/samsung/bestsamsung_main.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/mall/samsung/bestsamsung_sub.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),d.share_path){case g.styleRecomUrl:case g.specialMallUrl:case g.specialSubUrl:a!=c&&a.shareImg!=c&&(d.share_img=a.shareImg),d.param="?"+k()}(d.param+"").length>0&&(d.param+="&"),-1==(d.param+"").indexOf("?")&&(d.param="?"+d.param),1==d.appObj.isSktApp?d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"cn=171127":"/mylotte/product/m/mylotte_crit_view.do"==d.share_path||"/product/m/comment_rewrite.do"==d.share_path||"/product/m/comment_write.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/product/m/product_view.do"+d.param+"&cn=123624":"/mall/pet/dearpet_gallery.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/mall/pet/dearpet_gallery.do"+d.param:"/category/m/brand_prod_list.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/category/m/brand_prod_list.do"+d.param+"curDispNoSctCd="+(d.testParam.curDispNoSctCd||"")+"&cn=123624":"/brand/bestbrandMain.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/brand/bestbrandMain.do"+d.param+"curDispNo="+(d.testParam.curDispNo||"")+"&cn=123624":"/brand/bestbrandSub.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/brand/bestbrandSub.do"+d.param+"curDispNo="+(d.testParam.curDispNo||"")+"&cateSelected="+(d.testParam.cateSelected||"")+"&cn=123624":"/mall/samsung/bestsamsung_sub.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"&cateSelected="+(d.testParam.cateSelected||"")+"&cn=123624":d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"cn=123624",1==d.appObj.isSktApp?(d.talkCdn="3093671",d.twitCdn="3093668",d.stotyCdn="3093670",d.smsCdn="3093672",d.mailCdn="3158697",d.faceCdn="3093669",d.urlCdn="3158696",d.appCdn="3158696"):(d.talkCdn="2929723",d.twitCdn="2929720",d.stotyCdn="2929722",d.smsCdn="2929725",d.mailCdn="2929724",d.faceCdn="2929721",d.urlCdn="2929719",d.appCdn="2929719"),console.log("opt",e),b.isDefined(e)||(d.talkFlag=!0,d.twitFlag=!0,d.stotyFlag=!0,d.smsFlag=!0,d.mailFlag=!0,d.faceFlag=!0,d.appObj.isAndroid?(d.urlFlag=!0,d.urlCopyFlag=!1):d.appObj.isIOS?d.appObj.isOldApp?(d.urlFlag=!1,d.urlCopyFlag=!1):(d.urlFlag=!0,d.urlCopyFlag=!1):(d.urlFlag=!1,d.urlCopyFlag=!1),d.appObj.isApp&&(d.appObj.isAndroid?d.appFlag=!0:d.appFlag=!1)),"crit"==e&&(d.talkFlag=!0,d.twitFlag=!1,d.stotyFlag=!0,d.smsFlag=!0,d.mailFlag=!0,d.faceFlag=!0,d.urlFlag=!1,d.urlCopyFlag=!1,d.appFlag=!1),d.sharePopVisible=!0,d.shareBoxVisible=!0,d.sharePopTl="이거어때?",a.tclick?d.sendTclick(a.tclick):"/mall/pet/dearpet_gallery.do"==d.share_path?d.sendTclick("m_DC_SpeDisp_Dearpet_Clk_Shr"+d.testParam.curDispNo):"/brand/bestBrandMain.do"==d.share_path||"/brand/bestBrandSub.do"==d.share_path?d.sendTclick("m_DC_"+d.screenID+"_"+d.mallID+"_share"):"/mall/samsung/bestsamsung_main.do"==d.share_path||"/mall/samsung/bestsamsung_sub.do"==d.share_path?d.sendTclick("m_DC_SpeMall_Samsung_share"):d.sendTclick("m_RDC_ProdDetail_Clk_SNS"),d.dimmedOpen({target:"pop_sns",callback:this.hideSharePop}),d.LotteDimm.dimmedOpacity="0.6",h(function(){b.element("#lotteDimm").css("z-index","110")})},d.hideSharePop=function(){d.isBeforeShareBox?(d.shareBoxVisible=!0,d.smsBoxVisible=!1,d.sharePopTl="이거어때?",d.isBeforeShareBox=!1,d.dimmedClose({target:"pop_sns"})):(d.contVisible=!0,d.sharePopVisible=!1,d.shareBoxVisible=!1,d.smsBoxVisible=!1,d.sharePopTl="",d.smsTxt="",d.sms_phoneNo="",d.dimmedClose({target:"pop_sns"}))}}}}])}(window,window.angular);var transformJsonToParam=function(a){var b=[];for(var c in a)if(Array.isArray(a[c]))for(var d=0;d<a[c].length;d++)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]));else b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};!function(a,b,c){"use strict";var d=b.module("product-sub-header",[]);d.directive("productSubHeader",["$http","$timeout","$window","$location","LotteCommon","LotteCookie","LotteStorage","LotteUtil",function(a,b,c,d,e,f,g,h){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_sub_header.html",replace:!0,link:function(a,b,c){a.gotoPrepage=function(){a.jsonLoading=!0,a.sendTclick("m_RDC_header_new_pre"),a.appObj.isNativeHeader?appSendBack():history.go(-1)}}}}]),"undefined"!=typeof module&&module.exports&&(module.exports=d.name)}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","product-sub-header","lotteSns"]);d.controller("ProductCommentCtrl",["$http","$window","$scope","$timeout","LotteCommon","orderByFilter","commInitData","LotteUtil",function(a,c,d,e,f,g,h,i){d.showWrap=!0,d.contVisible=!0,d.productSubTitle="전체 상품평보기",d.screenID="product_comment",d.goodsNo=h.query.goods_no,d.jsonLoading=!1,d.alert=function(a){c.alert(a)},d.consolelog=function(a){console.log(a)},console.log("++++++",d.showSharePop),d.pageUI={page:1,isLastPage:!1,starScoreOpen:!0,customerSatisOpen:!0,filterOption:{sliderOpen:!1,filter1Open:!1,filter1SelVal:0,filter1Names:["최근상품평순","사진상품평순","높은평점순","낮은평점순","추천순"],filter2Open:!0,filter2SelVal:6,filter2Names:["별점전체","5점","4점","3점","2점","1점"]},reqParam:{},loadData:null,filteredItems:[]},d.pageUI.reqParam.goods_no=h.query.goods_no?h.query.goods_no:"",d.pageUI.reqParam.usm_goods_no=h.query.usm_goods_no?h.query.usm_goods_no:"",d.pageUI.reqParam.page=h.query.page?h.query.page:1,d.pageUI.reqParam.all_view_yn="Y",d.pageUI.reqParam.sort="L",d.pageUI.reqParam.star="",d.loadData=function(){d.pageUI.reqParam.page=d.pageUI.page;var b=f.isTestFlag?f.productSubCommentAllData:f.productSubCommentAllData;d.ajaxLoadFlag=!0,d.jsonLoading=!0,a.get(b,{params:d.pageUI.reqParam}).success(function(a){if(a.data)if(console.log("전체 상품평보기 데이터 로드 page:"+d.pageUI.reqParam.page),d.pageUI.reqParam.page>1)if(a.data.critList.total_count>0)for(var b=0;b<a.data.critList.items.length;b++)d.pageUI.loadData.critList.items.push(a.data.critList.items[b]);else d.pageUI.isLastPage=!0;else d.pageUI.loadData=a.data}).error(function(){console.log("Data Error : 전체 상품평보기 데이터 로드 실패"),d.ajaxLoadFlag=!1})["finally"](function(){d.ajaxLoadFlag=!1,d.jsonLoading=!1})},d.loadData(),d.linkClick=function(a,b){console.log("linkUrl",a),c.location.href=i.setUrlAddBaseParam(a,d.baseParam+"&tclick="+b)},d.sortBy=function(a){switch(d.sendTclick(a),d.pageUI.filterOption.filter1SelVal){case 0:d.pageUI.reqParam.sort="L";break;case 1:d.pageUI.reqParam.sort="P";break;case 2:d.pageUI.reqParam.sort="G";break;case 3:d.pageUI.reqParam.sort="B";break;case 4:d.pageUI.reqParam.sort="R"}d.pageUI.page=1,d.pageUI.isLastPage=!1,d.loadData()},d.sortByOpen=function(a){d.sendTclick(a),d.pageUI.filterOption.filter1Open=!d.pageUI.filterOption.filter1Open},d.filterBy=function(a){d.sendTclick(a),d.pageUI.reqParam.star=d.pageUI.filterOption.filter2SelVal,d.pageUI.reqParam.star>5&&(d.pageUI.reqParam.star=""),d.pageUI.page=1,d.pageUI.isLastPage=!1,d.loadData()},d.filterByOpen=function(a){d.sendTclick(a),d.pageUI.filterOption.filter2Open=!d.pageUI.filterOption.filter2Open},d.showHideFilterSlider=function(a){d.sendTclick(a),d.pageUI.filterOption.sliderOpen=!d.pageUI.filterOption.sliderOpen,d.pageUI.filterOption.sliderOpen?d.dimmedOpen({callback:this.showHideFilterSlider}):d.dimmedClose()},d.hideFilterSlider=function(a){d.sendTclick(a),d.dimmedClose()};var j=b.element("body")[0];d.$on("winScroll",function(a,b){d.pageUI.isLastPage!==!0&&!d.ajaxLoadFlag&&j.scrollHeight-2*b.winHeight<=b.scrollPos+b.winHeight&&(console.log("more scroll;;;;;"),d.pageUI.page++,d.loadData())}),d.recommClick=function(b){if(d.loginInfo.isLogin)b.regRecommUrl&&(b.myRecomm=!0,a.get(f.isTestFlag?f.regRecomUrl:b.regRecommUrl).success(function(a){if(a.data){if(alert(a.data.resultMsg),a.data.resultCode)switch(a.data.resultCode){case"01":case"02":b.recommCnt=b.recommCnt+1;case"03":b.recommYn=!0;case"04":break;case"05":}}else alert("다시 한번 시도해주시기 바랍니다.")}));else{alert("로그인을 해주세요.");var e="&targetUrl="+encodeURIComponent(c.location.href,"UTF-8");c.location.href=f.loginUrl+"?"+d.baseParam+e}}}]),d.directive("lotteContainer",["$window","LotteCommon","commInitData",function(a,b,c){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_comment_container.html",replace:!0,link:function(d,e,f){d.isShowBtnTalk=!1,d.productCommentDetailView=function(e){console.log("상품평 사진 클릭"),a.location.href=b.productSubCommentDetail+"?"+d.baseParam+"&goods_no="+c.query.goods_no+"&idx="+e+"&tclick="}}}}]),d.directive("integer",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return parseInt(a,10)})}}}),d.filter("starScorePolicy",function(){return function(a,b){if(!a)return 0;var d=5,e=Math.ceil(2*a)/2;return b!=c&&(e=e/d*b),e}})}(window,window.angular);