var isSwipeActive=!1,isSwipeLock=!1,isLoadingData=!1,LeftSwipeStartExec=!1,RightSwipeStartExec=!1;!function(a,b,c){"use strict";var d=[],e=b.module("lotteNgSwipe",[]);e.controller("lotteNgSwipeCtrl",["$scope",function(a){}]),e.factory("lotteNgSwipe",["$interval","$timeout","$window",function(c,d,e){function f(a){var b=a.touches&&a.touches.length?a.touches:[a],c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}}function g(c,d,e){if(e.SLIDE_SWIPE){var f=d[0].offsetWidth-e.LEFT_MARGIN-e.RIGHT_MARGIN;0==f&&(f=a.innerWidth);var g=f/e.DISP_COUNT,h=0;if(s=d[0].offsetWidth-g-e.LEFT_MARGIN,!(d.find("ul, ol").eq(0).find(">li").length>=1||d.find(">li").length>=1)||e.LOADING_ELEMENT||e.LEFT_ELEMENT||e.RIGHT_ELEMENT)e.LOADING_ELEMENT||b.element(d).eq(0).css(q());else{if(-1!=d.context.className.indexOf("recommond_swipe"))var i=d.find(">li");else var i=d.find("ul, ol").eq(0).find(">li").length>1?d.find("ul, ol").eq(0).find(">li"):d.find(">li");var j=c,k=0,l=null;for(k;k<i.length;j++,k++)l=i.eq(j),h=j>=k||0>j?0>j?g*d.find(">li").length+e.LEFT_MARGIN+(e.EDGE_LAST&&c==i.length-1?s:0):g*k+e.LEFT_MARGIN+(e.EDGE_LAST&&c==i.length-1?s:0):g*-(c-j)+e.LEFT_MARGIN+(e.EDGE_LAST&&c==i.length-1?s:0),-1!=d.context.className.indexOf("latest_swipe")&&a.innerWidth>=640?(f=a.innerWidth,l.css({width:f/2,backfaceVisibility:"hidden",position:"absolute",left:h})):l.css({width:f/e.DISP_COUNT,backfaceVisibility:"hidden",position:"absolute",left:h}),j+1>=d.find(">li").length&&(j=-1);t=i.length,b.element(d).eq(0).css(p(0)),b.element(d).find(">li").css("top",0).eq(0).css("position","relative")}}}function h(a){for(var b={totalwidth:0,width:[],paddingleft:[],marginleft:[],paddingright:[],marginright:[]},c=0;c<a.find(">li").length;c++){var d=a.find(">li:eq("+c+")");b.width[c]=parseInt(d.width()),b.width[c]+=b.marginleft[c]=parseInt(d.css("margin-left")),b.width[c]+=b.marginright[c]=parseInt(d.css("margin-right")),b.width[c]+=b.paddingleft[c]=parseInt(d.css("padding-left")),b.width[c]+=b.paddingright[c]=parseInt(d.css("padding-right")),b.totalwidth+=b.width[c]}return b}function i(b){var c=a.getComputedStyle(b.get(0)),d=new WebKitCSSMatrix(c.webkitTransform);return d.m41}function j(a,c,d,e){isSwipeActive=!0,b.element(a).on(u,function(a){isSwipeActive=!1,c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(r()),b.element(this).css(r()).off(u)}).css(p(0,c.SWIPE_SPEED)),(c.LOADING_ELEMENT||c.LEFT_ELEMENT||c.LEFT_ELEMENT)&&b.element(c.LOADING_ELEMENT).css(p(0,c.SWIPE_SPEED))}function k(c,d,e,f){var g=h(c);if(a.innerWidth-d.LEFT_MARGIN-d.RIGHT_MARGIN>g.totalwidth)return!1;for(var j=a.innerWidth/2,k=g.width[e]/2,m=0,n=0;n<g.width.length&&n!=e;n++)m+=g.width[n];var o=i(c),q=-1*(m-j+k);f?(q>0?q=0:q<-(g.totalwidth-a.innerWidth+d.RIGHT_MARGIN)&&(q=-(g.totalwidth-a.innerWidth+d.RIGHT_MARGIN)),b.element(c).eq(0).css(p(q))):Math.abs(m)>j&&g.totalwidth-a.innerWidth+d.RIGHT_MARGIN>Math.abs(q)?l(c[0],d,o,q):Math.abs(m)<=j?l(c[0],d,o,0):l(c[0],d,o,-1*(g.totalwidth-a.innerWidth)-d.RIGHT_MARGIN)}function l(a,c,d,e){return d==e?!0:(b.element(a).on(u,function(a){c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(r()),b.element(this).css(r()).off(u)}).css(p(e,c.SWIPE_SPEED)),void(c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(p(e,c.SWIPE_SPEED))))}function m(a,c,d,e){isSwipeActive=!0,b.element(a).on(u,function(a){isSwipeActive=!1,c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(r()),b.element(this).css(r()).off(u)}).css(p(d>=0?e:-e,c.SWIPE_SPEED)),c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(p(d>=0?e:-e,c.SWIPE_SPEED))}function n(a,c,d,e,f){return 0>d?f=f+c.DISP_COUNT>c.MAX_SLIDE?c.MAX_SLIDE:f+c.DISP_COUNT:f-=c.DISP_COUNT,c.EDGE_LAST&&(f==t-1||f==t-2&&d>0)&&(e-=s),b.element(a).on(u,function(d){c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(r()),g(f,a,c),b.element(this).css(r()).off(u)}).css(p(d>=0?e:-e,c.SWIPE_SPEED)),c.LOADING_ELEMENT&&b.element(c.LOADING_ELEMENT).css(p(d>=0?e:-e,c.SWIPE_SPEED)),f}function o(b,c,d){var e=i(b);return e>0?(m(b[0],c,e,0),e=0):Math.abs(e)+a.innerWidth>Math.abs(d.totalwidth)+c.RIGHT_MARGIN&&(m(b[0],c,e,d.totalwidth-a.innerWidth+c.RIGHT_MARGIN),e=-1*(d.totalwidth-a.innerWidth)),e}function p(a,b){var c={"-webkit-backface-visibility":"hidden","-moz-backface-visibility":"hidden","backface-visibility":"hidden","-webkit-transform":"translateX("+a+"px)","-ms-transform":"translateX("+a+"px)","-moz-transform":"translateX("+a+"px)",transform:"translateX("+a+"px)","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""};return b&&b>0&&(c["-webkit-transition"]="-webkit-transform "+b+"ms",c["-moz-transition"]="-moz-transform "+b+"ms",c["-o-transition"]="-o-transform "+b+"ms",c.transition="transform "+b+"ms"),c}function q(){return{"-webkit-backface-visibility":"","-moz-backface-visibility":"","backface-visibility":"","-webkit-transform":"","-ms-transform":"","-moz-transform":"",transform:""}}function r(a){return a||(a=""),{"-webkit-transition":a,"-moz-transition":a,"-o-transition":a,transition:a}}var s=0,t=0,u="transitionend.ngswipe webkitTransitionEnd.ngswipe oTransitionEnd.ngswipe MSTransitionEnd.ngswipe";return{unbind:function(a){a.off("touchstart.ngswipe mousedown.ngswipe touchcancel.ngswipe touchmove.ngswipe mousemove.ngswipe touchend.ngswipe mouseup.ngswipe")},bind:function(d,g,k){var l,r,u,v,w=d[0],x=!1,y=g.FIRST_INDEX,z=b.element(d).scope(),A=!1,B=!1,C=[],D=0,E=0,F=0,G=!0,H=(g.DISP_COUNT,navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1),I=!0,J=30,K=b.element(e).scrollTop();g.SLIDE_MENU_SWIPE&&b.element(w).css(p(0)),d.on("touchstart.ngswipe mousedown.ngswipe",function(c){if(c.stopPropagation(),H){var j=b.element(e).scrollTop();j+J>K&&K>j-J?I=!0:(I=!1,K=j)}A=!1,B=!1,g.SLIDE_MENU_SWIPE&&(C=h(d),G=a.innerWidth-g.LEFT_MARGIN-g.RIGHT_MARGIN>C.totalwidth?!1:!0),isSwipeLock||G&&(a.innerWidth>=900&&g.RESPONSIVE_SWIPE?g.DISP_COUNT=g.RESPONSIVE_SWIPE_900:a.innerWidth>=640&&g.RESPONSIVE_SWIPE?g.DISP_COUNT=g.RESPONSIVE_SWIPE_640:g.RESPONSIVE_SWIPE&&(g.DISP_COUNT=g.RESPONSIVE_SWIPE_320),g.MAX_SLIDE=d.find(">li").length-1,(!(g.MAX_SLIDE<1)||g.LOADING_ELEMENT||g.LEFT_ELEMENT||g.RIGHT_ELEMENT)&&(u=f(c),u.x+=g.EDGE_LAST&&y==t-1?s:0,x=!0,l=0,r=0,isSwipeActive=!0,v=u,y=z.swipeIdx,E=(new Date).getTime(),g.SLIDE_MENU_SWIPE&&(C=h(d),D=i(d)),k.start&&k.start(u,c),g.LOADING_ELEMENT&&b.element(g.LOADING_ELEMENT).css({position:"fixed",zIndex:g.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-w.offsetTop,height:a.innerHeight-w.offsetTop,width:"100%",left:w.offsetWidth,right:"auto"}).removeClass("none"),g.LEFT_ELEMENT&&b.element(g.LEFT_ELEMENT).css({position:"fixed",zIndex:g.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-w.offsetTop,height:a.innerHeight-w.offsetTop,width:"100%",left:w.offsetWidth,right:"auto"}).removeClass("none"),g.RIGHT_ELEMENT&&b.element(g.RIGHT_ELEMENT).css({position:"fixed",zIndex:g.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-w.offsetTop,height:a.innerHeight-w.offsetTop,width:"100%",left:w.offsetWidth,right:"auto"}).removeClass("none")))}),d.on("touchcancel.ngswipe",function(a){x=!1,j(w,g,u,v)}),d.on("touchmove.ngswipe mousemove.ngswipe",function(a){if(x&&G&&u){var c=f(a);c.x+=g.EDGE_LAST&&y==t-1?s:0,l+=Math.abs(c.x-v.x),r+=Math.abs(c.y-v.y),v=c;var d,e;d=Math.abs(c.x-u.x),e=Math.abs(c.y-u.y),A||(B=d>e,A=!0);var h=v.x-u.x;if(h>0?a.moveto="right":a.moveto="left",B&&(I||!H)){a.preventDefault(),a.stopPropagation();g.SLIDE_MENU_SWIPE?b.element(w).css(p(c.x-u.x+D)):b.element(w).css(p(c.x-u.x)),g.LOADING_ELEMENT&&b.element(g.LOADING_ELEMENT).css(b.extend({left:c.x-u.x<=0?w.offsetWidth:"auto",right:c.x-u.x<=0?"auto":w.offsetWidth},p(c.x-u.x))),"left"==a.moveto?(g.RIGHT_ELEMENT&&b.element(g.RIGHT_ELEMENT).css(b.extend({left:c.x-u.x<=0?w.offsetWidth:"auto",right:c.x-u.x<=0?"auto":w.offsetWidth},p(0))),g.LEFT_ELEMENT&&b.element(g.LEFT_ELEMENT).css(p(0))):(g.LEFT_ELEMENT&&b.element(g.LEFT_ELEMENT).css(b.extend({left:c.x-u.x<=0?w.offsetWidth:"auto",right:c.x-u.x<=0?"auto":w.offsetWidth},p(0))),g.RIGHT_ELEMENT&&b.element(g.RIGHT_ELEMENT).css(p(0))),k.move&&k.move(c,a)}}}),d.on("touchend.ngswipe mouseup.ngswipe",function(h){if(h.stopPropagation(),A=!1,B&&(I||!H)){if(!x||!G)return;x=!1,isSwipeActive=!1;var i=d[0].offsetWidth,l=Math.abs(v.x-u.x),r=v.x-u.x;if(F=(new Date).getTime(),r>0?h.moveto="right":h.moveto="left",h.max=g.MAX_SLIDE,g.SLIDE_MENU_SWIPE){var z=v.x-u.x+D,J=-80,L="left"==h.moveto?z+J:z-J,M="left"==h.moveto?-5:5;if(Math.abs(v.x-u.x)>5&&400>=F-E)var N=c(function(){z+=M,b.element(d).eq(0).css(p(z)),(L>=z&&"left"==h.moveto||z>=L&&"right"==h.moveto||z>0||z<=-C.totalwidth+a.innerWidth)&&(D=o(d,g,C),c.cancel(N))},10);else D=o(d,g,C)}else if(i*g.MAX_RATIO<=l){if(g.SLIDE_SWIPE){if(y>=g.MAX_SLIDE&&0>r||0>y&&r>0||0==y&&r>0||g.MAX_SLIDE+1<=g.DISP_COUNT||y+g.DISP_COUNT>g.MAX_SLIDE&&"left"==h.moveto)return void j(w,g,u,v+(g.EDGE_LAST&&y==t-1?s:0));if(g.SLIDE_SWIPE)var i=i-g.LEFT_MARGIN-g.RIGHT_MARGIN;y=n(d,g,r,i,y),h.idx=y}else m(w,g,r,i);var O=f(h);O.x+=g.EDGE_LAST&&y==t-1?s:0;k.end&&k.end(O,h)}else j(w,g,u,v),b.element(d).eq(0).css(q())}H&&(K=b.element(e).scrollTop(),I=!0),u=null})},moveSwipeX:n,positionReCalc:g,resetSwipe:j,moveMenuSwipe:k,getListInfo:h}}]),e.directive("lotteNgListSwipe",["$window","$parse","$timeout","lotteNgSwipe",function(e,f,g,h){return{link:function(i,j,k){function l(a,b){var c={"-webkit-backface-visibility":"hidden","-moz-backface-visibility":"hidden","backface-visibility":"hidden","-webkit-transform":"translateX("+a+"px)","-ms-transform":"translateX("+a+"px)","-moz-transform":"translateX("+a+"px)",transform:"translateX("+a+"px)","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""};return b&&b>0&&(c["-webkit-transition"]="-webkit-transform "+b+"ms",c["-moz-transition"]="-moz-transform "+b+"ms",c["-o-transition"]="-o-transform "+b+"ms",c.transition="transform "+b+"ms"),c}function m(){var c=j[0];if(a.innerWidth>=900&&p.RESPONSIVE_SWIPE?p.DISP_COUNT=p.RESPONSIVE_SWIPE_900:a.innerWidth>=640&&p.RESPONSIVE_SWIPE?p.DISP_COUNT=p.RESPONSIVE_SWIPE_640:p.RESPONSIVE_SWIPE&&(p.DISP_COUNT=p.RESPONSIVE_SWIPE_320),p.LOADING_ELEMENT&&b.element(p.LOADING_ELEMENT).css("min-height",a.innerHeight-c.offsetTop+"px"),p.LEFT_ELEMENT&&b.element(p.LEFT_ELEMENT).css("min-height",a.innerHeight-c.offsetTop+"px"),p.RIGHT_ELEMENT&&b.element(p.RIGHT_ELEMENT).css("min-height",a.innerHeight-c.offsetTop+"px"),0!=i.swipeIdx&&p.DISP_COUNT>1){var d=i.swipeIdx%p.DISP_COUNT;0!=d&&(i.swipeIdx-=d)}if(i.swipeBulletIdx=parseInt(i.swipeIdx/p.DISP_COUNT),p.SLIDE_MENU_SWIPE){var e=h.getListInfo(j);e.width.length>1&&a.innerWidth-p.LEFT_MARGIN-p.RIGHT_MARGIN>e.totalwidth&&b.element(c).css(l(0))}p.LOADING_ELEMENT&&b.element(p.LOADING_ELEMENT).css({position:"fixed",zIndex:p.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-c.offsetTop,height:a.innerHeight-c.offsetTop,width:"100%",left:c.offsetWidth,right:"auto"}).removeClass("none"),p.LEFT_ELEMENT&&b.element(p.LEFT_ELEMENT).css({position:"fixed",zIndex:p.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-c.offsetTop,height:a.innerHeight-c.offsetTop,width:"100%",left:c.offsetWidth,right:"auto"}).removeClass("none"),p.RIGHT_ELEMENT&&b.element(p.RIGHT_ELEMENT).css({position:"fixed",zIndex:p.LOADING_ELEMENT_ZINDEX,minHeight:a.innerHeight-c.offsetTop,height:a.innerHeight-c.offsetTop,width:"100%",left:c.offsetWidth,right:"auto"}).removeClass("none"),i.ngswipeInit(),h.positionReCalc(i.swipeIdx,j,p)}function n(a,b){if(!(LeftSwipeStartExec&&"left"==a.moveto||RightSwipeStartExec&&"right"==a.moveto)){"left"==a.moveto?LeftSwipeStartExec=!0:RightSwipeStartExec=!0;var c=null;i.$apply(function(){return c=q(i.$parent,{$event:{idx:a.idx,max:b.MAX_SLIDE,moveto:a.moveto}})})}}function o(a,c){if(isSwipeActive)return g(function(){o(a,c)},100),!1;var d=null;i.$apply(function(){return d=r(i.$parent,{$event:{idx:a.idx,max:c.MAX_SLIDE,moveto:a.moveto}}),"translateX_Reset"==d&&g(function(){b.element(j).eq(0).css(l(0))},500),d})}var p={MAX_RATIO:k.swipeMaxRatio?k.swipeMaxRatio:.3,MIN_DISTANCE:k.swipeMinDistance?k.swipeMinDistance:25,SWIPE_LOOP:k.swipeLoop?k.swipeLoop:!1,LEFT_ELEMENT:k.swipeLeftEl?k.swipeLeftEl:null,RIGHT_ELEMENT:k.swipeRightEl?k.swipeRightEl:null,LOADING_ELEMENT:k.swipeLoadingEl?k.swipeLoadingEl:null,LOADING_ELEMENT_ZINDEX:k.swipeLoadingElZindex?k.swipeLoadingElZindex:50,SLIDE_SWIPE:k.swipeSlideItem?k.swipeSlideItem:!1,SLIDE_MENU_SWIPE:k.swipeSlideMenu?k.swipeSlideMenu:!1,RESPONSIVE_SWIPE:k.swipeResponsive?k.swipeResponsive:!1,RESPONSIVE_SWIPE_320:parseInt(k.swipeResponsive320)?parseInt(k.swipeResponsive320):1,RESPONSIVE_SWIPE_640:parseInt(k.swipeResponsive640)?parseInt(k.swipeResponsive640):2,RESPONSIVE_SWIPE_900:parseInt(k.swipeResponsive900)?parseInt(k.swipeResponsive900):2,AUTO_HEIGHT:k.swipeAutoheight?k.swipeAutoheight:!1,DISP_COUNT:k.swipeDispCount?parseInt(k.swipeDispCount):1,FIRST_INDEX:k.swipeFirstIndex?parseInt(k.swipeFirstIndex):0,LEFT_MARGIN:k.swipeLeftMargin?parseInt(k.swipeLeftMargin):0,RIGHT_MARGIN:k.swipeRightMargin?parseInt(k.swipeRightMargin):0,START_EXEC:k.swipeStartExec?k.swipeStartExec:null,EXEC:k.swipeEndExec?k.swipeEndExec:null,LIST_SCOPE:k.swipeListModel?k.swipeListModel:null,SWIPE_ID:k.swipeId?k.swipeId:"",MAX_SLIDE:0,SWIPE_SPEED:k.swipSpeed?k.swipSpeed:150,IGNORE_DESTORY:k.ignoreDestory?k.ignoreDestory:!1,EDGE_LAST:k.swipeEdgeLast?!0:!1};i.swipeIdx=p.FIRST_INDEX,i.swipeBulletIdx=parseInt(i.swipeIdx/p.DISP_COUNT),i.swipeBullet=[];var q=null,r=null;if(null!=p.START_EXEC&&(q=f(p.START_EXEC)),null!=p.EXEC&&(r=f(p.EXEC)),p.RESPONSIVE_SWIPE&&(p.DISP_COUNT=p.RESPONSIVE_SWIPE_320),p.SLIDE_MENU_SWIPE&&(i.moveMenuSwipe=function(a){i.moveMenuSwipeFnc(a,!1)},i.moveMenuSwipeFnc=function(a,b){h.moveMenuSwipe(j,p,a,b)}),p.SLIDE_MENU_SWIPE||p.SLIDE_SWIPE||(i.translateX_Reset=function(){console.log("스와이프 좌표 리셋"),b.element(j).eq(0).css(l(0)),p.LOADING_ELEMENT&&b.element(p.LOADING_ELEMENT).css(l(0))}),i.setSlide=function(a){0>a?a=p.MAX_SLIDE:a>p.MAX_SLIDE&&(a=0),i.swipeIdx=a,null!=p.EXEC&&(r(i.$parent,{$event:{idx:i.swipeIdx,max:p.MAX_SLIDE}}),console.log("Call swipe exec. "+p.EXEC))},i.goSlide=function(a){h.positionReCalc(a,j,p),i.swipeIdx=i.swipeBulletIdx=a,null!=p.EXEC&&(r(i.$parent,{$event:{idx:i.swipeIdx,max:p.MAX_SLIDE}}),console.log("Call swipe exec. "+p.EXEC))},i.nextSlide=function(){i.swipeIdx!=p.MAX_SLIDE&&(h.moveSwipeX(j,p,-1,j[0].offsetWidth-10,i.swipeIdx),i.swipeIdx+=p.DISP_COUNT,i.swipeBulletIdx++,null!=p.EXEC&&(r(i.$parent,{$event:{idx:i.swipeIdx,max:p.MAX_SLIDE}}),console.log("Call swipe exec. "+p.EXEC)))},i.beforeSlide=function(){0!=i.swipeIdx&&(h.moveSwipeX(j,p,1,j[0].offsetWidth-10,i.swipeIdx),i.swipeIdx-=p.DISP_COUNT,i.swipeBulletIdx--,null!=p.EXEC&&(r(i.$parent,{$event:{idx:i.swipeIdx,max:p.MAX_SLIDE}}),console.log("Call swipe exec. "+p.EXEC)))},i.ngswipeInit=function(){if(p.SLIDE_SWIPE){i.swipeBullet=[],p.MAX_SLIDE=j.find(">li").length;for(var a=0;a<p.MAX_SLIDE/p.DISP_COUNT;a++)i.swipeBullet.push(a)}p.MAX_SLIDE<i.swipeIdx?(i.swipeIdx=p.FIRST_INDEX,i.swipeBulletIdx=parseInt(p.FIRST_INDEX/p.DISP_COUNT),h.positionReCalc(i.swipeIdx,j,p),g(function(){i.$apply()})):i.swipeIdx||(i.swipeBulletIdx=parseInt(p.FIRST_INDEX/p.DISP_COUNT),i.swipeIdx=p.FIRST_INDEX,g(function(){i.$apply()}))},i.resetSwipePos=function(){h.positionReCalc(i.swipeIdx,j,p)},null!=p.LIST_SCOPE){var s=null;i.$watch(p.LIST_SCOPE,function(a,b){if(a!=c&&a.length>=1){if(s!=a[0]&&(i.swipeIdx=0,i.swipeBulletIdx=0,s=a[0]),"recommondSwipe_0"==k.swipeId||"lastestSwipe_0"==k.swipeId)var d=2e3;else var d=100;g(function(){i.ngswipeInit(),h.positionReCalc(i.swipeIdx,j,p)},d)}},!0)}m(),-1==d.indexOf(p.SWIPE_ID)&&d.push(p.SWIPE_ID);var t=b.element(e);t.on("orientationchange.ngswipe resize.ngswipe",m),i.$on("$destroy",function(){h.unbind(j)}),h.bind(j,p,{start:function(a,b){},move:function(a,b){return null!=p.START_EXEC?(isLoadingData=!0,n(b,p)):void 0},cancel:function(){isLoadingData=!1},end:function(a,b){return isLoadingData=!1,LeftSwipeStartExec=!1,RightSwipeStartExec=!1,i.swipeIdx=b.idx?b.idx:0,i.swipeBulletIdx=parseInt(b.idx/p.DISP_COUNT),i.$apply(),null!=p.EXEC?o(b,p):void 0}})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("lotteSlider",[]);d.controller("LotteSlideCtrl",["$scope",function(b){b.getTranslateXCssObj=function(a,b){var c={"-webkit-backface-visibility":"hidden","-moz-backface-visibility":"hidden","backface-visibility":"hidden","-webkit-transform":"translateX("+a+"px)","-ms-transform":"translateX("+a+"px)","-moz-transform":"translateX("+a+"px)",transform:"translateX("+a+"px)","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""};return b&&b>0&&(c["-webkit-transition"]="-webkit-transform "+b+"ms",c["-moz-transition"]="-moz-transform "+b+"ms",c["-o-transition"]="-o-transform "+b+"ms",c.transition="transform "+b+"ms"),c},b.removeTranslateCSS=function(){return{"-webkit-backface-visibility":"","-moz-backface-visibility":"","backface-visibility":"","-webkit-transform":"","-ms-transform":"","-moz-transform":"",transform:""}},b.getCoordinates=function(a){var b=a.touches&&a.touches.length?a.touches:[a],c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}},b.getTransXPos=function(b){var c=a.getComputedStyle(b.get(0)),d=new WebKitCSSMatrix(c.webkitTransform);return d.m41}}]),d.directive("lotteSlider",["$window","$timeout","$parse",function(a,c,d){return{controller:"LotteSlideCtrl",link:function(d,e,f,g){function h(){m=k.outerWidth(),l.css({display:"inline-block"}),n=l.outerWidth(),x=-(n-m);var a=d.getTransXPos;(a.x>0||a.x<x)&&i(0,500)}function i(a,b){l.css(d.getTranslateXCssObj(a,b)),k.trigger({type:"slide",posX:a,wrapWidth:m,contWidth:n})}function j(){k.on({"touchstart.lotteSlider":function(a){m=k.outerWidth(),n=l.outerWidth(),y=!1,z=!1,n>m&&(a.stopPropagation(),o=!0,q=d.getCoordinates(a),p=d.getTransXPos(l),t=Date.now())},"touchmove.lotteSlider":function(a){if(o){var b,c;if(r=d.getCoordinates(a),b=Math.abs(r.x-q.x),c=Math.abs(r.y-q.y),y||(z=b>c,y=!0),z){b>5&&a.preventDefault(),a.stopPropagation();var e=p+r.x-q.x;e>0?e/=3:x>e&&(e=x+(e-x)/3),i(e,0)}}},"touchend.lotteSlider":function(a){if(s=d.getCoordinates(a),o&&q.x!=s.x&&(Math.abs(q.x-s.x)>5&&a.preventDefault(),event.stopPropagation(),y=!1,z)){m=k.outerWidth();var b=d.getTransXPos(l);u=Date.now(),w=q.x>s.x?-1:1,v=u-t;var c=Math.abs(q.x-s.x),e=.4,f=c*e/v,g=b+m*f*w;g>0?g=0:x>g&&(g=x),(Math.abs(b-g)>30||0==g||g==x)&&i(g,500)}},"touchcancel.lotteSlider":function(a){}}),b.element(a).on("resize.lotteSlider orientationchange.lotteSlider",function(){h()})}var k=b.element(e),l=k.find(">").eq(0),m=k.width(),n=l.width(),o=!1,p=0,q=null,r=null,s=null,t=0,u=0,v=0,w=0,x=0;d.lotteSliderMoveXPos=function(a,b){m=k.width(),n=l.width(),a>0?a=0:Math.abs(a)>n-m&&(a=-(n-m)),b||(b=0),i(a,b)},d.reset=function(){o=!1,i(0,0),c(function(){h()})};var y=!1,z=!1;c(function(){h(),j()})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteNgSwipe","lotteSlider"]);d.controller("TalkRecomCtrl",["$scope","LotteCommon","commInitData","$window",function(a,b,d,e){a.DEV_MODE="Y"==d.query.dev_mode,"m.lotte.com"==location.host&&(a.DEV_MODE=!1),a.showWrap=!0,a.contVisible=!0,a.subTitle="스마트 톡추천",a.isAutoScrollEnabled=!0,a.isWaitingResponse=!1,a.isLoadingData=!1,a.isLoadingProd=!1,a.waitingTO,a.isReasonVisible=!1,a.isInformVisible=!1,a.isProfileVisible=!1,a.TEMP_OPTION=null,a.WEEK=["일","월","화","수","목","금","토"],a.CHAT_QUE=[],a.PROD_QUE=[],a.GROUPS=[],a.GROUP_MAP={},a.PRODUCT_MAP={},a.PROD_GROUP_SIZE=5,a.TALK_BUFFER=[],a.PROD_BUFFER={},a.userInputText="",a.recomReason=null,a.currentChatQue=null,a.currentCartOption=null,a.currentTalkOption=null,a.currentOptionPre=null,a.currentCateOption=null,a.timeDifference=0,a.getDateTime=function(b){if(b==c||""==b){var d=new Date;return d.setTime(d.getTime()+a.timeDifference),d}var e=parseInt(b.substr(0,4),10),f=parseInt(b.substr(4,2),10)-1,g=parseInt(b.substr(6,2),10),h=parseInt(b.substr(8,2),10),i=parseInt(b.substr(10,2),10),j=parseInt(b.substr(12,2),10);return new Date(e,f,g,h,i,j)},a.getDateTimeString=function(){var b=a.getDateTime(),c=b.getFullYear(),d=b.getMonth()+1;10>d&&(d="0"+d);var e=b.getDate();10>e&&(e="0"+e);var f=b.getHours();10>f&&(f="0"+f);var g=b.getMinutes();10>g&&(g="0"+g);var h=b.getSeconds();return 10>h&&(h="0"+h),""+c+d+e+f+g+h}}]),d.directive("lotteContainer",["LotteCommon","$window","$timeout","$interval","$http","LotteStorage","LotteUserService","LotteUtil",function(d,e,f,g,h,j,k,l){return{templateUrl:"/lotte/resources_dev/talk/talkRecom_container.html",replace:!0,link:function(m,n,o){function p(a){switch(a){case"reatedKeyword":a="연관검색어";break;case"colors":a="색상";break;case"price":a="가격대";break;case"smpDept":a="백화점 스마트픽";break;case"smpickBranch":a="백화점 스마트픽";break;case"smpSeven":a="세븐일레븐 스마트픽";break;case"tdar":a="오늘도착";break;case"quick":a="퀵배송";break;case"freediv":a="무료배송";break;case"noint":a="무이자";break;case"point":a="포인트";break;case"freepack":a="무료포장";break;case"deliver":a="배송"}return a}function q(){if(ja=m.loginInfo.mbrNo,ka=m.loginInfo.name,ja==c||""==ja){var a=encodeURIComponent(d.talkRecomUrl+"?"+m.baseParam);return void m.gotoService("loginUrl",{targetUrl:a})}fa(),m.callAppAPI("startTalk?"+ua);var b=j.getLocalStorage("TALK_RECOM_LCST","json");if(b==c||b.groups==c)D({command:"getGroups"});else{if(ja!=b.memberno)return void D({command:"getGroups"});m.GROUPS=b.groups;for(var e,h=m.GROUP_MAP,i=m.GROUPS,k=i.length,l=0;k>l;l++)e=i[l],h[e.group_id]=e;var n,o;i.forEach(function(a,b){n=a.section_list,n!=c&&n.forEach(function(a,b){o=a.list,o!=c&&o.forEach(function(a,b){a.goods_no!=c&&a.goods_no.length>0&&(a.prodChecked=!1,m.PROD_BUFFER[a.gr_tk_id]=a)})})}),D({command:"getGroups"}),f(function(){null==history.state||"talkrecom"!=history.state.name?(history.replaceState({name:"talkrecom"},"talkrecom"),v(!0)):isNaN(b.scrollTop)?v(!0):scrollTo(0,b.scrollTop)},1)}g(K,1e3)}function r(a,c){switch(da(a),a){case"reason":m.recomReason=c,m.isReasonVisible=!0,m.setPopupPosition(".tr_popup_reason");break;case"inform":m.isInformVisible=!0,m.setPopupPosition(".tr_popup_inform");break;case"profile":m.isProfileVisible=!0,m.setPopupPosition(".tr_popup_profile")}f(function(){b.element(".tr_popup").unbind("touchmove").bind("touchmove",function(a){a.preventDefault()})},10)}function s(){u(),m.setWaitingResponse(!0)}function t(){u(),m.waitingTO=f(function(){m.setWaitingResponse(!1)},10)}function u(){m.waitingTO!=c&&f.cancel(m.waitingTO)}function v(a){a===!0?scrollTo(0,document.body.scrollHeight):($("html, body").stop(!0),$("html, body").animate({scrollTop:document.body.scrollHeight},400))}function w(a){if(a!=c){var b=[].concat(a.goods_no);b.splice(0,m.PROD_GROUP_SIZE);var d,e=m.GROUPS.length;if(e>0&&(d=m.GROUPS[e-1]),d!=c){var f=m.getDateTimeString(),g=f.substr(8),h=d.section_list;e=h.length;var i,j;e>0&&(i=h[e-1],e=i.list.length,e>0&&(j=i.list[e-1],f<j.date&&(f=j.date),g=j.talk_id));var k={talk_list:[{auth:"U",date:f,group_id:d.group_id,talk_id:g+"_0",text:"더보기"},{auth:"A",date:f,group_id:d.group_id,talk_id:g+"_1",text:"더 보여 드릴게요."},{auth:"A",date:f,group_id:d.group_id,talk_id:g+"_3",text:"",goods_no:b,goods_data:a.goods_data}],local:"Y"};L(k),m.isAutoScrollEnabled=!0,m.scrollToBottom()}}}function x(a){if(a!=c&&b.isArray(a)&&0!=a.length){var d,e,f;if(e=m.GROUPS.length,e>0&&(f=m.GROUPS[e-1]),f!=c){var g=m.getDateTimeString(),h=g.substr(8),i={talk_list:[],local:"Y"},j=f.section_list;e=j.length;var k,l;e>0&&(k=j[e-1],e=k.list.length,e>0&&(l=k.list[e-1],g<l.date&&(g=l.date),h=l.talk_id));var n,o;for(e=a.length,d=0;e>d;d++)n=a[d],n.text!=c&&(o="U"==n.auth?"U":"A",i.talk_list.push({auth:o,date:g,group_id:f.group_id,talk_id:h+"_"+d,text:n.text}));L(i),m.isAutoScrollEnabled=!0,m.scrollToBottom()}}}function y(a){if(a!=c&&a.goods_no!=c&&0!=a.goods_no.length){b.isArray(a.goods_no)||(a.goods_no=[a.goods_no]);var d={goods_no:a.goods_no.join(),gr_tk_id:a.gr_tk_id};if(a.goods_data!=c&&a.goods_data.length>0){var e={result:{response_code:"00000",response_msg:"",response_msgtxt:""},prdLst:{items:a.goods_data,total_count:a.goods_data.length}},f={params:d};return void B(e,"","",f)}m.PROD_QUE.push(d),z()}}function z(){if(0!=m.PROD_QUE.length&&!m.isLoadingProd){m.isLoadingProd=!0;var a=m.PROD_QUE.shift();h.get(ta,{params:a}).success(B).error(A)}}function A(a,b,c,d){a&&a.result&&a.result.response_msg&&""!=a.result.response_msg?console.warn(a.err_msg):console.warn("상품 데이터 전송 에러"),m.isLoadingProd=!1,z()}function B(a,b,d,e){if(a==c||a.result==c||"00000"!=a.result.response_code||a.prdLst==c)A(a);else{var f=e.params,g=a.prdLst,h=m.PRODUCT_MAP[f.gr_tk_id];if(h!=c&&g.items!=c){for(var i=[].concat(g.items),j=[],k=g.items.length,l=0;k>l;l++)j.push(g.items[l].goodsNo);if(j.length>0)h.goods_no=j,h.talk.goods_no=j;else{var n=h.talk;n.isPrd=!1,n.goods_no=[],n.text="힝... 추천해드린 상품이 모두 품절됐어요...T.T",delete m.PRODUCT_MAP[f.gr_tk_id]}h.data=i.splice(0,m.PROD_GROUP_SIZE),h.goods_data=i}m.isLoadingProd=!1,z()}}function C(){var a=b.element(".tr_talk.tr_prod:not(.pord_load)");if(0!=a.length){var d,f,g,h,i=b.element(e),j=i.height(),k=i.scrollTop();a.each(function(a,e){d=b.element(e),f=Math.abs(d.offset().top-k),2*j>f&&(g=d.data("gr_tk_id"),h=m.PROD_BUFFER[g],h!=c&&(R(h),delete m.PROD_BUFFER[g]))})}}function D(a,b){a.member_no=ja,a.member_nm=ka,m.CHAT_QUE.push({param:a,data:b}),E()}function E(){if(0!=m.CHAT_QUE.length&&!m.isLoadingData){var a=m.CHAT_QUE.shift();switch(m.currentChatQue=a,a.param.command){case"sendTalk":m.userInputText=a.param.text;break;case"selectOption":a.param.option_value_han!=c&&(m.userInputText=a.param.option_value_han)}switch(a.param.command){case"getGroups":case"getTalks":break;default:s()}m.isLoadingData=!0,h.get(sa,{params:a.param}).success(G).error(F)}}function F(a,b,d,e){if(a&&a.err_msg&&""!=a.err_msg)m.alert_2016(a.err_msg);else{var f=!1;m.modalPopList2016!=c&&m.modalPopList2016.length>0&&"채팅 데이터 전송 에러"==m.modalPopList2016[0].message&&(f=!0),f||m.alert_2016("채팅 데이터 전송 에러")}t(),m.userInputText="",m.isLoadingData=!1,E()}function G(a,b,d,e){if(a==c||"0000"!=a.err_cd||a.data==c)F(a,b,d,e);else{var f=e.params,g=a.data;switch(f.command){case"getGroups":I(g);break;case"getTalks":L(g,!0);break;case"startGroup":L(g);break;case"sendTalk":L(g),T(g);break;case"addWish":L(g),m.currentChatQue.data.wishAdded=!0,console.warn(m.currentChatQue.data);break;case"addCart":L(g),Y(g);break;case"selectOption":L(g),T(g)}}t(),m.userInputText="",m.isLoadingData=!1,E()}function H(){var a,b=0,c=m.GROUPS.length;for(i=c-1;i>=0&&(a=m.GROUPS[i],a.errorCount>=3||0!=a.count||(D({command:"getTalks",group_id:a.group_id}),b++,!(b>=ra)));i--);}function I(a){if(a==c||a.group_list==c)return void m.talkRecomDelegate("newRecomTalk",!1);var b=m.getDateTime(a.time),d=m.getDateTime();m.timeDifference=b-d;var e,f,g=m.GROUP_MAP,h=m.GROUPS,i=0,j=a.group_list,k=j.length;if(0==k)return m.GROUP_MAP={},m.GROUPS.length=0,void m.talkRecomDelegate("newRecomTalk",!1);var l=j[0].group_id,n=[];h.forEach(function(a,b){a.group_id<l?delete g[a.group_id]:n.push(a)}),m.GROUPS=n;for(var o=k-1;o>=0;o--)e=j[o],f=J(e),f.date=e.date,i++,ra>=i&&e.count!=f.count&&D({command:"getTalks",group_id:e.group_id});m.GROUPS.sort(Q);try{var p=m.getDateTime(),q=m.getDateTime(h[h.length-1].date),r=p-q;r/1e3/60>60&&m.talkRecomDelegate("newRecomTalk",!1)}catch(s){}}function J(a){var d=a.group_id,e=m.GROUP_MAP,f=m.GROUPS,g=e[d];if(g!=c)return g;for(var h=f.length,i=0;h>i;i++)if(g=f[i],g.group_id==d)return e[d]=g,g;var j=b.copy(a);return j.errorCount=0,j.count=0,j.section_list=[],f.push(j),e[d]=j,j}function K(){if(0!=m.TALK_BUFFER.length){var a,b,d,e,f=m.GROUP_MAP;m.GROUPS;b=m.TALK_BUFFER.shift();var g;if(b!=c&&b.group_id!=c){if(e=b.talk_id,d=b.group_id,a=f[d],a!=c){if(a.last_talk_id==c&&(a.last_talk_id=-1),b.talk_id<=a.last_talk_id)return;a.last_talk_id=b.talk_id}(b.date==c||""==b.date)&&(b.date=m.getDateTimeString()),b.gr_tk_id=d+"_"+e,"C"==b.auth&&(b.auth="A"),g=P(b),g!=c&&(g.list==c&&(g.list=[]),g.list.push(b),d!=c&&N(d),m.scrollToBottom(),ia())}}}function L(a,b){if(a!=c&&a.talk_list!=c)if(b===!0){M(a);for(var d,e=0,g=m.CHAT_QUE.length,h=0;g>h;h++)d=m.CHAT_QUE[h].param,"getTalks"==d.command&&e++;0==e&&f(ha,500),ia()}else{var i=a.talk_list;i.length>0&&(m.TALK_BUFFER=m.TALK_BUFFER.concat(i),K())}}function M(a){if(a!=c&&a.talk_list!=c){for(var b,d,e,f,g,h=m.GROUP_MAP,i=(m.GROUPS,a.talk_list),j=i.length,k=0;j>k;k++)if(d=i[k],d!=c&&d.group_id!=c){if(f=d.talk_id,e=d.group_id,b=h[e],"Y"!=a.local&&b!=c){if(b.last_talk_id==c&&(b.last_talk_id=-1),d.talk_id<=b.last_talk_id)continue;b.last_talk_id=d.talk_id}(d.date==c||""==d.date)&&(d.date=m.getDateTimeString()),d.gr_tk_id=e+"_"+f,"C"==d.auth&&(d.auth="A"),g=P(d),g!=c&&(g.list==c&&(g.list=[]),g.list.push(d))}e!=c&&N(e),m.scrollToBottom()}}function N(a){var d=m.GROUP_MAP[a];if(d!=c){var e,f,g,h,i,j,k,l,n,o,p=0;for(h=d.section_list.length,f=0;h>f;f++)for(e=d.section_list[f],i=e.list.length,p+=i,k={},o=!1,g=0;i>g;g++)j=e.list[g],j.isImg=j.img_url!=c&&j.img_url.length>0,j.isPrd=j.goods_no!=c&&b.isArray(j.goods_no)&&j.goods_no.length>0,l=k.auth!=j.auth,l&&(o=!1),n=!1,o||j.isImg||j.isPrd||(n=!0,o=!0),j.first=n,k.last=l,j.last=g==i-1,k=j,m.PROD_BUFFER[j.gr_tk_id]=j;d.count=p,O()}}function O(){for(var a,b,c=m.GROUPS,d=c.length,e="",f=0;d>f;f++)a=c[f],b=a.date.substr(0,8),a.first=e!=b,e=b}function P(a){var b=m.GROUP_MAP;if(a.date!=c){var d=a.auth+a.date.substr(0,12),e=b[a.group_id];e==c&&(e=J({date:a.date,group_id:a.group_id,count:0}));var f,g=e.section_list,h=g.length;return h>0&&(f=g[h-1],f.key==d)?f:(f={key:d,list:[]},g.push(f),f)}}function Q(a,b){var c=a.group_id,d=b.group_id;return d>c?-1:c>d?1:0}function R(a){if(a.isPrd&&!a.prodChecked){a.prodChecked=!0;var b={goods_no:a.goods_no,goods_data:a.goods_data,talk_id:a.talk_id,group_id:a.group_id,gr_tk_id:a.gr_tk_id,talk:a};m.PRODUCT_MAP[a.gr_tk_id]=b,y(b)}}function S(a){m.TEMP_OPTION=null,"cart"!=a&&(m.currentCartOption=null),"talk"!=a&&(m.currentTalkOption=null)}function T(a){if(a!=c&&a.talk_list!=c){var b,d,e,f,g=a.talk_list,h=g.length;for(f=0;h>f&&(b=g[f],e=b.subCtgLst,d=b.option_list,e==c&&d==c);f++);e!=c&&e.items!=c&&e.items.length>0?U(e,b):d!=c&&d.items!=c&&d.items.length>0?V(d,b):m.callAppAPI("noOption")}}function U(a,b){if(a!=c&&a.items!=c){var d,e,f;for(d=a.items.length,e=0;d>e;e++)f=a.items[e],f.opt_tval=f.ctgName,f.opt_tval_cd=f.ctgNo;var g=null,h=b.option_list;h!=c&&h.items!=c&&h.items.length>0&&(g=[].concat(h.items)),S("talk");var i=b.request_cnt;(i==c||""==i)&&(i=0),m.currentOptionPre={pre_request_url:b.pre_request_url,pre_parameter:b.pre_parameter,request_cnt:i},m.currentTalkOption={options:[{opt_title:"subCtgLst",opt_value:a.items}]},null!=g&&(m.currentTalkOption.skip=g),W()}}function V(a,b){if(a!=c&&a.items!=c){var d,e,f,g=null;for(d=a.items.length,e=0;d>e;e++)if(f=a.items[e],"reatedKeyword"==f.opt_title){f.opt_value!=c&&f.opt_value.length>0?(a.items.splice(e,1),g=[].concat(a.items),a.items=[f]):a.items.splice(e,1);break}S("talk"),m.currentTalkOption={options:a.items},null!=g&&(m.currentTalkOption.skip=g);var h=b.request_cnt;(h==c||""==h)&&(h=0),m.currentOptionPre={pre_request_url:b.pre_request_url,pre_parameter:b.pre_parameter,request_cnt:h},W()}}function W(){var a=m.currentTalkOption;if(a!=c&&a.options!=c&&0!=a.options.length){var b,d,e,f,g={};if(1!=a.options.length||!a.showsub&&"subCtgLst"!=a.options[0].opt_title&&"reatedKeyword"!=a.options[0].opt_title)for(g={opt_title:"옵션선택",opt_value:[]},e=a.options.length,b=0;e>b;b++)f=a.options[b],g.opt_value.push({opt_tval:p(f.opt_title),opt_tval_cd:f.opt_title});else{g=a.options[0];var h="deliver"==g.opt_title;if(g.opt_value!=c)for(e=g.opt_value.length,b=0;e>b;b++)f=g.opt_value[b],h&&(f.opt_tval_cd=f.opt_tval),f.opt_tval=p(f.opt_tval)}if(0!=g.opt_value.length){X(g.opt_value);var i="colors"==g.opt_title,j=g.opt_value;e=j.length;var k=[];for(b=0;e>b;b++)d=j[b],d.opt_tval!=c&&(i?k.push(d.opt_tval+oa+va[d.opt_tval]+oa+1):k.push(d.opt_tval+oa+d.opt_tval_cd+oa+1));
var l={title:g.opt_title,option:k.join(pa)};m.callAppAPI("selectOption",l)}}}function X(a){var b=m.currentTalkOption,d=!1,e=!1;b.skip!=c&&(d=!0),b.previous!=c&&(e=!0);for(var f,g=!0,h=!0,i=!0,j=a.length,k=j-1;k>=0;k--)f=a[k],a[k].opt_tval==la&&(g=!1,d||a.splice(k,1)),a[k].opt_tval==na&&(h=!1,e||a.splice(k,1)),a[k].opt_tval==ma&&(i=!1);d&&g&&a.push({opt_tval:la,opt_tval_cd:la}),e&&i&&a.push({opt_tval:na,opt_tval_cd:na}),i&&a.push({opt_tval:ma,opt_tval_cd:ma})}function Y(a){if(a!=c&&a.talk_list!=c){for(var b,d,e,f=a.talk_list,g=f.length,h=0;g>h&&(b=f[h],d=b.option_list,e=b.complex_option_list,d==c||e==c);h++);if(d==c||d.items==c||e==c||e.items==c)return void m.callAppAPI("noOption");S("cart"),m.currentCartOption={product:m.currentChatQue.data,options:d.items,complex:e.items,choosed:[]},Z()}}function Z(){var a=m.currentCartOption;if(a!=c){var b=a.choosed.join(qa);""!=b&&(b+=qa);var d,e,f=a.choosed.length,g=a.options[f],h=g.opt_value,i=h.length,j=[];for(d=0;i>d;d++)e=h[d],j.push(e.opt_tval+oa+e.opt_tval_cd+oa+ca(b+e.opt_tval_cd));j.push("담기 취소"+oa+"담기 취소"+oa+1);var k={title:g.opt_title,option:j.join(pa)};m.callAppAPI("selectOption",k)}}function _(a,b){null!=m.currentTalkOption?aa(a,b):null!=m.currentCartOption&&ba(a,b)}function aa(a,b){var d,e,f,g=m.currentTalkOption.options;if(b==ma)return void m.talkRecomDelegate("newRecomTalk");if(b==la&&m.currentTalkOption.skip!=c)return m.currentTalkOption={options:m.currentTalkOption.skip,previous:g},x([{auth:"U",text:la}]),da("skip"),void W();var h=m.currentTalkOption.previous;if(b==na&&h!=c){m.currentTalkOption={options:h},x([{auth:"U",text:na}]);try{switch(h[0].opt_title){case"reatedKeyword":case"subCtgLst":return m.currentTalkOption.skip=g,da("goback"),void W()}}catch(i){}return da("goback"),void W()}var j,k;if("subCtgLst"!=a){for(e=g.length,d=0;e>d;d++)if(f=g[d],f.opt_title==b&&f.opt_value.length>0){if(m.currentTalkOption={options:[f],showsub:!0,previous:g},"옵션선택"==a)switch(b){case"price":x([{auth:"U",text:p(b)},{auth:"A",text:ka+"님, 생각해둔 가격대는 있어요?"}]);break;case"colors":x([{auth:"U",text:p(b)},{auth:"A",text:ka+"님, 원하시는 색상을 선택해주세요."}]);break;case"smpDept":x([{auth:"U",text:p(b)},{auth:"A",text:"상품을 픽업할 지점을 선택해주세요."}])}return void W()}var l=b;e=g.length;var n,o;for(d=0;e>d;d++)if(f=g[d],f.opt_title==a&&f.opt_value!=c){for(n=f.opt_value.length,o=0;n>o;o++)if(f.opt_value[o].opt_tval_cd==b){l=f.opt_value[o].opt_tval;break}break}"colors"==a?(b=va[b],l="선택완료"):"옵션선택"==a&&(a=b,b="1",l=p(a));var q={command:"selectOption",option_title:a,option_value:b,option_value_han:l};m.currentOptionPre!=c&&m.currentOptionPre.pre_request_url!=c&&m.currentOptionPre.pre_parameter!=c&&(q.pre_request_url=m.currentOptionPre.pre_request_url,q.pre_parameter=m.currentOptionPre.pre_parameter,q.request_cnt=m.currentOptionPre.request_cnt),D(q),m.TEMP_OPTION=null}else{try{for(f=g[0].opt_value,e=f.length,d=0;e>d;d++)if(k=f[d],k.ctgNo==b){j=k;break}}catch(i){return}if(j!=c){var q={command:"selectOption",option_title:a,mGrpNo:j.mGrpNo,ctgNo:j.ctgNo,dsCtgDepth:j.dsCtgDepth,option_value_han:j.ctgName};m.currentOptionPre!=c&&m.currentOptionPre.pre_request_url!=c&&m.currentOptionPre.pre_parameter!=c&&(q.pre_request_url=m.currentOptionPre.pre_request_url,q.pre_parameter=m.currentOptionPre.pre_parameter,q.request_cnt=m.currentOptionPre.request_cnt),D(q),m.TEMP_OPTION=null,da("cate",b)}}}function ba(a,b){if("담기 취소"==b)return m.addToCart({goodsNo:0,goodsCmpsCd:0},0),void(m.TEMP_OPTION=null);var c=m.currentCartOption;if(c.choosed.push(b),c.choosed.length<c.options.length)Z();else{for(var d,e=c.choosed.join(qa),f=c.complex,g=f.length,h=0;g>h;h++)if(d=f[h],d.opt_val_cd==e){m.addToCart(m.currentCartOption.product,d.item_no);break}m.TEMP_OPTION=null}}function ca(a){for(var b,c=m.currentCartOption,d=c.complex,e=d.length,f=0;e>f;f++)if(b=d[f],0==b.opt_val_cd.indexOf(a)&&b.inv_qty>0)return 1;return 0}function da(a,b,c){var d=m.tClickBase+"Samanda_Clk_";switch(a){case"reason":d+="Lnk_goods_recommend";break;case"inform":d+="Lnk_information";break;case"profile":d+="Lnk_profile";break;case"showmore":d+="Lnk_goods_showmore";break;case"addcart":d+="Lnk_goods_cart";break;case"addwish":d+="Lnk_goods_wish";break;case"newRecomTalk":d+="Lnk_newreco";break;case"reatedKeyword":d+="btn_searchworld";break;case"colors":d+="btn_color";break;case"price":d+="btn_price";break;case"smpDept":d+="btn_deppick";break;case"smpSeven":d+="btn_sevenpick";break;case"quick":d+="btn_quick";break;case"tdar":d+="btn_tdar";break;case"freediv":d+="btn_freeship";break;case"noint":d+="btn_nointerest";break;case"point":d+="btn_point";break;case"freepack":d+="btn_freegiftwrap";break;case"goback":d+="btn_gotoback";break;case"skip":d+="btn_skip";break;case"cate":d+="btn_cate_"+b;break;case"selectOption":return void da("reatedKeyword"==b?b:c);default:return}m.sendTclick(d)}function ea(a,b,c){m.appObj.isApp&&m.appObj.isIOS&&"P"!=a&&m.callAppAPI("exitpage"),f(function(){switch(a){case"S":m.gotoService(b,c);break;case"P":m.productView(b,"","",c)}},100)}function fa(){b.element(e).bind("touchstart",ga),b.element(e).bind("scroll",ha)}function ga(a){m.isAutoScrollEnabled=!1}function ha(a){if(!m.isLoadingData){C();var c=b.element(e),d=b.element("body")[0],f=c.height(),g=(d.scrollHeight,c.scrollTop()),h=4;f*h>g&&H()}}function ia(){if(0!=m.GROUPS.length&&!m.DO_NOT_SAVE_LOCAL){for(var a=m.GROUPS.length,c=0;a>c;c++)m.GROUPS[c].errorCount=0;var d={memberno:ja,scrollTop:b.element(e).scrollTop(),groups:m.GROUPS};j.setLocalStorage("TALK_RECOM_LCST",d,"json")}}m.DO_NOT_SAVE_LOCAL=!1,m.clearTempOption=function(){m.TEMP_OPTION=null},m.clearLocalStorage=function(){j.delLocalStorage("TALK_RECOM_LCST"),m.DO_NOT_SAVE_LOCAL=!0,location.href=d.talkRecomUrl+"?"+m.baseParam+"&dev_mode=Y&a="+Math.round(100*Math.random())},m.userInputMsg=function(){var b=a.prompt();b!=c&&""!=b&&m.talkRecomDelegate("sendTalk",b,"T")},a.changeServer=function(a){sa=a==c||""==a?d.talkRecomChatbot:a,console.log("server changed to: "+sa)};var ja="",ka="",la="건너뛰기",ma="새 추천 시작하기",na="이전으로 돌아가기",oa="|",pa=";",qa=" x ",ra=3,sa=d.talkRecomChatbot,ta=d.talkRecomProdlist,ua=d.talkRecomAppMenu,va={"010":"ddbd97","020":"ff6600","030":"ff0000","040":"ffff00","050":"90ee90","060":"009933","070":"87cdfa","080":"191970","090":"0000ff",100:"706c3d",110:"783c24",120:"9932cc",130:"ff80ff",140:"ff88ae",150:"ffffff",160:"d3d3d3",170:"666666",180:"000000",ddbd97:"010",ff6600:"020",ff0000:"030",ffff00:"040","90ee90":"050","009933":"060","87cdfa":"070",191970:"080","0000ff":"090","706c3d":"100","783c24":"110","9932cc":"120",ff80ff:"130",ff88ae:"140",ffffff:"150",d3d3d3:"160",666666:"170","000000":"180"};if(va[la]=la,va[na]=na,va[ma]=ma,m.addToWishList=function(a){m.isAutoScrollEnabled=!0,D({command:"addWish",goods_no:a.goodsNo},a),da("addwish")},m.addToCart=function(a,b){m.isAutoScrollEnabled=!0,D({command:"addCart",goods_no:a.goodsNo,goods_cmps_cd:a.goodsCmpsCd,item_no:b},a),da("addcart")},m.gotoDetailView=function(a,b){a.curDispNoSctCd=96;var c=m.tClickBase+"Samanda_Clk_Lnk_goods"+("t"==b?"":"_detail");ea("P",a,c)},m.showTrPopup=function(a,b){m.callAppAPI("hideInput"),f(function(){r(a,b)},250)},m.hideTrPopup=function(a){switch(a){case"reason":m.recomReason=null,m.isReasonVisible=!1;break;case"inform":m.isInformVisible=!1;break;case"profile":m.isProfileVisible=!1}m.callAppAPI("showInput")},m.setPopupPosition=function(a){f(function(){var c,d,f=e.outerHeight?e.outerHeight:e.innerHeight,g=b.element(".tr_popup"+a);".tr_popup_reason"==a&&g.find(".tr_pop_body .mdtip .cont").css("max-height",f-450),c=g.find(".tr_pop_wrap"),d=Math.round((f-c.height())/2),c.css("top",d),g.css("opacity",1)},1)},m.setWaitingResponse=function(a){f(function(){m.isWaitingResponse=a,a&&m.scrollToBottom(!0)},0)},m.scrollToBottom=function(a){(m.isAutoScrollEnabled||a===!0)&&f(v,10)},m.showMoreProduct=function(a,b){a!=c&&a.goods_no!=c&&0!=a.goods_no.length&&(w(a),a.goods_no.length=m.PROD_GROUP_SIZE,a.goods_data.length=0,a.talk.goods_no.length=m.PROD_GROUP_SIZE,f(function(){b.reset(),b.lotteSliderMoveXPos(-1500)},0),da("showmore"))},m.talkRecomDelegate=function(){if(0!=arguments.length){var a=[].slice.call(arguments),b=a.shift(),c={command:b};switch(b){case"newRecomTalk":case"newRecomStyle":case"sendTalk":case"selectOption":case"addCart":case"addWish":m.isAutoScrollEnabled=!0}switch(b){case"newRecomTalk":a[0]!==!1?m.callAppAPI("resetInput"):c.timeout="Y",c.command="startGroup",c.type="T",D(c);break;case"newRecomStyle":c.command="startGroup",c.type="S",D(c);break;case"sendTalk":c.text=a[0],c.type="S"==a[1]?"S":"T",D(c);break;case"selectOption":_(a[0],a[1]);break;case"showCart":ea("S","cartLstUrl",{tclick:m.tClickBase+"Samanda_Clk_Lnk_profile_showcart"});break;case"showWish":ea("S","wishLstUrl",{tclick:m.tClickBase+"Samanda_Clk_Lnk_profile_showwish"});break;case"scrollBy":try{$("html, body").stop(!0),$("html, body").animate({scrollTop:$("body").scrollTop()+a[0]},400)}catch(d){}}switch(b){case"selectOption":case"scrollBy":break;default:S()}da(b,a[0],a[1])}},a.talkRecomDelegate=m.talkRecomDelegate,m.callAppAPI=function(a,b){var c,d="talkrecom://"+a,f="?";for(c in b)d+=f+c+"="+b[c],f="&";switch(a){case"selectOption":for(var g=b.option.split(pa),h=g.length,i=0;h>i;i++)g[i]=g[i].split(oa);m.TEMP_OPTION={title:b.title,option:g}}m.appObj.isApp&&(e.location.href=d)},m.appObj.isApp){var wa="말로 쉽고 빠르게<br/>상품추천부터 결제까지!<br/>지금 바로 말로 하는 쇼핑을<br/>경험해 보세요!<br/><br/>지금 업데이트 하시겠어요?";if(m.appObj.isAndroid){var xa=navigator.userAgent,ya=xa.indexOf("Android"),za=Number(xa.substr(ya+8,3));if(4.5>za){wa="죄송합니다. 말로 하는 쇼핑은 안드로이드 OS 4.4 이하 버전에서는 이용이 불가합니다.",alert(wa);try{appSendBack()}catch(Aa){var Ba=d.mainUrl+"?"+l.getBaseParam();e.location.href=Ba}return!1}}var Ca={label:{ok:"승인",cancel:"취소"},callback:function(a){if(a)m.appObj.isIOS?location.href="http://itunes.apple.com/app/id376622474?mt=8":location.href="market://details?id=com.lotte";else try{appSendBack()}catch(b){var c=d.mainUrl+"?"+l.getBaseParam();e.location.href=c}}};m.confirm_2016(wa,Ca)}else k.promiseLoginInfo()["finally"](function(a){f(q,500)})}}}]),d.directive("talkRecomImageLoad",["$timeout",function(a){return{restrict:"A",link:function(a,c,d){function e(c){var d=b.element(c.currentTarget),e=d.height();e>320&&d.addClass("vertical"),a.scrollToBottom()}c.bind("load",e)}}}]),d.directive("talkRecomDateFormat",function(){return{restrict:"A",link:function(a,b,c){a.getTalkDate=function(b){var c=a.getDateTime(b),d=c.getDate();return c.getMonth()+1+"."+(10>d?"0":"")+d+" ("+a.WEEK[c.getDay()]+")"},a.getTalkTime=function(b){var c=a.getDateTime(b),d=c.getHours(),e=c.getMinutes();return(12>d?"오전 ":"오후 ")+d%12+":"+(10>e?"0":"")+e}}}})}(window,window.angular);