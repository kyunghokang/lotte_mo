!function(a,b,c){"use strict";var d=b.module("product-sub-header",[]);d.directive("productSubHeader",["$http","$timeout","$window","$location","LotteCommon","LotteCookie","LotteStorage","LotteUtil",function(a,b,c,d,e,f,g,h){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_sub_header.html",replace:!0,link:function(a,b,c){a.gotoPrepage=function(){a.jsonLoading=!0,a.sendTclick("m_RDC_header_new_pre"),a.appObj.isNativeHeader?appSendBack():history.go(-1)}}}}]),"undefined"!=typeof module&&module.exports&&(module.exports=d.name)}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","product-sub-header","lotteSns"]);d.controller("ProductCommentCtrl",["$http","$window","$scope","$timeout","LotteCommon","orderByFilter","commInitData","LotteUtil",function(a,c,d,e,f,g,h,i){d.showWrap=!0,d.contVisible=!0,d.productSubTitle="전체 상품평보기",d.screenID="product_comment",d.goodsNo=h.query.goods_no,d.jsonLoading=!1,d.alert=function(a){c.alert(a)},d.consolelog=function(a){console.log(a)},console.log("++++++",d.showSharePop),d.pageUI={page:1,isLastPage:!1,starScoreOpen:!0,customerSatisOpen:!0,filterOption:{sliderOpen:!1,filter1Open:!1,filter1SelVal:0,filter1Names:["최근상품평순","사진상품평순","높은평점순","낮은평점순","추천순"],filter2Open:!0,filter2SelVal:6,filter2Names:["별점전체","5점","4점","3점","2점","1점"]},reqParam:{},loadData:null,filteredItems:[]},d.pageUI.reqParam.goods_no=h.query.goods_no?h.query.goods_no:"",d.pageUI.reqParam.usm_goods_no=h.query.usm_goods_no?h.query.usm_goods_no:"",d.pageUI.reqParam.page=h.query.page?h.query.page:1,d.pageUI.reqParam.all_view_yn="Y",d.pageUI.reqParam.sort="L",d.pageUI.reqParam.star="",d.loadData=function(){d.pageUI.reqParam.page=d.pageUI.page;var b=f.isTestFlag?f.productSubCommentAllData:f.productSubCommentAllData;d.ajaxLoadFlag=!0,d.jsonLoading=!0,a.get(b,{params:d.pageUI.reqParam}).success(function(a){if(a.data)if(console.log("전체 상품평보기 데이터 로드 page:"+d.pageUI.reqParam.page),d.pageUI.reqParam.page>1)if(a.data.critList.total_count>0)for(var b=0;b<a.data.critList.items.length;b++)d.pageUI.loadData.critList.items.push(a.data.critList.items[b]);else d.pageUI.isLastPage=!0;else d.pageUI.loadData=a.data}).error(function(){console.log("Data Error : 전체 상품평보기 데이터 로드 실패"),d.ajaxLoadFlag=!1})["finally"](function(){d.ajaxLoadFlag=!1,d.jsonLoading=!1})},d.loadData(),d.linkClick=function(a,b){console.log("linkUrl",a),c.location.href=i.setUrlAddBaseParam(a,d.baseParam+"&tclick="+b)},d.sortBy=function(a){switch(d.sendTclick(a),d.pageUI.filterOption.filter1SelVal){case 0:d.pageUI.reqParam.sort="L";break;case 1:d.pageUI.reqParam.sort="P";break;case 2:d.pageUI.reqParam.sort="G";break;case 3:d.pageUI.reqParam.sort="B";break;case 4:d.pageUI.reqParam.sort="R"}d.pageUI.page=1,d.pageUI.isLastPage=!1,d.loadData()},d.sortByOpen=function(a){d.sendTclick(a),d.pageUI.filterOption.filter1Open=!d.pageUI.filterOption.filter1Open},d.filterBy=function(a){d.sendTclick(a),d.pageUI.reqParam.star=d.pageUI.filterOption.filter2SelVal,d.pageUI.reqParam.star>5&&(d.pageUI.reqParam.star=""),d.pageUI.page=1,d.pageUI.isLastPage=!1,d.loadData()},d.filterByOpen=function(a){d.sendTclick(a),d.pageUI.filterOption.filter2Open=!d.pageUI.filterOption.filter2Open},d.showHideFilterSlider=function(a){d.sendTclick(a),d.pageUI.filterOption.sliderOpen=!d.pageUI.filterOption.sliderOpen,d.pageUI.filterOption.sliderOpen?d.dimmedOpen({callback:this.showHideFilterSlider}):d.dimmedClose()},d.hideFilterSlider=function(a){d.sendTclick(a),d.dimmedClose()};var j=b.element("body")[0];d.$on("winScroll",function(a,b){d.pageUI.isLastPage!==!0&&!d.ajaxLoadFlag&&j.scrollHeight-2*b.winHeight<=b.scrollPos+b.winHeight&&(console.log("more scroll;;;;;"),d.pageUI.page++,d.loadData())}),d.recommClick=function(b){if(d.loginInfo.isLogin)b.regRecommUrl&&(b.myRecomm=!0,a.get(f.isTestFlag?f.regRecomUrl:b.regRecommUrl).success(function(a){if(a.data){if(alert(a.data.resultMsg),a.data.resultCode)switch(a.data.resultCode){case"01":case"02":b.recommCnt=b.recommCnt+1;case"03":b.recommYn=!0;case"04":break;case"05":}}else alert("다시 한번 시도해주시기 바랍니다.")}));else{alert("로그인을 해주세요.");var e="&targetUrl="+encodeURIComponent(c.location.href,"UTF-8");c.location.href=f.loginUrl+"?"+d.baseParam+e}}}]),d.directive("lotteContainer",["$window","LotteCommon","commInitData",function(a,b,c){return{templateUrl:"/lotte/resources_dev/product/m/sub/product_comment_container.html",replace:!0,link:function(d,e,f){d.isShowBtnTalk=!1,d.productCommentDetailView=function(e){console.log("상품평 사진 클릭"),a.location.href=b.productSubCommentDetail+"?"+d.baseParam+"&goods_no="+c.query.goods_no+"&idx="+e+"&tclick="}}}}]),d.directive("integer",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return parseInt(a,10)})}}}),d.filter("starScorePolicy",function(){return function(a,b){if(!a)return 0;var d=5,e=Math.ceil(2*a)/2;return b!=c&&(e=e/d*b),e}})}(window,window.angular);