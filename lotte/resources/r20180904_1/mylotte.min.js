!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter"]);d.controller("MyLotteMainCtrl",["$scope","$http","$window","$timeout","commInitData","LotteCommon","LotteCookie","LotteUtil","LotteGA","LotteStorage",function(b,d,e,f,g,h,i,j,k,l){b.showWrap=!0,b.contVisible=!0,b.subTitle="마이롯데",b.isShowThisSns=!1,b.memberLoginPopup=!1,b.welcomeFlag=!1,b.isShowLoadingImage=!0,b.gaCtgName="MO_마이롯데",b.grockle_yn=!1;var m=null!=g.query.grockle_yn?g.query.grockle_yn:"N";if(b.grockle_yn="Y"==m?!0:!1,b.schema="",b.schema=null!=g.query.schema?g.query.schema:"",b.dummyProfileUrl="http://image.lotte.com/lotte/mo2018/reviews/default_profile.png",b.todayDate=new Date,g.query.testDate){var n=g.query.testDate,o=new Date(n.substring(0,4),parseInt(n.substring(4,6))-1,n.substring(6,8),n.substring(8,10),n.substring(10,12),n.substring(12,14));b.todayDate=o}b.newVer=!1,b.todayDate.getTime()>=new Date(2017,11,1).getTime()&&(b.newVer=!0),this.getCookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""},b.reviewPopHide=i.getCookie("reviewNotice")||"N","Y"!=b.reviewPopHide&&(b.reviewPopFlag=!0);var p="";typeof SEED_DATA!=c&&(p=SEED_DATA);var q=this.getCookie("SIMPLESIGNYN"),r=j.getLoginSeed().toUpperCase(),s=encodeURIComponent((""==b.schema?h.baseUrl:b.schema+h.baseUrl.replace("http",""))+"/"+(j.isSmp()?"main_smp.do":"main.do")+b.baseParam,"UTF-8"),t="";t=""==b.schema?encodeURIComponent(a.location.href,"UTF-8"):a.location.href.replace(/^http(s)?/,b.schema);var u=h.changeMyInfoUrl+"?sid="+r+"&returnurl="+t+"&main_url="+s+"&custid="+p+"&loginid="+i.getCookie("LOGINID")+"&pageflag=I&opentype=P&sch="+b.schema,v=h.memberOutUrl+"?sid="+r+"&returnurl="+t+"&main_url="+s+"&custid="+p+"&loginid="+i.getCookie("LOGINID")+"&opentype=P&sch="+b.schema,w=navigator.userAgent,x=h.mylotteMainData+"?smartAlarmViewTime="+l.getLocalStorage("smart_alarm_view_time")+"&viewGoods="+l.getLocalStorage("latelyGoods");d.get(x+"&"+b.baseParam).success(function(a){1e3==a.resultCode?(b.contents={},b.subTitle="마이롯데",b.noData=!0,b.contVisible=!1):(b.myLotteMainInfo=a.mylotte,b.myGradeType=a.mylotte.mbrGradeCd,"80"==a.mylotte.mbrGradeCd&&"Y"!=a.mylotte.couponInfo.mbr_down_yn&&(b.welcomeFlag=!0),b.alarmFlag=!1,"Y"==b.myLotteMainInfo.newAlarmYn&&(b.alarmFlag=!0),u=h.changeMyInfoUrl+"?sid="+r+"&returnurl="+t+"&main_url="+s+"&custid="+b.myLotteMainInfo.seedCustId+"&loginid="+i.getCookie("LOGINID")+"&pageflag=I&opentype=P&sch="+b.schema,v=h.memberOutUrl+"?sid="+r+"&returnurl="+t+"&main_url="+s+"&custid="+b.myLotteMainInfo.seedCustId+"&loginid="+i.getCookie("LOGINID")+"&opentype=P&sch="+b.schema),b.isShowLoadingImage=!1}).error(function(a,c,d,e){console.log("Error Data : ",c,d,e),b.isShowLoadingImage=!1}),b.myLotteMainLinkObj={ordLstUrl:h.ordLstUrl+"?"+b.baseParam+"&searchFlag=D15&ordDtlStatCd=10&tclick=m_DC_MyPage_Clk_Btn_9",ordLstM1Url:h.ordLstUrl+"?"+b.baseParam+"&searchFlag=M1&ordDtlStatCd=10&tclick=m_DC_MyPage_Clk_Btn_9",ordCancelUrl:h.ordCancelUrl+"?"+b.baseParam+"&fromPg=3&ordListCase=3&tclick=m_DC_MyPage_Clk_Btn_10",ecouponListUrl:h.baseUrl+"/smartpick/smp_cpn_rfd_list.do?c=mlotte&udid=&v=&cn=&cdn=&tclick=m_DC_MyPage_Clk_Btn_11",attendEventUrl:h.baseUrl+"/event/m/directAttend.do?"+b.baseParam+"&tclick=m_dc_MyPage_Clk_Btn_attendcheck",critViewUrl:h.critViewUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_12",eventGumeUrl:h.eventGumeUrl+"?"+b.baseParam+"&search_div=event_list&tclick=m_DC_MyPage_Clk_Btn_13",mylotteReinquiryListUrl:h.mylotteReinquiryListUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_14",lPayEasyUrl:h.lPayEasyUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_14",orderAlarmYnUrl:h.orderAlarmYnUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_17",smartpayUrl:h.smartpayUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_15",questionUrl:h.questionUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_16",cscenterAnswerUrl:h.cscenterAnswerUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_19",friendCouponUrl:h.baseUrl+"/event/couponBook.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_1",gdBenefitUrl:h.gdBenefitUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_29",talkUrl:h.talkUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_28",smartAlarmUrl:h.smartAlarmUrl+"?"+b.baseParam+"&curDispNoSctCd=22&tclick=m_DC_MyPage_Clk_Btn_23",wishLstUrl:h.wishLstUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_25",cscenterMain:"/custcenter/cscenter_main.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_18",QandA:"/mylotte/product/m/mylotte_reinquiry_list.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_16",ordLst2Url:h.ordLstUrl+"?"+b.baseParam+"&fromPg=3&tclick=m_DC_MyPage_Clk_Btn_10",presentList:h.presentListUrl+"?"+b.baseParam},b.myLotteLateProd=function(){setTimeout(function(){e.location.href=h.lateProdUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_26&viewGoods="+l.getLocalStorage("latelyGoods")})},b.myLotteOftenProd=function(){setTimeout(function(){e.location.href=h.oftenProdUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_29&viewGoods="+l.getLocalStorage("latelyGoods")})},b.lPointClick=function(){e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=lt_point&tclick=m_DC_MyPage_Clk_Btn_3"},b.lMoneyClick=function(){e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=l_point&tclick=m_DC_MyPage_Clk_Btn_4"},b.depositClick=function(){e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=deposit&tclick=m_DC_MyPage_Clk_Btn_5"},b.couponClick=function(){e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=coupon&tclick=m_DC_MyPage_Clk_Btn_6"},b.cloverClick=function(){e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=clover&tclick=m_DC_MyPage_Clk_Btn_7"},b.smartPickClick=function(){e.location.href=h.smartPickListUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_8"},b.ordDetailClick=function(a){var c=a.toString().substr(1,1);e.location.href=h.ordLstUrl+"?"+b.baseParam+"&searchFlag=D15&ordDtlStatCd=10&orderListType="+a+"&tclick=m_DC_MyPage_Clk_Lnk_"+c},b.welcomeClose=function(){b.welcomeFlag=!1},b.goPointCoupon=function(){var a=$location.protocol()+"://"+$location.host();e.location.href=a+"/mylotte/pointcoupon/point_info.do?"+b.baseParam+"&point_div=coupon"},b.memeberChagne=function(){if(b.loginInfo.isLogin)if(0==b.myLotteMainInfo.valid_login)console.log("2015년4월20일 이전 로그인 유저"),b.memberLoginPopup=!0,b.dimmedOpen({target:"memberPopup",callback:b.closePopup});else{if("Y"==q)return alert("간편회원의 정보변경/탈퇴는 PC에서만 가능합니다."),!1;b.sendTclick("m_DC_MyPage_Clk_Btn_20"),outLink(u)}else alert("로그인 후 이용 가능합니다.")},b.memberOut=function(){if(b.loginInfo.isLogin)if(0==b.myLotteMainInfo.valid_login)console.log("2015년4월20일 이전 로그인 유저"),b.memberLoginPopup=!0,b.dimmedOpen({target:"memberPopup",callback:b.closePopup});else{if("Y"==q)return alert("간편회원의 정보변경/탈퇴는 PC에서만 가능합니다."),!1;b.sendTclick("m_DC_MyPage_Clk_Btn_21"),outLink(v)}else alert("로그인 후 이용 가능합니다.")},b.goLoginClick=function(){var a="&tclick=m_DC_MyPage_Clk_Btn_27&targetUrl="+encodeURIComponent(h.mylotteUrl+"?"+b.baseParam,"UTF-8");e.location.href=h.loginUrl+"?"+b.baseParam+a},b.goFamilySite=function(c){if(b.appObj.isIOS&&b.appObj.isApp){b.sendTclick("m_DC_Mypage_Clk_Btn_28");$.ajax({type:"post",async:!1,url:h.getJoinBtnViewAjaxUrl,success:function(d){if(d=d.result.trim(),"Y"==d)alert("[아이디/비밀번호 찾기, 회원가입] 서비스는 일시적으로 롯데닷컴/엘롯데 PC를 통해 이용가능합니다. 이용에 불편을 드려 죄송합니다.");else{var e="member.lpoint.com/door/user/mobile/",f=encodeURIComponent((""==b.schema?h.baseUrl:b.schema+h.baseUrl.replace("http",""))+"/"+(j.isSmp()?"main_smp.do":"main.do")+b.baseParam,"UTF-8"),g="",i=a.location.href;i=""==b.schema?encodeURIComponent(a.location.href,"UTF-8"):encodeURIComponent(i.replace(b.web_scheme,b.schema),"UTF-8"),"id"==c?g="requestId.jsp":"passwd"==c?g="requestPasswd.jsp":"mem_reg"==c&&(g="login_common.jsp"),e+=g+"?sid="+j.getLoginSeed()+"&returnurl="+i+"&main_url="+f,e+="&sch="+b.schema,b.sendOutLink("https://"+e,"family")}},error:function(a){alert(a.message)}})}else b.goFamilySite2(c)},b.goFamilySite2=function(c){if("id"==c?b.sendTclick("m_DC_login_clk_Lnk_1"):"passwd"==c?b.sendTclick("m_DC_login_clk_Lnk_2"):"mem_reg"==c&&b.sendTclick("m_DC_Mypage_Clk_Btn_28"),"N"==b.joinBtnViewYn){var d=/iphone|ipad/gi.test(navigator.appVersion);if(("id"==c||"passwd"==c||"mem_reg"==c)&&d)return void alert("[아이디/비밀번호 찾기, 회원가입] 서비스는 일시적으로 롯데닷컴/엘롯데 PC를 통해 이용가능합니다. 이용에 불편을 드려 죄송합니다.")}var e="member.lpoint.com/door/user/mobile/",f=encodeURIComponent((""==b.schema?h.baseUrl:b.schema+h.baseUrl.replace("http",""))+"/"+(j.isSmp()?"main_smp.do":"main.do")+b.baseParam,"UTF-8"),g="",i=a.location.href;i=""==b.schema?encodeURIComponent(a.location.href,"UTF-8"):encodeURIComponent(i.replace(b.web_scheme,b.schema),"UTF-8"),"id"==c?g="requestId.jsp":"passwd"==c?g="requestPasswd.jsp":"mem_reg"==c&&(g="login_common.jsp"),e+=g+"?sid="+j.getLoginSeed()+"&returnurl="+i+"&main_url="+f,e+="&sch="+b.schema,""!=b.schema?j.boolAppInstall(w)?a.location="family://"+e:j.boolAndroid(w)&&a.myJs.callAndroid("https://"+e):a.open("https://"+e,"family")},b.closePopup=function(){b.memberLoginPopup=!1,b.dimmedClose()},b.lsOftenBuyClick=function(){var a=b.appObj.isSuperApp?"M389197":"M389184";b.appObj.isApp||(a="M389469"),b.gotoLotteSuperUrl(h.SuperQuickBuyUrl,a)},b.lsOrderClick=function(){var a=b.appObj.isSuperApp?"M389199":"M389186";b.appObj.isApp||(a="M389470"),b.gotoLotteSuperUrl(h.SuperOrderListUrl,a)},b.lsWishlistClick=function(){var a=b.appObj.isSuperApp?"M389202":"M389187";b.appObj.isApp||(a="M389471"),b.gotoLotteSuperUrl(h.SuperWishListUrl,a)},b.lsMainClick=function(){var a=b.appObj.isSuperApp?"M389204":"M389188";b.appObj.isApp||(a="M389472"),b.gotoLotteSuperUrl(h.SuperMainUrl,a)},b.goProfile=function(){k.evtTag(b.gaCtgName,"회원 프로필수정영역"),f(function(){location.href=b.myLotteMainInfo.prfSetUrl+"?"+b.baseParam},300)},b.goMyReview=function(){k.evtTag(b.gaCtgName,"내 상품평"),f(function(){location.href=b.myLotteMainLinkObj.critViewUrl+"?"+b.baseParam},300)}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/mylotte/m/mylotte_main_container_2018.html",replace:!0,link:function(a,b,c){}}}),d.filter("textOrNumber",["$filter",function(a){return function(b,c){return isNaN(b)?b:a("number")(b,c)}}]),d.directive("memberPopup",["$window","$location",function(a,b){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_mem.html",replace:!0,link:function(a,b,c){}}}]),d.directive("welcomePopup",["$window","$location",function(a,b){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_welcomePop.html",replace:!0,link:function(a,b,c){}}}]),d.directive("reviewPopup",["$window","$location","$timeout","LotteCookie","LotteGA",function(a,b,c,d,e){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_review.html",replace:!0,link:function(a,b,f){function g(a){return 10>a?"0"+a:a}a.saveReviewPop=function(){e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","7일간 다시보지않기 체크"),"Y"==a.reviewPopHide?d.setCookie("reviewNotice",a.reviewPopHide,7):d.delCookie("reviewNotice")},a.goRegComment=function(b,d){e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","상품평_"+g(d),b.goodsNo),c(function(){location.href=b.regCommentUrl+"&"+a.baseParam},300)},a.closeReviewPop=function(){a.reviewPopFlag=!1,e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","닫기 버튼")}}}}]),d.directive("onErrorSrc",function(){return{link:function(a,b,c){b.bind("error",function(){a.myLotteMainInfo.prfImgUrl!=a.dummyProfileUrl&&(a.myLotteMainInfo.prfImgUrl=a.dummyProfileUrl)})}}})}(window,window.angular);