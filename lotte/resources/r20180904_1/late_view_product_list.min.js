!function(a,b,c){"use strict";var d=b.module("lotteSaleBestList",["lotteComm"]);d.service("SaleBestListSvc",["$http","LotteCommon",function(a,b){this.func_SaleBestData=function(c,d,e){var f=[];f.goods_no=c,f.disp_no=d,f.iids=c;var g=b.rec_good+"&size=15&iids="+c;$.ajax({type:"post",async:!0,url:g,dataType:"jsonp",jsonp:"callback",success:function(c){try{var f=function(a){for(var b=new String,c=0;c<a.items.length;c++)c>0&&(b+=","),b+="'"+a.items[c]+"'";return b},g=new Array;$(c.results).each(function(a,b){g.push(b.itemId)});var h=new Array;h=f({items:g});var i=[];i.goodsRelList=h,i.disp_no=d,a.get(b.productProductSalebestData,{params:i}).success(function(a){console.log("Data Success : saleBestData로드 성공"),e(a)}).error(function(){console.log("Data Error : saleBestData로드 실패"),e(null)})}catch(j){console.log("Process Error : saleBestData로드 실패"),e(null)}},error:function(a,b,c){console.log("handle Error : saleBestData2로드 실패"),e(null)}})}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteNgSwipe","lotteSaleBestList"]);d.controller("LatelyProductCtrl",["$scope","$http","$window","$filter","$timeout","LotteStorage","LotteCommon","LotteUtil","SaleBestListSvc",function(c,d,e,f,g,h,i,j,k){c.otherViewFlag=[],c.showWrap=!0,c.contVisible=!0,c.subTitle="최근 본 상품",c.otherViewFlag[c.itemListData]=!1,c.isLatelyLoading=!0,c.screenID="RctView",c.othersLoadingFlag=!1,""==h.getLocalStorage()?c.goodsItems="":c.goodsItems=h.getLocalStorage("latelyGoods"),c.otersItemData=[];var l=i.lateProdData+"?goods_no="+c.goodsItems;d.get(l).success(function(a){null!=a.max.prod_late_view_list&&"0"!=a.max.prod_late_view_list.total_count?c.itemListData=a.max.prod_late_view_list.items:(c.itemListData=[],c.noDataFlag=!0),null!=a.max.prod_late_view_list?c.totalCount=a.max.prod_late_view_list.total_count:c.totalCount=0,c.otersItemData=[c.totalCount],c.isLatelyLoading=!1}).error(function(a,b,d,e){c.isLatelyLoading=!1,console.log("Error Data : ",b,d,e)}),c.otherView=function(a,d,e){c.sendTclick(c.tClickBase+c.screenID+"_Clk_Rel"),k.func_SaleBestData(d,e,function(e){if(null==e)alert("남들은 뭘 봤지? 추천상품이 없습니다."),c.otherViewFlag[d]=!1;else if(null!=e.max.relation&&e.max.relation.total_count>0){for(var f=[],g=0;g<e.max.relation.total_count;g++){var h=e.max.relation.items[g];h.img_url0=h.img_url0.replace("280.","220."),f.push(h)}c.otersItemData[a]=f,1==c.otherViewFlag[d]?b.forEach(c.itemListData,function(a,b){c.otherViewFlag[c.itemListData[b].goods_no]=!1}):(b.forEach(c.itemListData,function(a,b){c.otherViewFlag[c.itemListData[b].goods_no]=!1}),c.otherViewFlag[d]=!0,c.thisItemNo=d)}else alert("남들은 뭘 봤지? 추천상품이 없습니다."),c.otherViewFlag[d]=!1})},c.otherViewClose=function(a){c.otherViewFlag[a]=!c.otherViewFlag[a]},c.goGoodsDetail=function(a,b,d){var f=b+1;"late"==d?e.location.href=i.baseUrl+"/product/m/product_view.do?goods_no="+a+"&curDispNo=5548115&curDispNoSctCd=79&"+c.baseParam+"&tclick="+c.tClickBase+c.screenID+"_Clk_Prd_idx"+f:"other"==d&&(e.location.href=i.baseUrl+"/product/m/product_view.do?goods_no="+a+"&curDispNo=5548115&curDispNoSctCd=79&"+c.baseParam+"&tclick="+c.tClickBase+c.screenID+"_Swp_Rel_prd&_reco=M_detail_recent")},c.myLotteLateProd=function(){setTimeout(function(){e.location.href=i.wishLstUrl+"?"+c.baseParam+"&tclick=m_DC_RctView_Clk_Ban_1&viewGoods="+h.getLocalStorage("latelyGoods")})},c.myLotteOftenProd=function(){setTimeout(function(){e.location.href=i.oftenProdUrl+"?"+c.baseParam+"&tclick=m_DC_RctView_Clk_Ban_2&viewGoods="+h.getLocalStorage("latelyGoods")})},c.deleteItems=function(){if(c.sendTclick(c.tClickBase+c.screenID+"_Clk_Btn_1"),!confirm("삭제 하시겠습니까?"))return!1;if(h.delLocalStorage("latelyGoods"),c.appObj.isApp)if(c.appObj.isAndroid)try{a.lottebridge.resetRecentlyGoods()}catch(b){}else c.appObj.isIOS&&(e.location.href="lottebridge://resetRecentlyGoods");g(function(){e.location.href=i.lateProdUrl+"?"+c.baseParam},300)}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/product/m/lately_product_container_2018.html",replace:!0,link:function(a,b,c){}}})}(window,window.angular);var transformJsonToParam=function(a){var b=[];for(var c in a)if(Array.isArray(a[c]))for(var d=0;d<a[c].length;d++)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]));else b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};