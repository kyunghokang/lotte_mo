!function(a,b,c){"use strict";var d=b.module("lotteUtil");d.service("StyleRecom",["$window","$http","LotteCommon","commInitData",function(a,b,d,e){function f(a){if(a==c)return[];if(a.status===!1)return console.warn(a.message),l(),[];if(a.list==c)return[];var b,d,e,f,h,i=a.list,j=[],k=[];for(d=i.length,b=0;d>b;b++){switch(e=i[b],f=e.category,e.ctgObj=f,e.category=f.code,h=0!=e.sub_category.code?t[e.sub_category.code]:t[e.category],h?(e.ctgName=h.name,e.genOnly=h.gender):(e.ctgName="",e.genOnly=""),e.gender.code){case 1073741824:e.genCd="M";break;case 536870912:e.genCd="F";break;case 1610612736:e.genCd="A";break;default:e.genCd=""}switch(e.score=Math.round(100*e.score),e.rx1=Math.round(1e4*e.rx1)/100,e.rx2=Math.round(1e4*e.rx2)/100,e.ry1=Math.round(1e4*e.ry1)/100,e.ry2=Math.round(1e4*e.ry2)/100,f.code){case 2:case 4:case 1024:e.cx=Math.round(e.rx1+.3*(e.rx2-e.rx1)),e.cy=Math.round(e.ry1+.3*(e.ry2-e.ry1));break;default:e.cx=Math.round(e.rx1+.5*(e.rx2-e.rx1)),e.cy=Math.round(e.ry1+.5*(e.ry2-e.ry1))}e.category==a.sortCate?j.push(e):k.push(e)}return j=j.sort(g),k=k.sort(g),j=j.concat(k)}function g(a,b){var c=a.score,d=b.score;return c>d?-1:d>c?1:0}function h(a){var b=[],c=0;for(c;c<a.length;c++)-1===b.indexOf(a[c])&&b.push(a[c]);return b}function i(a,e){var f=[],g=a.goodsNo;"v1"==m&&(a=a.list);for(var i in a)if(getScope().isValidArray(a[i])){f=a[i];break}if(f==c||0==f.length)return void e([]);for(var j,k=[],n=f.length,o=0;n>o;o++)j=f[o],g&&g==j.product_code||k.push(j.product_code);if(0==k.length)return void e([]);k=h(k);var p=d.stylePushPrdData+"?goods_no="+k.splice(0,s).join();"localhost:8082"==location.host&&(p="http://mo2.lotte.com/"+p),b({url:p,method:"GET"}).success(function(a){if(a.prdList!=c){for(var b,f=[],g=a.prdList.length,h=d.isTestFlag?d.styleRecomUrl:a.styleShopUrl,i=0;g>i;i++)b=a.prdList[i],b.imgUrl2||(b.imgUrl2=b.imgUrl.replace(/_280/g,"_550")),b!=c&&0!=b.price2&&f.push(b);e(f,h)}else e([])}).error(function(a){l(),e([])})}function j(a,b){try{var c=0;switch(a){case"F":c=536870912;break;case"M":c=1073741824}return c+b}catch(d){}return""}function k(a){var c=getScope(),d="/json/search/m/insertStyleRecoLogInfo.json?call_api="+a.type+"&isApiResult="+a.result+"&isApp="+c.appObj.isApp+"&call_type="+a.screen+"&goods_no="+a.goodsNo;b({url:d,method:"GET"})}function l(){var a=getScope(),b=new Date,c=b.getHours(),d=10>c?"0"+c:""+c,e=a.tClickBase;""!=r&&(e=r),a.sendTclick(e+"ProdDetail_DataError_"+d)}var m="v1",n="LOTT5afb4ffde7d5521fbe52a00cb8191e9dc77d2b0eae5ead382c2d99f9",o="https://dl-api.oddconcepts.kr/"+m+"/",p=d.stylePushPrdData,q="/json/search/m/styleRecommCateGrpList.json",r="",s=400;this.setDotAPIUrl=function(a){p=a},this.setTclickBase=function(a){r=a},this.setSearchItemLimit=function(a){s=a};var t={8:{gender:"F",name:"스커트"},252:{gender:"F",name:"롱스커트"},253:{gender:"F",name:"미디스커트"},254:{gender:"F",name:"미니스커트"},32:{gender:"",name:"아우터"},232:{gender:"",name:"가디건"},233:{gender:"",name:"점퍼"},234:{gender:"",name:"코트"},235:{gender:"",name:"자켓"},236:{gender:"",name:"조끼"},1:{gender:"F",name:"원피스"},4:{gender:"",name:"반바지"},16:{gender:"",name:"상의"},242:{gender:"",name:"셔츠"},243:{gender:"F",name:"뷔스티에"},239:{gender:"",name:"후드"},241:{gender:"F",name:"블라우스"},240:{gender:"",name:"니트"},237:{gender:"",name:"티셔츠"},238:{gender:"",name:"맨투맨"},2:{gender:"",name:"바지"},249:{gender:"",name:"긴바지"},250:{gender:"",name:"7부 바지"},512:{gender:"",name:"수영복상의"},247:{gender:"F",name:"비키니상의"},248:{gender:"",name:"래쉬가드"},1024:{gender:"",name:"수영복하의"},258:{gender:"F",name:"비키니하의"},259:{gender:"M",name:"삼각수영복"},260:{gender:"M",name:"사각수영복"},2048:{gender:"",name:"원피스수영복"},265:{gender:"F",name:"원피스수영복"},266:{gender:"F",name:"모노키니"},267:{gender:"",name:"전신수영복"},2097152:{gender:"",name:"부츠"},274:{gender:"M",name:"부츠"},268:{gender:"F",name:"부티"},269:{gender:"F",name:"앵클부츠"},270:{gender:"",name:"워커"},271:{gender:"F",name:"롱부츠"},272:{gender:"F",name:"하프부츠"},273:{gender:"",name:"레인부츠"},4194304:{gender:"F",name:"구두"},275:{gender:"F",name:"펌프스"},276:{gender:"F",name:"스틸레토힐"},277:{gender:"F",name:"웨지힐"},278:{gender:"F",name:"토오픈힐"},279:{gender:"F",name:"슬링백"},280:{gender:"F",name:"스트랩힐"},8388608:{gender:"",name:"로퍼"},281:{gender:"F",name:"플랫슈즈"},282:{gender:"",name:"로퍼"},283:{gender:"F",name:"블로퍼"},284:{gender:"F",name:"옥스퍼드화"},296:{gender:"M",name:"정장화"},297:{gender:"M",name:"보트슈즈"},16777216:{gender:"",name:"샌들"},298:{gender:"",name:"샌들"},285:{gender:"F",name:"플랫샌들"},286:{gender:"F",name:"플랫폼샌들"},287:{gender:"F",name:"웨지샌들"},288:{gender:"F",name:"글래디에이터"},289:{gender:"F",name:"스트랩샌들"},290:{gender:"",name:"슬리퍼"},291:{gender:"",name:"쪼리"},292:{gender:"F",name:"뮬"},33554432:{gender:"",name:"스니커즈"},293:{gender:"",name:"하이탑"},294:{gender:"",name:"스니커즈"},295:{gender:"",name:"슬립온"},67108864:{gender:"",name:"운동화"},299:{gender:"",name:"등산화"},4096:{gender:"",name:"토트백"},8192:{gender:"",name:"숄더백"},65536:{gender:"",name:"클러치"},131072:{gender:"F",name:"파우치"},16384:{gender:"",name:"백팩"},262144:{gender:"M",name:"서류가방"},1048576:{gender:"",name:"캐리어"},32768:{gender:"",name:"힙색"},524288:{gender:"",name:"스포츠가방"}};this.detect=function(a,b){if(a==c)return console.warn("NO DATA"),!1;if(a.image==c||""==a.image)return console.warn("NO IMAGE"),!1;if(b==c||"function"!=typeof b)return console.warn("NO CALLBACK FUNCTION"),!1;a.type="detect";var d=o+"detect?url="+encodeURIComponent(a.image);a.sendGoodsNo!==!1&&a.goodsNo&&(d+="&product_code="+a.goodsNo),$.ajax({url:d,type:"get",dataType:"json",async:!0,beforeSend:function(a){a.setRequestHeader("apikey",n)},success:function(c){a.sortCate&&(c.sortCate=a.sortCate),b(f(c)),a.result="success",k(a)},error:function(c){a.result="fail",k(a),l(),b([])}}),getScope().sendTclick("DC_StyleReco_Detect")},this.search=function(a,b){if(a.id==c||""==a.id)return console.warn("NO ID"),!1;if(a.sex==c||""==a.sex)return console.warn("NO SEX"),!1;if(a.cate==c)return console.warn("NO CATEGORY"),!1;if(b==c||"function"!=typeof b)return console.warn("NO CALLBACK FUNCTION"),!1;var d=j(a.sex,a.cate);if(""==d)return console.warn("INCORRECT CATEGORY"),!1;a.type="search";var e={id:a.id,category:d,count:300},f={recommcgcd:1};switch(a.sub_cate!=c&&0!=a.sub_cate&&(f.sub_category=[a.sub_cate]),a.sort){case"order_count":case"reg_date":case"review_count":case"price":e.order_by=a.sort,e.reverse=1;break;case"price2":e.order_by="price"}if(a.subcate!=c||""!=a.subcate){var g=parseInt(a.subcate,10);isNaN(g)||(f.recommcgcd=g)}var h=o+"search/"+a.id+"?"+$.param(e);$.ajax({url:h,type:"POST",data:JSON.stringify(f),dataType:"JSON",async:!0,method:"POST",beforeSend:function(a){a.setRequestHeader("apikey",n),a.setRequestHeader("Content-Type","application/json")},success:function(c){c.goodsNo=a.goodsNo,i(c,b),a.result="success",k(a)},error:function(c){a.result="fail",k(a),l(),b([])}}),getScope().sendTclick("DC_StyleReco_Search")},this.cateList=function(a){$.ajax({url:q,type:"get",dataType:"json",async:!0,success:function(b){a(b.cateGrpList||[])},error:function(b){a([])}})},this.determineSex=function(a,b,c,d){var e=/^F$|^M$/,f=a.genCd;return f=e.test(a.genOnly)?a.genOnly:e.test(b)?b:"5"==c?a.genCd:e.test(a.genCd)?a.genCd:e.test(d)?d:"A"}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("lotteSlider",[]);d.controller("LotteSlideCtrl",["$scope",function(b){b.getTranslateXCssObj=function(a,b){var c={"-webkit-backface-visibility":"hidden","-moz-backface-visibility":"hidden","backface-visibility":"hidden","-webkit-transform":"translateX("+a+"px)","-ms-transform":"translateX("+a+"px)","-moz-transform":"translateX("+a+"px)",transform:"translateX("+a+"px)","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""};return b&&b>0&&(c["-webkit-transition"]="-webkit-transform "+b+"ms",c["-moz-transition"]="-moz-transform "+b+"ms",c["-o-transition"]="-o-transform "+b+"ms",c.transition="transform "+b+"ms"),c},b.removeTranslateCSS=function(){return{"-webkit-backface-visibility":"","-moz-backface-visibility":"","backface-visibility":"","-webkit-transform":"","-ms-transform":"","-moz-transform":"",transform:""}},b.getCoordinates=function(a){var b=a.touches&&a.touches.length?a.touches:[a],c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}},b.getTransXPos=function(b){var c=a.getComputedStyle(b.get(0)),d=new WebKitCSSMatrix(c.webkitTransform);return d.m41}}]),d.directive("lotteSlider",["$window","$timeout","$parse",function(a,c,d){return{controller:"LotteSlideCtrl",link:function(d,e,f,g){function h(){m=k.outerWidth(),l.css({display:"inline-block"}),n=l.outerWidth(),x=-(n-m);var a=d.getTransXPos;(a.x>0||a.x<x)&&i(0,500)}function i(a,b){l.css(d.getTranslateXCssObj(a,b)),k.trigger({type:"slide",posX:a,wrapWidth:m,contWidth:n})}function j(){k.on({"touchstart.lotteSlider":function(a){m=k.outerWidth(),n=l.outerWidth(),y=!1,z=!1,n>m&&(a.stopPropagation(),o=!0,q=d.getCoordinates(a),p=d.getTransXPos(l),t=Date.now())},"touchmove.lotteSlider":function(a){if(o){var b,c;if(r=d.getCoordinates(a),b=Math.abs(r.x-q.x),c=Math.abs(r.y-q.y),y||(z=b>c,y=!0),z){b>5&&a.preventDefault(),a.stopPropagation();var e=p+r.x-q.x;e>0?e/=3:x>e&&(e=x+(e-x)/3),i(e,0)}}},"touchend.lotteSlider":function(a){if(s=d.getCoordinates(a),o&&q.x!=s.x&&(Math.abs(q.x-s.x)>5&&a.preventDefault(),event.stopPropagation(),y=!1,z)){m=k.outerWidth();var b=d.getTransXPos(l);u=Date.now(),w=q.x>s.x?-1:1,v=u-t;var c=Math.abs(q.x-s.x),e=.4,f=c*e/v,g=b+m*f*w;g>0?g=0:x>g&&(g=x),(Math.abs(b-g)>30||0==g||g==x)&&i(g,500)}},"touchcancel.lotteSlider":function(a){}}),b.element(a).on("resize.lotteSlider orientationchange.lotteSlider",function(){h()})}var k=b.element(e),l=k.find(">").eq(0),m=k.width(),n=l.width(),o=!1,p=0,q=null,r=null,s=null,t=0,u=0,v=0,w=0,x=0;d.lotteSliderMoveXPos=function(a,b){m=k.width(),n=l.width(),a>0?a=0:Math.abs(a)>n-m&&(a=-(n-m)),b||(b=0),i(a,b)},d.reset=function(){o=!1,i(0,0),c(function(){h()})};var y=!1,z=!1;c(function(){h(),j()})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteSideMylotte","lotteCommFooter","lotteSlider","lotteSns"]);d.controller("StyleRecomCtrl",["$scope","$http","LotteCommon","LotteForm","LotteStorage","commInitData","StyleRecom",function(b,c,d,e,f,g,h){function i(a){return 10>a?"0"+a:a+""}function j(a,b,c,d,e,f){var g=new Date(a,b,c,d,e,f);return a&&b&&c&&(g.setFullYear(a),g.setMonth(b-1),g.setDate(c),d&&g.setHours(d),e&&g.setMinutes(e),f&&g.setSeconds(f)),g.getTime()}if(b.showWrap=!0,b.contVisible=!0,b.subTitle="스타일추천",b.screenID="StyleReco",b.hasSharePreFunc=!0,b.isShowThisSns=!0,b.planShopSns=!0,b.share_img=g.query.img,b.dataLoaded=!1,b.SR_IMG="",b.SR_IMG_WIDTH=0,b.SR_IMG_HEIGHT=0,b.DETECT_LIST=[],b.PROD_LIST=[],b.PROD_ORIGIN_LIST=[],b.CATE_NO=g.query.cate,b.PROD_SEX=g.query.prdGen,b.GOODS_NO=g.query.goods_no,b.SORT_CATE=g.query.sortCate,b.isCamera=g.query.img_key,b.styleCateList=[],!b.isValidString(b.GOODS_NO))try{var k=b.share_img.split("/"),l=k[k.length-1];b.GOODS_NO=l.substr(0,l.indexOf("_")),isNaN(b.GOODS_NO)&&(b.GOODS_NO="")}catch(m){}b.showHeaderCamera=!0,b.isShowLoading=!0,b.showCategory=!1,b.noCateSlide=!1,b.SEX=[{label:"여성",data:"F"},{label:"남성",data:"M"},{label:"전체",data:"A"}],b.childSex=[{label:"여아",data:"F"},{label:"남아",data:"M"},{label:"전체",data:"A"}],b.CATE=[{label:"상의",data:16,tclick:1,selected:!1},{label:"아우터",data:32,tclick:6,selected:!1},{label:"긴바지",data:2,tclick:2,selected:!1},{label:"반바지",data:4,tclick:3,selected:!1},{label:"스커트",data:8,tclick:5,selected:!1},{label:"원피스",data:1,tclick:4,selected:!1}],b.SORT=[{name:"정확도순",value:""},{name:"추천순",value:"order_count"},{name:"신상품순",value:"reg_date"},{name:"상품평많은순",value:"review_count"},{name:"낮은가격순",value:"price2"},{name:"높은가격순",value:"price"}],b.currentSort=b.SORT[0],b.sortLayerVisible=!1,b.selectedID="";var n=new Date,o=n.getFullYear()+i(n.getMonth()+1)+i(n.getDate()),p=n.getTime();if(g.query.testDate){g.query.testDate;o=g.query.testDate,p=j(o.substring(0,4),o.substring(4,6),o.substring(6,8),o.substring(8,10),o.substring(10,12),o.substring(12,14))}b.styRecomBnr=!1,p<j(2017,6,30,17,0)&&(b.styRecomBnr=!0),b.refreshStyle=function(a,c){b.ga("추천상품_재검색","상품_"+c);var e=a.imgUrl2,f=e.replace("280.jpg","550.jpg");10>c&&(c="0"+c);var g="m_DC_"+b.screenID+"_clk_RePrd_idx"+c,i=h.determineSex(a,b.PROD_SEX,b.CATE_NO,b.loginInfo.genSctCd),j={tclick:g,img:f,goods_no:a.goodsNo,cate:b.CATE_NO,prdGen:i,sortCate:b.selectedItem.category};location.href=d.styleRecomUrl+"?"+b.getBaseParam(!0)+"&"+$.param(j)},b.goStyleRecom=function(c){if(c.img_url&&c.img_key){var e="&tclick=m_DC_"+b.screenID+"_clk_camera";a.location.href=d.styleRecomUrl+"?img="+c.img_url+"&img_key="+c.img_key+"&"+b.baseParam+e}},b.showSharePopPre=function(){b.ga("공유","");var a={shareImg:b.share_img,tclick:"m_DC_"+b.screenID+"_clk_share"};b.showSharePop(a),g.query.img_key&&c.get("/json/search/m/updateStyleRecoShareState.json?img_key="+g.query.img_key).success(function(a){console.log("updateStyleRecoShareState 성공")}).error(function(a){console.log("Error Data :  updateStyleRecoShareState 실패")})},b.addWishList=function(a,f){return b.ga("추천상품_위시리스트","상품_"+f),b.loginInfo.isLogin?a.wishAdded?(b.alert_2016("이미 등록된 상품입니다."),!1):void c({method:"POST",url:d.prdAddWish,data:{goods_nos:a.goodsNo},transformRequest:e.JsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){a.wishAdded=!0}).error(function(c){if(c.error){var d=c.error.response_code,e=c.error.response_msg;switch(d){case"5002":a.wishAdded=!0;break;case"9003":b.alert_2016(e,{callback:function(){var a="targetUrl="+encodeURIComponent(location.href,"UTF-8");location.href="/login/m/loginForm.do?"+a}});break;default:b.alert_2016(e)}}else b.alert_2016("처리중 오류가 발생하였습니다.")}):(b.alert_2016("로그인 후 이용하실 수 있습니다.",{callback:function(){b.gotoService("loginUrl",{targetUrl:encodeURIComponent(location.href)})}}),!1)}}]),d.directive("styleRecomImageLoad",["$timeout","commInitData",function(a,c){return{restrict:"A",link:function(d,e,f){function g(){i(),d.detectStyleRecom(),c.query.img_key&&d.cateListStyleRecom()}function h(){d.$parent.SR_IMG="",a(function(){d.alert_2016("추천 상품을 준비중입니다.<br />다른 이미지로 검색해주세요.")},1)}function i(){var a=b.element("#srImage");d.SR_IMG_WIDTH=a.width(),d.SR_IMG_HEIGHT=a.height()}e.bind("load",g),e.bind("error",h)}}}]),d.directive("lotteContainer",["LotteCommon","commInitData","StyleRecom","$timeout","$window","LotteStorage","LotteGA",function(d,e,f,g,h,i,j){return{templateUrl:"/lotte/resources_dev/search/style_recom_container.html",replace:!0,link:function(k,l,m){function n(){if(e.query.img==c||""==e.query.img)return void k.alert_2016("이미지가 없습니다.");k.SR_IMG=decodeURIComponent(e.query.img);var a=b.element(h);a.on("scroll orientationchange",E),a.on("unload",p),b.element("#file_input").bind("click",function(){k.ga("사진촬영업로드","")})}function o(){g(function(){k.dataLoaded=!0},50)}function p(){var a={scrollY:b.element(h).scrollTop(),page_no:I,prod_list:k.PROD_ORIGIN_LIST,detect_list:k.DETECT_LIST,selected_id:k.selectedID,cur_sort:k.currentSort.value,genderCode:K};try{var c=i.getSessionStorage("styleRecomStorage_1","json");null===c&&(c={});var d=e.query.img;c[d]=a,i.setSessionStorage("styleRecomStorage_1",c,"json")}catch(f){}}function q(a){a&&a.length>0&&(k.styleCateList=a);var b=0;$("#cateListSlider li").each(function(a,c){b+=$(c).width()+6}),$("#cateListSlider ul").width(b)}function r(){var a={image:k.SR_IMG,goodsNo:k.GOODS_NO,sendGoodsNo:!1,screen:"style",sortCate:k.SORT_CATE},b=f.detect(a,s);b===!1&&($("#loading").hide(),k.alert_2016("데이터를 불러올 수 없습니다.<br/>잠시 후에 다시 시도해 주세요."),o())}function s(a){return g(function(){$("#loading").hide()},0),k.DETECT_LIST=a,a==c||0==a.length?(o(),void k.alert_2016("추천 상품을 준비중입니다.<br/>다른 이미지로 검색해주세요.")):(K=k.DETECT_LIST[0].genCd,k.selectDetection(k.DETECT_LIST[0],0),void g(t,10))}function t(){var a,c=b.element("#categorySlider"),d=c.find("ul"),e=c.find("li"),f=0;b.forEach(e,function(c,d){a=b.element(c),f+=a.outerWidth()+1}),d.width(f),c.width()>=f?k.noCateSlide=!0:k.noCateSlide=!1,g(u,10)}function u(){b.element("#categorySlider").scope().reset(),k.showCategory=!0}function v(a){$("#loading").show();var b=f.determineSex(a,k.PROD_SEX,k.CATE_NO,k.loginInfo.genSctCd),c={id:a.id,sex:b,cate:a.category,subcate:e.query.cate,sort:k.currentSort.value,goodsNo:k.GOODS_NO,screen:"style"};a.sub_category.score>.2&&(c.sub_cate=a.sub_category.code);var d=f.search(c,B);d===!1&&($("#loading").hide(),o(),k.alert_2016("데이터를 불러올 수 없습니다.<br/>잠시 후에 다시 시도해 주세요."))}function w(){var c=b.element(".category_slider").scope(),d=b.element(".category_slider ul"),e=b.element(".category_slider li.on"),f=b.element(a),g=Math.round(e.offset().left-d.offset().left+e.width()/2-f.width()/2);c.lotteSliderMoveXPos(-g,250)}function x(a){$("#loading").hide(),"string"==typeof a&&(a=JSON.parse(a)),a.styleUpImgInfo&&k.goStyleRecom(a.styleUpImgInfo)}function y(){$("#loading").hide(),$("body").fadeIn(),k.alert_2016("파일을 전송하지 못했습니다.<br/>잠시 후 다시 시도해 주세요."),$("input#file_input").prop("disabled",!1)}function z(a){return"image/jpeg"==a||"image/png"==a?!0:!1}function A(a,b){var c=new FileReader;c.onload=function(a){var c=new DataView(a.target.result);if(65496!=c.getUint16(0,!1))return b(-2);for(var d=c.byteLength,e=2;d>e;){var f=c.getUint16(e,!1);if(e+=2,65505==f){if(1165519206!=c.getUint32(e+=2,!1))return b(-1);var g=18761==c.getUint16(e+=6,!1);e+=c.getUint32(e+4,g);var h=c.getUint16(e,g);e+=2;for(var i=0;h>i;i++)if(274==c.getUint16(e+12*i,g))return b(c.getUint16(e+12*i+8,g))}else{if(65280!=(65280&f))break;e+=c.getUint16(e,!1)}}return b(-1)},c.readAsArrayBuffer(a)}function B(a){k.PROD_ORIGIN_LIST=a,0==a.length&&(k.PROD_LIST.length=0),H=Math.ceil(a.length/G),I=0,C(),o(),g(function(){$("#loading").hide()},0)}function C(){J||I>=H||(J=!0,g(D,10))}function D(){I++;var a=I*G;k.PROD_LIST=k.PROD_ORIGIN_LIST.slice(0,a),J=!1}function E(a){F();var b=M.scrollTop(),c=M.outerHeight(),d=Q.outerHeight();0==N.length?0:N.offset().top,O.height();k.PROD_LIST.length>0&&b+3*c>=d&&C()}function F(){(M==c||O==c||P==c||Q==c)&&(M=b.element(h),O=b.element("#head_sub"),P=b.element(".clipping_beauty"),Q=b.element("#wrapper")),(N==c||0==N.length)&&(N=b.element("#style_category"))}var G=k.appObj.isTablet?100:30,H=0,I=0,J=!1,K="";k.toggleSortLayer=function(a){k.sortLayerVisible?k.closeSideSearch():(k.sortLayerVisible=!0,k.dimmedOpen({target:"sideSearch",callback:this.closeSideSearch,scrollEventFlag:!1})),"btn"==a&&k.ga("정렬순","")},k.closeSideSearch=function(){"sideSearch"==k.LotteDimm.target?k.dimmedClose():k.sortLayerVisible=!1},k.changeSort=function(a){k.ga("정렬순_필터레이어",a.name),k.currentSort!=a&&(k.currentSort=a,v(k.selectedItem)),k.LotteDimm.scrollY=0,k.closeSideSearch()},k.showHideSortGuide=function(b){b.stopPropagation(),a.alert("최근 15일동안 많이 판매된 상품을 누적한 기준으로 상품을 정렬합니다.")},k.cateListStyleRecom=function(){f.cateList(q)},k.detectStyleRecom=function(){if($("#loading").show(),null==history.state||"stylerecom"!=history.state.name)history.replaceState({name:"stylerecom"},"stylerecom"),r();else{var d=i.getSessionStorage("styleRecomStorage_1","json"),f=c,j=e.query.img;if(d&&d[j]&&(f=d[j]),"localhost:8082"==location.host&&(f=null),f==c||f.detect_list==c||f.selected_id==c||f.prod_list==c||0==f.detect_list.length||0==f.prod_list.length)r();else{k.DETECT_LIST=f.detect_list,k.selectedID=f.selected_id,K=f.genderCode;for(var l,m=k.DETECT_LIST.length,n=0;m>n;n++)if(l=k.DETECT_LIST[n],l.id==k.selectedID){k.selectedItem=l;break}b.forEach(k.SORT,function(a,b){a.value==f.cur_sort&&(k.currentSort=a)}),g(t,10),g(w,100),k.PROD_ORIGIN_LIST=f.prod_list,H=Math.ceil(k.PROD_ORIGIN_LIST.length/G),f.page_no!=c?(I=f.page_no-1,0>I&&(I=0)):I=0,C(),g(function(){var c=b.element(h).scrollTop();f.scrollY!=c&&$(a).scrollTop(f.scrollY)},200);try{var p=i.getSessionStorage("styleRecomStorage_1","json"),j=e.query.img;p[j]="",i.setSessionStorage("styleRecomStorage_1",p,"json")}catch(q){}$("#loading").hide(),o()}}},k.selectDetection=function(a,b,c){k.selectedID!=a.id&&(k.currentSort=k.SORT[0],k.selectedItem=a,k.selectedID=a.id,v(a),g(w,10),"디텍트"==c?k.ga(c,""):"카테고리"==c&&k.ga(c,a.ctgName),k.sendTclick("m_DC_StyleReco_Swp_Rel_A"+(b+1)))};var L="http://www.lotte.com/display/insertStyleRecoUploadImage.lotte";k.detectFile=function(){$("#loading").show(),$("body").fadeIn();var a=document.querySelector("#file_input"),b=a.files[0].type,c=8,d=a.files[0].size,e=1e3*c*1e3;return z(b)?d>e?(alert("사진 용량이 "+c+"MB 초과하였습니다."),$("#loading").hide(),void $("body").fadeIn()):void A(a.files[0],k.cbFileExif):(alert("지원하지 않는 확장자입니다."),$("#loading").hide(),void $("body").fadeIn())},k.uploadFile=function(a){$("input#file_input").prop("disabled",!0);var b=new FormData;b.append("file",document.getElementById("file_input").files[0]),b.append("rote_code",a),$.ajax({type:"post",data:b,async:!1,cache:!1,url:L,success:x,error:y,contentType:!1,processData:!1})},k.cbFileExif=function(a){k.uploadFile(a)},k.selectCateGrp=function(b,c){var f="m_DC_"+k.screenID+"_clk_cate_"+b.cate;a.location.href=d.styleRecomUrl+"?img="+e.query.img+"&"+k.getBaseParam(!0)+"&cate="+b.cate+"&tclick="+f},k.gotoProductDetail=function(a,b){k.ga("추천상품","상품_"+(b+1)),a.curDispNoSctCd=14;var c=b+1;k.productView(a,null,null,"m_DC_StyleReco_Clk_Prd_idx"+(10>c?"0"+c:c))},k.getProductUrl=function(a,b){a.curDispNoSctCd=14;var c=b+1;return k.getProductViewUrl(a,"m_DC_StyleReco_Clk_Prd_idx"+(10>c?"0"+c:c),!0)};var M,N,O,P,Q;k.ga=function(a,b){var c="MO_스타일추천";k.appObj.isApp&&(c="APP_스타일추천"),j.evtTag(c,a,b)},n(),k.styRecomBnrUrl=function(){a.location.href=d.prdlstUrl+"?curDispNo=5407118&"+k.baseParam+"&tclick=m_DC_StyleReco_Clk_event"}}}}])}(window,window.angular);