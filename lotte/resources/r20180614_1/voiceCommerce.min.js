!function(a,b,c){"use strict";var d=b.module("voiceCommerceService",["lotteUrl","lotteUtil"]);console.log("ver","rt20180525_5"),d.service("VCBasicInfo",["$http","$q","LotteCommon","LotteStorage",function(a,b,c,d){function e(){g.semanticHistory=[];var a=d.getLocalStorage(h,"json");if(a&&a.length>0){var b=0;for(b=0;b<a.length;b++)a[b].keyword&&a[b].date&&g.semanticHistory.push({keyword:a[b].keyword,date:a[b].date})}}function f(){var a=d.getLocalStorage(i);a?g.lastInputMode=a:g.lastInputMode=""}var g=this,h="vsSemanticKeywordHome";g.semanticHistory=[];var i="vsInputType";g.lastInputMode="",g.initBasicInfo=function(){return g.basicInfo={member_info:{prior_info_chk:!1,base_op_pay_chk:!1,et_mbr_dlvp_chk:!1,card_pay_meth_cd:"",caer_pay_meth_nm:"",bnk_cd:"",pay_mean_cd:"",pay_mean_nm:"",acqr_cd:"",pay_nm:"",dlvp_nm:"",post_no:"",post_addr:"",dtl_addr:"",rmit_nm:"",cell_txno_no:"",cell_sct_no:"",cell_end_no:"",morc_man_nm:"",cbl_tel_rgn_no:"",cbl_tel_txno_no:"",cbl_tel_end_no:"",addr_choc_sct_cd:"",member_no:"",pr_dlvp_chane_chk:"",onlCno:"",pay_card_rcgn_id:""},greeting_info:{user_nm:"",greeting_img_url:"",greeting_txt:""},samada_list:{items:[{list_cate:"",list_cate_bg:"",conts_list:{items:[],total_count:0}}],total_count:0}},g.basicInfo},g.initBasicInfo(),g.getBasicInfo=function(d){var e=b.defer(),f={};return d&&(f.mbr_no=d),a({url:c.vcInfoData,method:"get",params:f}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b?(g.basicInfo=b,e.resolve(g.basicInfo)):e.reject(g.basicInfo)}else console.error("보이스 커머스 기본 정보 로드 오류"),g.basicInfo=g.initBasicInfo(),e.reject(g.basicInfo)},function(a){console.error("보이스 커머스 기본 정보 로드 실패"),g.basicInfo=g.initBasicInfo(),e.reject(g.basicInfo)}),e.promise},g.getEvtTxt=function(){var d=b.defer();return a({url:c.vcHelpInfoData,method:"get",params:{conr_no:"75355"}}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b&&b.help_info_list&&b.help_info_list[0]&&b.help_info_list[0].banner_nm?d.resolve(b.help_info_list[0].banner_nm):d.reject([])}else console.error("햄버거옆 이벤트 정보 데이터 오류"),d.reject([])},function(a){console.error("햄버거옆 이벤트 정보 데이터 오류"),d.reject([])}),d.promise},g.getBgDeco=function(){var d=b.defer();return a({url:c.vcHelpInfoData,method:"get",params:{conr_no:"75059"}}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b&&b.help_info_list&&b.help_info_list[0]&&b.help_info_list[0].img_url?d.resolve(b.help_info_list[0].img_url):d.reject("")}else d.reject("")},function(a){d.reject("")}),d.promise},e(),g.getSemanticeHistory=function(){return g.semanticHistory};var j=10;g.saveSemanticHistory=function(a){var b=new Date;if(g.semanticHistory){for(var c=g.semanticHistory.length,e=0;c>e;e++)if(a==g.semanticHistory[e].keyword){g.semanticHistory.splice(e,1);break}g.semanticHistory.unshift({keyword:a,date:b.getTime()}),g.semanticHistory.length>j&&(g.semanticHistory=g.semanticHistory.slice(0,j))}else g.semanticHistory=[{keyword:a,date:b.getTime()}];d.setLocalStorage(h,g.semanticHistory,"json")},f(),g.getInputMode=function(){return g.lastInputMode},g.saveInputMode=function(a){("mic"==a||"keyboard"==a)&&d.setLocalStorage(i,a)}}]),d.service("VCStartVoiceInfo",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.voiceInfo=[],d.getVoiceInfo=function(){var e=b.defer();return a({url:c.vcStartVoiceInfoData,method:"get"}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b&&b.guide_list&&b.guide_list.items?(d.voiceInfo=b.guide_list.items,e.resolve(d.voiceInfo)):e.reject(d.voiceInfo)}else console.error("보이스 커머스 기본 발화 정보 로드 오류"),e.reject(d.voiceInfo)},function(a){console.error("보이스 커머스 기본 발화 정보 로드 실패"),e.reject(d.voiceInfo)}),e.promise}}]),d.service("VCHelpInfo",["$http","$q","LotteCommon","LotteStorage",function(a,b,c,d){var e=this;e.helpInfo={home:{conrNo:"",list:[{banner_nm:"여기를 터치해 말해보세요"}]},prod_list:{conrNo:"74755",list:[]},prod_detail:{conrNo:"74756",list:[]},order:{conrNo:"74757",list:[]},cart:{conrNo:"74758",list:[]},wish:{conrNo:"74759",list:[]},etc:{conrNo:"74760",list:[]}},e.getHelpInfo=function(d){var f=b.defer();if(console.log("getHelpInfo"),e.helpInfo[d]&&e.helpInfo[d].list&&e.helpInfo[d].list.length>0)f.resolve(e.helpInfo[d].list);else{e.helpInfo[d]||(d="etc");var g=e.helpInfo[d].conrNo?e.helpInfo[d].conrNo:"74760";a({url:c.vcHelpInfoData,method:"get",params:{conr_no:g}}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b&&b.help_info_list?(e.helpInfo[d].list=b.help_info_list,f.resolve(e.helpInfo[d].list)):f.reject([])}else console.error("보이스 커머스 도움말 정보 로드 오류",d),f.reject([])},function(a){console.error("보이스 커머스 도움말 정보 로드 실패",d),f.reject([])})}return f.promise}}]),d.service("VCSendMsg",["$http","$q","LotteCommon","VCBasicInfo",function(a,c,d,e){var f=this;f.sendSemanticAnalysis=function(b){var g=c.defer(),h={screenEng:b.screen,screen:f.screenToHangul(b.screen),qType:"",text:b.text,history:b.history,mbrNo:b.mbrNo?b.mbrNo:null,preReqParam:b.preReqParam?b.preReqParam:null};switch(b.qType){case"mic":h.qType="V";break;case"keyboard":h.qType="I";break;case"click":h.qType="T";break;default:h.qType=""}return h.screen&&""!=h.screen&&""!=h.qType&&h.text&&""!=h.text?(a({url:d.semanticAnalysisData,method:"get",params:h}).then(function(a){var c=a.data?a.data:null;a.data&&"00000"==a.data.responseCode?c?(("home"==h.screenEng||1==h.history)&&e.saveSemanticHistory(b.text),g.resolve(c)):(console.error("의미분석 실패"),g.reject()):"99999"==a.data.responseCode?(console.error("의미분석 실패",a.data.responseMsg),c&&g.resolve(c)):(console.error("의미분석 실패",a.data.responseMsg),g.reject())},function(a){console.error("의미분석 연동 실패"),g.reject()}),g.promise):(console.log("reject",h,b,h.screen),g.reject(),g.promise)},f.screenToHangul=function(a){var c,d={home:"홈",prod_list:"상품리스트",prod_detail:"상품상세",cart:"장바구니",wish:"위시리스트",order:"주문확정",order_complete:"주문완료"};return b.forEach(d,function(b,d){a==d&&(c=b)}),c}}]),d.service("VCGetPrdInfo",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.getPrdListInfo=function(d){var e=b.defer();return a({url:c.vcPrdInfoData,method:"get",params:d}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;if(b.prd_list&&b.prd_list.items){var c=b;e.resolve(c)}else e.resolve([])}else console.error("상품정보 로드 실패"),e.reject()},function(a){console.error("상품정보 로드 실패"),e.reject()}),e.promise}}]),d.service("VCGetPrdDetailInfo",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.getProdImgInfo=function(d){var e=b.defer();return d||e.reject(),a({url:c.vcPrdImgListData,method:"get",params:{goods_no:d}}).then(function(a){var b=a.data?a.data:null;if(b&&b.data){var c=b.data&&b.data.imgList?b.data.imgList:[];e.resolve(c)}else console.error("상품이미지 리스트 로드 실패"),e.reject()},function(a){console.error("상품이미지 리스트 로드 실패"),e.reject()}),e.promise},d.getPrdDetailListInfo=function(d){var e=b.defer();return d||e.reject(),a({url:c.productProductView2017Data,method:"get",params:{goods_no:d}}).then(function(a){var b=a.data?a.data:null;if(b&&b.data){var c=b.data;e.resolve(c)}else console.error("상품상세정보 로드 실패"),e.reject()},function(a){console.error("상품상세정보 로드 실패"),e.reject()}),e.promise},d.getPrdDetailHtmlInfo=function(d){var e=b.defer();return d||e.reject(),a({url:c.productDetailData,method:"get",params:{goods_no:d}}).then(function(a){var b=a.data;if(b.max){var c=b;e.resolve(c)}else console.error("상품상세 Html 정보 로드 실패"),e.reject()},function(a){console.error("상품상세 Html 정보 로드 실패"),e.reject()}),e.promise}}]),d.service("VCGetProdComment",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.getProdComment=function(d,e){var f=b.defer();return d||f.reject(),a({url:c.vcProductCommentData,method:"get",params:{all_view_yn:"Y",goods_no:d,page:e,sort:"L"}}).then(function(a){var b=a.data?a.data:null;if(b&&b.data){var c=b.data;f.resolve(c)}else console.error("상품평정보 로드 실패"),f.reject()},function(a){console.error("상품평정보 로드 실패"),f.reject()}),f.promise}}]),d.service("VCGetPrdOption",["$http","$q","LotteCommon",function(a,b,c){function d(a){var b=[],c=0;for(c=0;c<a.length;c++)a[c].invQty>0&&!a[c].optStkYn&&b.push(a[c]);return b}var e=this;e.prdOptInfo={goodsNo:null,optInfo:null},e.getPrdOptInfo=function(f){var g=b.defer();return f?e.prdOptInfo.goodsNo==f&&e.prdOptInfo.optInfo?g.resolve(e.prdOptInfo.optInfo):a({url:c.vcPrdOptInfoData,method:"get",params:{goods_no:f}}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data;if(b.data){var c=b.data;if(c.optDtlList&&c.optDtlList.items&&c.optDtlList.items.length>0){var h=d(c.optDtlList.items);h&&h.length>0?(e.prdOptInfo={goodsNo:f,optInfo:{optSelectList:c.optSelectList.items,optItems:h}},g.resolve(e.prdOptInfo.optInfo)):g.resolve(null)}else g.resolve(null)}else console.error("상품 옵션 정보 로드 실패"),g.reject()}else console.error("상품 옵션 정보 로드 실패"),g.reject()},function(a){console.error("상품 옵션 정보 로드 실패"),g.reject()}):g.reject(),g.promise}}]),d.service("VCGetPrdQty",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.chkProdQty=function(d,e){console.log("재고체크",d,e);var f=b.defer(),g={};return d?(g.goods_no=d,e&&(g.item_no=e),a({url:c.vcPrdQtyChkData,method:"get",params:g}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b&&"S"==b.inv_stat_cd?f.resolve(b):(console.error("재고 없음"),f.reject(b))}else console.error("재고 체크 확인 실패"),f.reject()},function(a){console.error("재고 체크 확인 실패"),f.reject()})):f.reject(),f.promise}}]),d.service("VCGetOrderDecide",["$http","$q","LotteCommon","LotteAppChk","commInitData","LotteCookie",function(a,c,d,e,f,g){var h=this;h.getOrderDecide=function(h){var i=c.defer(),j={member_no:"",goods_no:"",goods_cmps_cd:"",site_no:1,uagent:e.appObj.isAndroid?"Y":"N",cp_schema:f.query.schema,cp_v:f.query.v,cp_udid:f.query.udid,chl_no:g.getCookie("CHLNO"),chl_dtl_no:g.getCookie("CHLDTLNO"),infw_disp_no:"5607666",infw_disp_no_sct_cd:"18"};return h&&(console.log("주문확정 데이터 요청",j,h),j=b.extend(j,h)),j.goods_no?a({url:d.vcPrdOrderDecideData,method:"get",params:j}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b?i.resolve(b):(console.error("주문확정 정보 확인 실패"),i.reject(b))}else console.error("주문확정 정보 확인 실패"),i.reject(a.data.result.response_msg)},function(a){console.error("주문확정 정보 확인 실패"),i.reject(null)}):i.reject(),i.promise}}]),d.service("VCOrder",["LotteCommon","$window","LotteUtil",function(a,d,e){function f(){if(d.lpay)try{d.lpay.merchantAuth({mchtAuthKey:m,onlCno:n,callback:g})}catch(a){console.log("error",1),q(!1)}else console.log("error",2),q(!1)}function g(a){a==c||"S"!=a.resClac?(console.log("error",3,a),q(!1)):(console.log("error",4),q(!0))}function h(a){if(a==c||"S"!=a.resClac)console.error("Lpay 결제 수단 확인 실패"),r(!1);else{console.log("Lpay 결제 수단 확인 성공");var d={fnCoNm:"",pmtMthdAlias:""};b.forEach(a.pmtMthdList,function(a,b){a.pmtMthdId==o&&(d.fnCoNm=a.fnCoNm,d.pmtMthdAlias=a.pmtMthdAlias)}),r((d.pmtMthdAlias+"").length>0?d:!1)}}var i=this,j="https://web.lpay.com:1452",k="e30f88c2c39f2a82af5d08f4691ba6b6",l="6000002",m="00076790",n=null,o=null,p=a.talkShopOrderFrame,q=function(){},r=function(){};i.initLpay=function(){d.lpay=new Lpay({name:"lpay",url:j,merchantSignKey:k,reqTypeCd:l,style:"1",openMode:"0",closeCallback:function(){console.warn("lpay close")},__iframe:{},popupReturnUrl:""})},i.authLpayMerchant=function(a,b){n=a,b&&(q=b),f()},i.getLpayPaymentInfo=function(a,b){if(b&&(r=b),!a)return r(!1),!1;if(o=a,d.lpay)try{d.lpay.getPaymentMethod({onlCno:n,callback:h})}catch(c){r(!1)}else r(!1)},i.getOrderUrl=function(a,b){var c="";return a&&b&&(c=p+"?talkYN=Y&vc=Y&cart_sn="+a+"&goods_no="+b+"&"+e.getBaseParam()),c}}]),d.service("VCOrderComplete",["$http","$q","LotteCommon",function(a,c,d){var e=this;e.getOrderComplete=function(e){var f=c.defer(),g={member_no:"",ord_no:""};return e&&(g=b.extend(g,e)),g.ord_no&&g.member_no?a({url:d.vcOrdCompleteData,method:"get",params:g}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b?f.resolve(b):(console.error("주문완료 정보 확인 실패"),f.reject(b))}else console.error("주문완료 정보 확인 실패"),f.reject()},function(a){console.error("주문완료 정보 확인 실패"),f.reject()}):f.reject(),f.promise}}]),d.service("VCAddCart",["$http","$q","LotteCommon",function(a,c,d){var e=this;e.addCart=function(e){var f=c.defer(),g={member_no:null,goods_no:null,item_no:null,ord_qty:1,goods_cmps_cd:null,voice:"Y",infw_disp_no:"5607666",infw_disp_no_sct_cd:"18",cart_page_yn:"N"};return e&&(g=b.extend(g,e)),console.log("장바구니 담아줘",g),g.goods_no&&(g.item_no||0===g.item_no)&&g.ord_qty&&g.goods_cmps_cd?a({url:d.vcAddCart,method:"get",params:g}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.result?a.data.result:null;f.resolve(b)}else console.error("장바구니 담기 실패"),f.reject(a.data.result)},function(a){console.error("장바구니 담기 연동 실패"),f.reject(a)}):f.reject(),f.promise}}]),d.service("VCUpdateCart",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.updateCart=function(d){var e=b.defer(),f={cart_sn:d.cart_sn,ord_qty:d.ord_qty,item_no:d.item_no,update_ck:d.update_ck?!0:!1,goods_no:d.goods_no,goods_cmps_cd:d.goods_cmps_cd};return console.log("장바구니 옵션 변경",f),f.cart_sn&&f.ord_qty&&(f.item_no||0===f.item_no)&&f.goods_no&&f.goods_cmps_cd?a({url:c.cartUpdateOptionData,method:"post",params:f}).then(function(a){e.resolve(a)},function(a){console.error("장바구니 업데이트 연동 실패"),e.reject()}):e.reject(),e.promise}}]),d.service("VCAddWish",["$http","$q","LotteCommon",function(a,c,d){var e=this;e.addWish=function(e){var f=c.defer(),g={member_no:null,goods_no:null};return e&&(g=b.extend(g,e)),g.goods_no&&g.member_no?a({url:d.vcAddWish,method:"get",params:g}).then(function(a){a.data.result&&"00000"==a.data.result.response_code?f.resolve(a.data.result.response_code):a.data.result&&"00001"==a.data.result.response_code?f.resolve(a.data.result.response_code):(console.error("위시 담기 오류"),f.reject())},function(a){console.error("위시 담기 연동 실패"),f.reject()}):f.reject(),f.promise}}]),d.service("VCDeliveryInfo",["$http","$q","LotteCommon",function(a,c,d){var e=this;e.getDeliveryInfo=function(e){var f=c.defer(),g={goods_no:null};return e&&(g=b.extend(g,e)),g.goods_no?a({url:d.vcDeliveryInfoData,method:"get",params:g}).then(function(a){if(a.data.result&&"00000"==a.data.result.response_code){var b=a.data.data?a.data.data:null;b?f.resolve(b):(console.error("배송 정보 확인 오류"),f.reject())}else console.error("배송 정보 확인 오류"),f.reject()},function(a){console.error("배송 정보 확인 연동 실패"),f.reject()}):f.reject(),f.promise}}]),d.service("VCHotKeywordInfo",["$http","$q","LotteCommon",function(a,b,c){var d=this;d.getHotKeyword=function(){var d=b.defer();return a({url:c.srhBestData,method:"get"}).then(function(a){a.data.searchPopList&&a.data.searchPopList.result_best&&a.data.searchPopList.result_best.items&&a.data.searchPopList.result_best.items.length>0?d.resolve(a.data.searchPopList.result_best.items):(console.error("인기검색어 데이터 오류"),d.reject())},function(a){console.error("인기검색어 연동 실패"),d.reject()}),d.promise}}]),d.service("VCPageMove",["LotteCommon","LotteUtil","$window","$location","$timeout",function(a,c,d,e,f){var g=this,h=500,i={goLogin:{url:a.loginForm,needLogin:!1},goChangePayment:{url:a.talkShopPayment,param:{vc:"Y"},needLogin:!0},goChangeDelivery:{url:a.talkShopDelevery,param:{vc:"Y"},needLogin:!0},goPurchaseList:{url:a.ordLstUrl,needLogin:!0},goCoupon:{url:a.myCouponUrl,param:{point_div:"coupon"},needLogin:!0},goPoint:{url:a.myCouponUrl,param:{point_div:"lt_point"},needLogin:!0},goWish:{url:a.wishLstUrl,needLogin:!0},goEvent:{url:a.eventGumeUrl,param:{search_div:"event_list"},needLogin:!0},goPurchaseBenefitList:{url:a.eventSaunUrl,needLogin:!0},goTalkAdvice:{url:a.talkUrl,needLogin:!0},goMembership:{url:a.gdBenefitUrl,needLogin:!1},goMyLotte:{url:a.mylotteUrl,needLogin:!1},goCart:{url:a.cateLstUrl,needLogin:!1},goRecently:{url:a.lateProdUrl,needLogin:!1},goMallMimitoutou:{url:a.petMallMainUrl,needLogin:!1},goMallSpecialTasty:{url:a.specialMallUrl,param:{dispNo:"5558814"},needLogin:!1},goMallStyleshop:{url:a.styleShopMainUrl,param:{dispNo:"5550415"},needLogin:!1},goMallLottebrand:{url:a.specialMallUrl,param:{dispNo:"5553048"},needLogin:!1},goMallKshop:{url:a.specialMallUrl,param:{dispNo:"5535841"},needLogin:!1},goMallScalp:{url:a.specialMallUrl,param:{dispNo:"5569995"},needLogin:!1},goMallTVoutlet:{url:a.specialMallUrl,param:{dispNo:"5565610"},needLogin:!1},goMallBook:{url:a.bookshopUrl,needLogin:!1},goMallTenbyten:{url:a.tenbytenUrl,needLogin:!1},goMallVine:{url:a.vineUrl,needLogin:!1},goMain:{url:a.mainUrl,needLogin:!1},goMainBest:{url:a.mainUrl,param:{dispNo:"5572537"},needLogin:!1},goMainGift:{url:a.mainUrl,param:{dispNo:"5570117"},needLogin:!1},goMainEvent:{url:a.mainUrl,param:{dispNo:"5570119"},needLogin:!1},goDirectAttend:{url:a.directAttendUrl,needLogin:!1},goPurchaseBenefit:{url:a.eventSaunListUrl,needLogin:!1}};g.go=function(j,k){if(i[j]&&i[j].url){var l="";if(l=i[j].url+"?"+c.getBaseParam(),i[j].param&&b.forEach(i[j].param,function(a,b){l+="&"+b+"="+a}),i[j].needLogin&&!k)-1==(l+"").indexOf("http")&&(l=e.protocol()+"://"+e.host()+l),l=a.loginForm+"?"+c.getBaseParam()+"&targetUrl="+encodeURIComponent(l);else if("goLogin"==j)return void g.goLogin();f(function(){d.location.href=l},h)}},g.goLogin=function(b){var e=a.voiceCommerceUrl+"?"+c.getBaseParam();e+=b?"&lastCommand="+b:"&isLogin=Y",f(function(){d.location.href=a.loginForm+"?"+c.getBaseParam()+"&targetUrl="+encodeURIComponent(e)},h)},g.goPrdDetail=function(b){var e="5607666",g="17";if(b){var i=a.productviewUrl+"?"+c.getBaseParam()+"&goods_no="+b+"&curDispNo="+e+"&curDispNoSctCd="+g;f(function(){d.location.href=i},h)}},g.goMain=function(){var b=a.mainUrl+"?"+c.getBaseParam();f(function(){d.location.href=b},h)},g.goCart=function(){var b=a.cartLstUrl+"?"+c.getBaseParam();f(function(){d.location.href=b},h)},g.voiceUnableOrder=function(b){return b?void f(function(){d.location.href=a.orderFormUrl+"?"+c.getBaseParam()+"&cartSn="+b},h):!1}}]),d.service("VCAppApi",["LotteAppChk","$window","VCPageMove","$timeout","$interval",function(a,b,c,d,e){function f(c){a.appObj.isAndroid?b.location.href=c:(i.push(c),k||(k=e(g,j)))}function g(){if(!h.isEnable)return!1;if(i.length<=0&&k)e.cancel(k),k=null;else{var a=i.pop();b.location.href=a}}var h=this,i=[],j=200,k=null;h.isEnable=!1,a.appObj.isApp&&(a.appObj.isAndroid&&a.appObj.verNumber>400||a.appObj.isIOS&&a.appObj.verNumber>4e3)&&(h.isEnable=!0),h.getSilentMode=function(){return console.log("talkshop://getSilentMode",h.isEnable),h.isEnable?void f("talkshop://getSilentMode"):!1},h.activatedSpeaker=function(a){var b=a?"Y":"N";return console.log("talkshop://activatedSpeaker?sound="+b),h.isEnable?void f("talkshop://activatedSpeaker?sound="+b):!1},h.hideHeader=function(){return console.log("talkshop://hideHeader"),h.isEnable?void(a.appObj.isIOS&&f("talkshop://hideHeader")):!1},h.exit=function(){if(console.log("talkshop://endTalk"),h.isEnable&&navigator.userAgent.indexOf("mlotte001")>-1)try{b.location.href="talkshop://endTalk"}catch(a){c.go("goMain")}else c.go("goMain")},h.startTTS=function(a){return console.log("talkshop://startTTS?text="+a),h.isEnable&&a?void f("talkshop://startTTS?text="+a):!1},h.stopTTS=function(){return console.log("talkshop://stopTTS"),h.isEnable?void f("talkshop://stopTTS"):!1},h.startSTT=function(a){l=!0;return console.log("talkshop://startSTT?sound="+a),h.isEnable?void f("talkshop://startSTT?sound="+a):!1},h.stopSTT=function(a){l=!1;return console.log("talkshop://stopSTT?sound="+a),h.isEnable?void f("talkshop://stopSTT?sound="+a):!1};var l=!1;h.isSilentModeCallbackFunc=function(){},h.setIsSilentModeCallback=function(a){"function"==typeof a&&(h.isSilentModeCallbackFunc=a)},h.BackKeyCallbackFunc=function(){},h.setBackKeyCallback=function(a){"function"==typeof a&&(h.BackKeyCallbackFunc=a)},h.TTSEndCallbackFunc=function(){},h.setTTSEndCallback=function(a){"function"==typeof a&&(h.TTSEndCallbackFunc=a)},h.STTTextCallbackFunc=function(){},h.setSTTTextCallback=function(a){"function"==typeof a&&(h.STTTextCallbackFunc=a)},h.STTTEndCallbackFunc=function(){},h.setSTTEndCallback=function(a){"function"==typeof a&&(h.STTTEndCallbackFunc=a)},b.isSilentMode=function(a){console.log("[APP] isSilentMode",a),h.isSilentModeCallbackFunc(a)},b.backKeyClicked=function(){console.log("[APP] backKeyClicked"),h.BackKeyCallbackFunc()},b.ttsEndCallback=function(){console.log("[APP] ttsEndCallback"),h.TTSEndCallbackFunc()};var m=null,n="",o=600;b.setSTTText=function(a){console.log("[APP] setSTTText",a),n=a,h.STTTextCallbackFunc(n)},b.sttEndCallback=function(a){if(l){m&&d.cancel(m);var b=getScope();m=d(function(){b.isValidString(n)?h.STTTEndCallbackFunc(n):b.isValidString(a)?h.STTTEndCallbackFunc(a):"mic"==b.pageUI.inputMode&&b.actionInput(null,"keepMic"),console.log("[APP] sttEndCallback",a,n),n=""},o)}}}]),d.service("VDShareApp",["LotteAppChk","$window",function(c,d){var e=this;e.shareDataSet=function(c){c||(c={}),console.log("obj",c);var d={goodsNo:c.goodsNo,goodsNm:c.goodsNm,shareUrl:location.protocol+"//"+location.hostname+"/product/m/product_view.do",noCdnUrl:"",shareImg:"http://image.lotte.com/lotte/mobile/common/share_img_common.jpg",urlParam:{},shareTitle:"[롯데닷컴 이거어때?]\n",kakaoTitle:"[롯데닷컴]"};return a.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,b,c){d.urlParam[b]=c}),b.isDefined(c.shareImg)&&(d.shareImg=c.shareImg),d.noCdnUrl=d.shareUrl+"?goods_no="+d.goodsNo+"&cn=123624",d},e.sendAppShare=function(a,b){var c=e.shareDataSet(a),d="";console.log("shareData",c);var f="2929723",g="2929720",h="2929722",i="2929725",j="2929721",k="2929719";switch(b){case"sms":d=c.noCdnUrl+"&cdn="+i;break;case"kakaotalk":d=c.noCdnUrl+"&cdn="+f;break;case"kakaostory":d=c.noCdnUrl+"&cdn="+h;break;case"facebook":d=c.noCdnUrl+"&cdn="+j;break;case"twitter":d=c.noCdnUrl+"&cdn="+g;break;case"url_copy":d=c.noCdnUrl+"&cdn="+k;break;case"url_copy_voice":d=c.noCdnUrl+"&cdn="+k}if("kakaotalk"!=b)var l={url:d,title:e.getShareTitle(c.shareTitle,c.goodsNm).replace(/#/gi,""),imageUrl:c.shareImg};else{var l={type:"default",title:c.kakaoTitle,imageUrl:c.shareImg,url:d,buttons:[{title:"바로가기",url:d}]};"kakaotalk"==b?l.desc=(c.goodsNm+"").replace(/#/gi,""):l.desc=e.getShareTitle(c.shareTitle,c.goodsNm).replace(/#/gi,"")}e.shareAppCall(b,l)},e.getShareTitle=function(a,b){var c=a+b;try{c=c.replace("[[","["),c=c.replace("]]","]")}catch(d){console.log("shareTitle replace err")}return c},e.shareAppCall=function(a,b){console.info(a),console.info(b),c.appObj.isAndroid?d.lotteshare.callAndroid("lotteshare://"+a+"/query?"+JSON.stringify(b)):c.appObj.isIOS&&(d.location="lotteshare://"+a+"/query?"+JSON.stringify(b))}}]),d.service("VCMsgData",[function(){var a=this;a.getMsgData=function(a,b,c){return{txt:a,voice:b,position:c}},a.msg={unknown:{txt:"잘 이해하지 못했어요ㅠㅠ",voice:"잘,2해하지 못해써요",position:"q"},unknownHome:{txt:"잘 이해하지 못했어요ㅠㅠ",voice:"잘,2해하지 못해써요",position:"home"},nowLogin:{txt:"이미 로그인 상태에요.",voice:"이미 로그인 상태에요.",position:"q"},needLogin:{txt:"로그인이 필요해요.",voice:"로그인이 필요해요.",position:"voice"},needLoginYesNo:{txt:"로그인이 필요해요~ 로그인 하시겠어요?",voice:"로그인이 필요해요~ 로그인 하시겠어요?",position:"q"},bestKeyword:{txt:"인기있는 {} 추천해드려요.",voice:"인기있는 {} 추천해드려요.",position:"top"},prdDataEmpty:{txt:"어쩌죠? 원하시는 상품이 없어요..<br />아래 인기 키워드를 말해보는건 어떠세요?​",voice:"어쩌죠? 원하시는 상품이 없어요.. 아래 인기 키워드를 말해보는건 어떠세요?​",position:"top"},isHome:{txt:"지금 머무르시는 화면이 처음이에요.",voice:"지금 머무르시는 화면이 처음이에요.",position:"q"},homeMore:{txt:"무엇을 더 보여드릴까요?",voice:"무엇을 더 보여드릴까요?",position:"q"},prdListEnd:{txt:"지금 보시는 상품이 마지막이에요~",voice:"지금 보시는 상품이 마지막이에요~",position:"voice"},notVoiceOrder:{txt:"죄송해요. 직접 터치해서 주문해주세요.",voice:"죄송해요. 직접 터치해서 주문해주세요.",position:"voice"},notMobileOrder:{txt:"죄송해요, PC에서 주문해주세요~",voice:"죄송해요, PC에서 주문해주세요~",position:"voice"},notVoiceWish:{txt:"죄송해요. 직접 터치해서 위시리스트에 담아주세요.",voice:"죄송해요. 직접 터치해서 위시리스트에 담아주세요.",position:"voice"},notVoiceCart:{txt:"죄송해요. 터치해서 찜해주세요.",voice:"죄송해요. 터치해서 찜해주세요.",position:"voice"},notSimpleMemberCartWish:{txt:"죄송해요. 엘포인트 통합회원만 구매 가능해요.",voice:"죄송해요. 엘포인트 통합회원만 구매 가능해요.",position:"q"},prdComment:{txt:"상품평 보여드릴게요~",voice:"상품평 보여드릴게요~",position:"q"},notPrdComment:{txt:"상품평이 없는 상품이에요~",voice:"상품평이 없는 상품이에요~",position:"q"},notPrdOption:{txt:"옵션이 없어요.",voice:"옵션이 없어요.",position:"q"},prdOptShow:{txt:"옵션을 보여드릴까요?",voice:"옵션을 보여드릴까요?",position:"q"},prdDeliveryFree:{txt:"무료배송이에요~",voice:"무료배송이에요~",position:"q"},prdDeliveryCharge:{txt:"배송비는 {}원이고, {}원 이상 무료배송이에요~",voice:"배송비는 {}원이고, {}원 이상 무료배송이에요~",position:"q"},prdDeliveryDateSmart:{txt:"{}에서 픽업하는 상품입니다",voice:"{}에서 픽업하는 상품입니다",position:"q"},prdDeliveryDateRese:{txt:"지금 주문하시면 {} {} 되어요",voice:"지금 주문하시면? {} {} 되어요",position:"q"},prdDeliveryDateSet:{txt:"{}해 드려요",voice:"{}해 드려요",position:"q"},prdDeliveryDateRental:{txt:"{}드려요",voice:"{}드려요",position:"q"},prdDeliveryDate:{txt:"지금 주문하시면 {} {}이에요",voice:"지금 주문하시면? {} {}이에요",position:"q"},prdDeliveryDateCou:{txt:"{} 가능해요",voice:"{} 가능해요",position:"q"},prdDeliveryHolidayDate:{txt:"명절 기간으로 택배사별로 배송일이 달라요~",voice:"명절 기간으로 택배사별로 배송일이 달라요~",position:"q"},prdPrev:{txt:"이전 20개 상품 보여드릴게요~",voice:"이전 20개 상품 보여드릴게요~",position:"top"},prdNext:{txt:"다음 {}개 상품 보여드릴게요~",voice:"다음 {}개 상품 보여드릴게요~",position:"top"},alreadyWish:{txt:"이미 담은 상품이에요.",voice:"이미 담은 상품이에요.",position:"voice"},getWish:{txt:"위시리스트에 담았어요.",voice:"위시리스트에 담았어요.",position:"voice"},cartShow:{txt:"장바구니에 {}개의 상품이 있어요. 20개씩 보여드릴게요.",voice:"장바구니에 {}개의 상품이 있어요. 20개씩 보여드릴게요.",position:"top"},cartShowUnder:{txt:"장바구니에 {}개의 상품이 있어요.",voice:"장바구니에 {}개의 상품이 있어요.",position:"top"},cartNone:{txt:"아직 찜한 상품이 없네요. 새로 담아보세요!",voice:"아직 찜한 상품이 없네요. 새로 담아보세요!",position:"home"},wishShow:{txt:"위시리스트에 {}개의 상품이 있어요. 20개씩 보여드릴게요.",voice:"위시리스트에 {}개의 상품이 있어요. 20개씩 보여드릴게요.",position:"top"},wishShowUnder:{txt:"위시리스트에 {}개의 상품이 있어요.",voice:"위시리스트에 {}개의 상품이 있어요.",position:"top"},wishNone:{txt:"아직 담은 상품이 없네요. 새로 담아보세요!",voice:"아직 담은 상품이 없네요. 새로 담아보세요!",position:"home"},priceQuest:{txt:"원하는 가격대가 있으면 말해주세요.",voice:"원하는 가격대가 있으면 말해주세요.",position:"q"},helpQuest:{txt:'도움이 필요하시면 "도와줘!" 라고 말해보세요.',voice:'도움이 필요하시면 "도와줘!" 라고 말해보세요.',position:"q"},urlCopy:{txt:"url 복사",voice:"url 복사",position:"voice"},chkInventory:{txt:"{} {}부터 구매가능한 상품이에요~",voice:"{} {}부터 구매가능한 상품이에요~",position:"q"},notInventory:{txt:"죄송해요. 재고가 부족해요~",voice:"죄송해요. 재고가 부족해요~",position:"q"},orderDecide:{txt:"선택하신 상품의 주문내역이에요.",voice:"결제를 진행할까요?",position:"top"},orderDecideDiscount:{txt:"{}원이 할인된 {}원에 결제 하실 수 있어요. 결제를 진행할까요?",voice:"결제를 진행할까요?",position:"top"},orderDecideHelp:{txt:'"응,아니"라고 말해보세요',voice:"응, 아니 라고 말해보세요",position:"q"},orderProgress:{txt:'"직접 터치해서 결제 진행해주세요?',voice:"직접 터치해서 결제 진행해주세요?",position:"voice"},changeMyInfo:{txt:"변경 버튼을 눌러주세요",voice:"변경 버튼을 눌러주세요",position:"voice"},regiMydlvpPay:{txt:"배송지와 결제수단을 먼저 등록해주세요",voice:"배송지와 결제수단을 먼저 등록해주세요",position:"voice"},regiMydlvp:{txt:"배송지를 먼저 등록해주세요",voice:"배송지를 먼저 등록해주세요",position:"voice"},regiMypay:{txt:"결제수단을 먼저 등록해주세요",voice:"결제수단을 먼저 등록해주세요",position:"voice"},ispCancel:{txt:"ISP 결제가 취소되었습니다",voice:"ISP 결제가 취소되었습니다",position:"q"},errMinLmtQty:{txt:"최소 {}개부터 구매 가능한 상품입니다.",voice:"최소 {}개부터 구매 가능한 상품입니다.",position:"q"},errMxnLmtQty:{txt:"최대 {}개까지 구매 가능한 상품입니다.",voice:"최대 {}개까지 구매 가능한 상품입니다.",position:"q"}}}]),d.service("VCDevMode",[function(){var a=this;a.DEV_COMMAND=[{name:"talk",command:"talk",data:{homeScreenMent:"일상대화 테스트"}},{name:"goLogin",command:"goLogin"},{name:"goChangePayment",command:"goChangePayment"},{name:"goChangeDelivery",command:"goChangeDelivery"},{name:"goPurchaseList",command:"goPurchaseList"},{name:"goCoupon",command:"goCoupon"},{name:"goPoint",command:"goPoint"},{name:"goCart",command:"goCart"},{name:"goWish",command:"goWish"},{name:"goMyLotte",command:"goMyLotte"},{name:"goEvent",command:"goEvent"},{name:"goPurchaseBenefitList",command:"goPurchaseBenefitList"},{name:"goMembership",command:"goMembership"},{name:"goRecently",command:"goRecently"},{name:"goMallMimitoutou",command:"goMallMimitoutou"},{name:"goMallSpecialTasty",command:"goMallSpecialTasty"},{name:"goMallStyleshop",command:"goMallStyleshop"},{name:"goMallLottebrand",command:"goMallLottebrand"},{name:"goMallKshop",command:"goMallKshop"},{name:"goMallScalp",command:"goMallScalp"},{name:"goMallTVoutlet",command:"goMallTVoutlet"},{name:"goMallBook",command:"goMallBook"},{name:"goMallTenbyten",command:"goMallTenbyten"},{name:"goMallVine",command:"goMallVine"},{name:"goMain",command:"goMain"},{name:"goMainBest",command:"goMainBest"},{name:"goMainGift",command:"goMainGift"},{name:"goMainEvent",command:"goMainEvent"},{name:"goLuckybox",command:"goLuckybox"},{name:"goDirectAttend",command:"goDirectAttend"},{name:"goPurchaseBenefit",command:"goPurchaseBenefit"},{name:"goTalkAdvice",command:"goTalkAdvice"},{name:"actionHelp",command:"actionHelp"},{name:"actionChangeMyInfo",command:"actionChangeMyInfo"},{name:"actionBack",command:"actionBack"},{name:"actionMore",command:"actionMore"},{name:"actionFirst",command:"actionFirst"},{name:"actionUp",command:"actionUp"},{name:"actionDown",command:"actionDown"},{name:"actionClose",command:"actionClose"},{name:"actionUnknown",command:"actionUnknown"},{name:"actionOrder",command:"actionOrder"},{name:"actionDetail",command:"actionDetail"},{name:"actionAddWish",command:"actionAddWish"},{name:"actionAddCart",command:"actionAddCart"},{name:"actionShare",command:"actionShare"},{name:"actionShareKakao",command:"actionShareKakao"},{name:"actionShareKaKaoStory",command:"actionShareKaKaoStory"},{name:"actionShareTwitter",command:"actionShareTwitter"},{name:"actionShareSMS",command:"actionShareSMS"},{name:"actionShareFacebook",command:"actionShareFacebook"},{name:"actionShareURL",command:"actionShareURL"},{name:"actionProdImg",command:"actionProdImg"},{name:"actionProdComment",command:"actionProdComment"},{name:"actionProdOptShow",command:"actionProdOptShow"},{name:"actionProdOptChange",command:"actionProdOptChange"},{name:"answerDeliveryFee",command:"answerDeliveryFee"},{name:"answerDeliveryTime",command:"answerDeliveryTime"},{name:"actionYesNo",command:"actionYesNo",data:{commandVal:"yes"}},{name:"actionNumber",command:"actionNumber",data:{commandNumber:1}},{name:"getCart",command:"getCart"},{name:"getWish",command:"getWish"},{name:"getRecom",command:"getRecom",data:{goodsNoList:"1234,444",topScreenMent:"aaaa",preReqParam:"&talk_id=2&keyword=%EB%82%98%EC%9D%B4%ED%82%A4+%EC%97%AC%EC%84%B1"}}]}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","voiceCommerceService","angular-carousel"]);d.controller("VoiceCommerceHeaderCtrl",["$scope","LotteCommon","commInitData","VCAppApi","LotteAppChk",function(a,b,c,d,e){a.toggleSound=function(b){a.pageUI.app.soundFlag=b,d.activatedSpeaker(a.pageUI.app.soundFlag),b?a.setGATag("공통_상단영역","소리_ON",null,"click"):a.setGATag("공통_상단영역","소리_OFF",null,"click")},a.toggleHelp=function(b){a.VCCtrl.commandExec("actionHelp",null,null,"click")},a.exit=function(b){"btn"==b&&a.setGATag("공통_상단영역","닫기",null,"click"),d.exit()}}]),d.directive("voiceHeader",[function(){return{templateUrl:"/lotte/resources_dev/talk/voiceCommerce_header.html",replace:!0,controller:"VoiceCommerceHeaderCtrl",link:function(a,b,c){}}}]),d.controller("VoiceCommerceSideNavCtrl",["$scope","$window","LotteCommon","commInitData","LotteUserService","VCBasicInfo","VCOrder","LotteStorage","$timeout",function(a,c,d,e,f,g,h,i,j){function k(b){var c=null;a.loginInfo.isLogin&&a.loginInfo.mbrNo&&(c=a.loginInfo.mbrNo),a.pageLoading=!0,g.getBasicInfo(c).then(function(b){a.pageLoading=!1,a.basicInfo=b,"40"==a.basicInfo.member_info.pay_mean_cd&&(h.initLpay(),h.authLpayMerchant(a.basicInfo.member_info.onlCno,function(b){b?h.getLpayPaymentInfo(a.basicInfo.member_info.pay_card_rcgn_id,function(b){b?(a.basicInfo.member_info.fnCoNm=b.fnCoNm,a.basicInfo.member_info.pmtMthdAlias=b.pmtMthdAlias):(console.error("결제 수단 확인 실패"),a.basicInfo.member_info.base_op_pay_chk=!1)}):(console.error("Lpay 인증 실패"),a.basicInfo.member_info.base_op_pay_chk=!1);
}))})["catch"](function(b){a.basicInfo=g.initBasicInfo()})["finally"](function(){a.pageLoading=!1}),"Y"!=i.getSessionStorage(a.EVT_TXT_SESSIONSTORAGE_FLAG)?(a.pageLoading=!0,g.getEvtTxt().then(function(b){a.pageUI.evtTxt=b,"home"==a.pageUI.state&&(a.pageUI.evtTxtShowFlag=!0)})["catch"](function(){})["finally"](function(){a.pageLoading=!1})):a.pageUI.evtTxtShowFlag=!1,i.setSessionStorage(a.EVT_TXT_SESSIONSTORAGE_FLAG,"Y"),a.pageLoading=!0,g.getBgDeco().then(function(b){a.isValidString(b)&&(a.pageUI.bgDecoStyle="background-image:url("+b+")")})["catch"](function(){})["finally"](function(){a.pageLoading=!1})}a.basicInfo=g.initBasicInfo(),a.SemanticHistory=g.getSemanticeHistory(),a.EVT_TXT_IONSTORAGE_FLAG="vcEvtTxtHideFlag",a.toggleSideNav=function(c){a.pageUI.evtTxtShowFlag&&a.hideEvtTxt(),a.pageUI.sideNavOpenFlag=c,b.element("#myinfoWrap").scrollTop(0),c?a.setGATag("공통_상단영역","햄버거",null,"click"):a.setGATag("햄버거_공통","닫기",null,"click")},a.toggleSideNavGuide=function(c,d){a.pageUI.sideNavGuideOpenFlag=c,b.element("#guideWrap").scrollTop(0),c?a.setGATag("햄버거_가이드","전체보기",null,"click"):"back"==d?a.setGATag("햄버거_가이드","뒤로",null,"click"):a.setGATag("햄버거_가이드","닫기",null,"click")},f.promiseLoginInfo()["finally"](function(a){j(function(){k(a)},100)}),a.hideEvtTxt=function(){a.setGATag("햄버거이벤트","햄버거이벤트",null,"click"),a.pageUI.evtTxtShowFlag&&(a.pageUI.evtTxtShowFlag=!1,i.setSessionStorage(a.EVT_TXT_SESSIONSTORAGE_FLAG,"Y"))},a.sendHistory=function(b){a.sendSemantic("click",b.replace(/\"/gi,""),!0),a.setGATag("햄버거_히스토리","클릭",null,"click"),a.pageUI.sideNavOpenFlag=!1}}]),d.directive("voiceNav",["VCPageMove","$window",function(a,c){return{templateUrl:"/lotte/resources_dev/talk/voiceCommerce_sidenav.html",replace:!0,controller:"VoiceCommerceSideNavCtrl",link:function(d,e,f,g){d.speechBoxTabIdx=0,d.voiceInfoLayer=!1,d.voiceNavVCPageMove=function(b){"goChangeDelivery"==b?1==d.basicInfo.member_info.et_mbr_dlvp_chk?d.setGATag("햄버거_등록변경","배송지",null,"click"):d.setGATag("햄버거_등록","배송지",null,"click"):"goChangePayment"==b&&(1==d.basicInfo.member_info.base_op_pay_chk?d.setGATag("햄버거_등록변경","결제수단",null,"click"):d.setGATag("햄버거_등록","결제수단",null,"click")),a.go(b,d.loginInfo.isLogin)},d.samandaListController=null,d.getSamadaListControl=function(a){d.samandaListController=a},d.samadaListSwiperEnd=function(a){d.speechBoxTabIdx=a,d.setGATag("햄버거_가이드","탭이동",null,"click")},d.speechBoxTabSelect=function(a){d.samandaListController.moveIndex(a)},d.toggleVoiceInfoLayer=function(a){d.voiceInfoLayer=!d.voiceInfoLayer,d.voiceInfoLayer?(b.element(c).on("click.voiceInfoLayer",function(){b.element(c).off("click.voiceInfoLayer"),d.toggleVoiceInfoLayer()}),d.setGATag("햄버거_공통","인포",null,"click")):b.element(c).off("click.voiceInfoLayer"),a&&a.stopPropagation()},d.infoLayerClick=function(a){a.stopPropagation()},b.element(".myinfo_side_wrap .guide_wrap").on("scroll touchmove mousewheel",function(){d.setGATag("햄버거_가이드","스크롤",null,"click")})}}}]),d.controller("VoiceCommerceCtrl",["$scope","commInitData","VCDevMode","VCBasicInfo","$timeout","VCMsgData","VCAppApi","LotteGA","LotteCommon","$window","LotteStorage","$location",function(a,c,d,e,f,g,h,i,j,k,l,m){a.showWrap=!0,a.contVisible=!0,a.pageLoading=!0,a.pageUI={referrerUrl:null,curDispNo:"5607666",curDispNoSctCd:"17",state:"home",stateHistory:[{state:"home",msgTop:""}],semanticFlag:!1,voiceGuideInfo:[],curVoiceGuideIdx:0,evtTxtShowFlag:!1,evtTxt:"",sideNavOpenFlag:!1,sideNavGuideOpenFlag:!1,showHotKeyword:!1,hotKeyword:[],showShare:!1,showMsg:{guide:!0,home:!1,top:!1,q:!1},msg:{home:"",top:"",q:""},showHelp:!1,showAlert:!1,alertType:"",showPrdImgDetail:!1,showPrdComment:!1,showPrdOpt:!1,showPrd10:!1,showPrd20:!1,showPrdEnd:!1,showOrder:!1,app:{nowTTS:!1,mowSTT:!1,soundFlag:!1},inputMode:"",lastInputMode:"",activeVoice:!1,inputTxt:"",micVoiceTxt:"듣고 있어요",appSchemaDelay:300,curPrdSwiperIdx:0,curPage:1,cartCnt:0,wishCnt:0,prdList:null,preReqParam:null,preReqParamObj:null,curPrdInfo:null,curPrdDetailInfo:null,rowsPerPage:20,prodImgInfo:[],optInfo:{isOpt:!1,optType:"",goodsNo:null,prdOptStepCnt:0,prdOptInfo:[],prdOptList:[],curOptValArr:[],selectedOptItemInfo:null,selectedOptItemNo:null,curOptStep:0,curLayerOptValArr:[],optSelectDelayTime:1e3},orderInfo:{cart_sn:null,deliver_info:null,discount_amt:0,discount_list:null,goods_list:null,pay_info:null,total_amt:0,total_price:0,total_deli_amt:0,orderCnt:0,termLayerFlag:!1},orderCompleteInfo:{goods_list:null,deliver_info:null,total_amt:0,discount_amt:0,total_price:0,send_due_code:null,send_due_date:null,send_due_month:null,send_due_day:null,send_due_week:null,ord_no:null},helpInfo:[],prodComment:[],prodCommentPageIndex:1,prodCommentAjaxLoadFlag:!1,prodCommentLastPage:!1,starScoreOpen:!0,customerSatisOpen:!0,devCommand:d.DEV_COMMAND,jsonLoading:!1,isChangeCommandState:!0,curPrdHtmlInfo:{},bgDecoStyle:"",devMode:!1,testMode:!1},a.orderDecideYesNoTimer=null,a.coachMarkVisibility=!1,"Y"!=l.getLocalStorage("vcCoachMark")&&(a.coachMarkVisibility=!0),a.hideCoachMark=function(){l.setLocalStorage("vcCoachMark","Y"),a.coachMarkVisibility=!1},a.setGATag=function(b,c,d,e,f){var g=a.appObj.isApp?"APP_샬롯_":"MO_샬롯_",h=b?b:"",j=c?c:"",k=d?d:"-",l=null;if(f)g+=f;else switch(a.pageUI.state){case"home":g+="홈";break;case"prod_list":g+="상품리스트";break;case"prod_detail":g+="상품상세";break;case"wish":g+="위시리스트";break;case"cart":g+="장바구니";break;case"order":g+="주문확정";break;case"order_complete":g+="주문완료";break;default:g+="홈"}switch(e){case"mic":l="음성";break;case"click":l="터치";break;case"keyboard":l="키패드"}i.evtTag(g,h,j,k,l)};var n=document.referrer;"localhost"==m.host()&&(n="http://"+m.host()+(m.port()?":"+m.port():"")+"/main/main_2018_dev.html?udid=&v=&cn=&cdn=&schema="),n&&-1==(n+"").indexOf(j.talkShopPayment)&&-1==(n+"").indexOf(j.talkShopDelevery)&&-1==(n+"").indexOf(j.voiceCommerceUrl)&&(a.pageUI.referrerUrl=n);var o="vcSession",p=a.appObj.isAndroid?"unload":"pagehide";if(b.element(k).on(p,function(){l.setSessionStorage(o,a.pageUI,"json")}),a.isSessionChk=!1,n&&(n+"").indexOf(j.talkShopPayment)>-1||(n+"").indexOf(j.talkShopDelevery)>-1||c.query&&c.query.lastCommand&&(n+"").indexOf(j.loginForm)>-1||c.query&&"Y"==c.query.isLogin&&(n+"").indexOf(j.loginForm)>-1||c.query&&"Y"==c.query.isp||history.state&&"voiceCommerce"==history.state.name){var q=l.getSessionStorage(o,"json");q&&(console.log("세션스토리지 복원시점",q),a.pageUI=q,a.isSessionChk=!0,a.pageUI.showMsg.q=!1)}else"Y"==l.getSessionStorage("vcLastCommandFlag")&&l.setSessionStorage("vcLastCommandFlag","N"),(null==history.state||"voiceCommerce"!=history.state.name)&&history.replaceState({name:"voiceCommerce"},"voiceCommerce")}]),d.controller("LotteContainerCtrl",["$scope","$window","$timeout","LotteCommon","VCPageMove","VCAppApi","VCGetPrdInfo","LotteCookie","VCGetPrdDetailInfo","VCHelpInfo","VCGetPrdOption","VCMsgData","VCGetProdComment","VCGetPrdQty","VCGetOrderDecide","VCOrder","VCOrderComplete","commInitData","VDShareApp","VCAddCart","VCAddWish","VCDeliveryInfo","$filter","VCHotKeywordInfo","VCStartVoiceInfo","$interval","$http","LotteUtil","LotteStorage","VCUpdateCart",function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){function F(){"home"==a.pageUI.state?a.pageUI.showMsg.top=!1:a.pageUI.showMsg.top=!0,a.pageUI.showMsg.home=!1}function G(){if(a.pageUI.sideNavOpenFlag||a.pageUI.sideNavGuideOpenFlag||a.pageUI.showShare||a.pageUI.showHelp||a.pageUI.showPrdImgDetail||a.pageUI.showPrdComment||a.pageUI.showOrder)a.pageUI.sideNavOpenFlag=!1,a.pageUI.sideNavGuideOpenFlag=!1,a.pageUI.showShare=!1,a.pageUI.showHelp=!1,a.pageUI.showPrdImgDetail=!1,a.pageUI.showPrdComment=!1,a.pageUI.showOrder=!1;else if(a.pageUI.showPrdOpt)0!=a.pageUI.optInfo.curOptStep?(a.pageUI.optInfo.curOptStep--,a.pageUI.optInfo.curLayerOptValArr.pop()):a.pageUI.showPrdOpt=!1;else if("mic"==a.pageUI.inputMode)a.pageUI.inputMode="",g.stopSTT();else if(a.pageUI.showMsg.q)a.pageUI.showMsg.q=!1,d.cancel(X),X=null;else if("home"==a.pageUI.state)g.exit();else if("order_complete"==a.pageUI.state){var b=a.pageUI.stateHistory.length-1;for(b;b>=0&&"home"!=a.pageUI.stateHistory[b].state;b--)a.pageUI.stateHistory.pop();R.stateHistoryBack(!0)}else if("prod_list"==a.pageUI.state||"wish"==a.pageUI.state||"cart"==a.pageUI.state){var b=a.pageUI.stateHistory.length-1;for(b;b>=0&&"home"!=a.pageUI.stateHistory[b].state;b--)a.pageUI.stateHistory.pop();R.stateHistoryBack(!0)}else"order"==a.pageUI.state?R.stateHistoryBack():R.stateHistoryBack()}function H(){var a=b.element(".voice_mic .mic_guide:visible");if(0!=a.length){var c=a.height(),d=a.parent().height(),e=Math.round((d-c)/2);a.css("top",e)}}function I(){a.pageUI.curVoiceGuideIdx>=a.pageUI.voiceGuideInfo.length-1?a.pageUI.curVoiceGuideIdx=0:a.pageUI.curVoiceGuideIdx++}function J(){a.pageUI.showMsg.guide&&""==a.pageUI.inputMode&&(a.voiceGuideActive?T==U&&(T=0,a.voiceGuideActive=!a.voiceGuideActive,a.voiceGuideActive||d(I,500)):a.voiceGuideActive=!a.voiceGuideActive,T++)}function K(){a.pageUI.showOrder=!0;var c=q.getOrderUrl(a.pageUI.orderInfo.cart_sn,a.pageUI.orderInfo.goods_list.goods_no);b.element("#ordIframe").prop("src",c)}function L(){a.pageUI.helpInfo.length>1?(a.iptGuideHideIdx=a.iptGuideActiveIdx,a.iptGuideActiveIdx<a.pageUI.helpInfo.length-1?a.iptGuideActiveIdx++:a.iptGuideActiveIdx=0):(a.iptGuideActiveIdx=0,a.iptGuideHideIdx=-1)}function M(){V&&(A.cancel(V),V=null),V=A(L,W)}function N(){b.element(c).off(".qMsg").on("touchstart.qMsg",function(e){b.element(c).off(".qMsg"),a.pageUI.showMsg.q=!1,X&&(d.cancel(X),X=null)})}function O(){var b=a.loginInfo.isLogin&&a.basicInfo.member_info.et_mbr_dlvp_chk&&a.basicInfo.member_info.base_op_pay_chk;return b||(a.basicInfo.member_info.et_mbr_dlvp_chk||a.basicInfo.member_info.base_op_pay_chk?a.basicInfo.member_info.et_mbr_dlvp_chk?a.basicInfo.member_info.base_op_pay_chk||R.showMsg(m.msg.regiMypay):R.showMsg(m.msg.regiMydlvp):R.showMsg(m.msg.regiMydlvpPay),a.toggleSideNav(!0)),b}function P(b){a.pageLoading=!0,E.updateCart({cart_sn:b.cart_sn,ord_qty:a.pageUI.orderInfo.orderCnt,item_no:b.item_no,update_ck:!1,goods_no:b.goods_no,goods_cmps_cd:b.goods_cmps_cd}).then(function(a){f.voiceUnableOrder(b.cart_sn)})["catch"](function(){console.error("장바구니 옵션 업데이트 실패"),a.alert_2016("장바구니 옵션 반영 오류 발생")})["finally"](function(){a.pageLoading=!1})}function Q(){a.isSessionChk||(a.pageLoading=!0,z.getVoiceInfo().then(function(b){a.pageUI.voiceGuideInfo=b,a.pageUI.voiceGuideInfo.length>0&&a.pageUI.voiceGuideInfo[0].guide_cont&&a.VCCtrl.showMsg(m.getMsgData(a.pageUI.voiceGuideInfo[0].guide_cont,a.pageUI.voiceGuideInfo[0].guide_cont,"voice"))})["catch"](function(){console.error("추천 발화가이드 없음")})["finally"](function(){a.pageLoading=!1}),a.voiceGuideActive=!0,a.pageLoading=!0,k.getHelpInfo(a.pageUI.state).then(function(b){a.pageUI.helpInfo=b,console.log("helpInfo",b)})["catch"](function(){console.error("도움말 코너 정보 연동 실패")})["finally"](function(){a.pageLoading=!1})),"home"==a.pageUI.state&&1==a.pageUI.showMsg.guide&&a.startVoiceGuide(),d(M,1e3),("prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state)&&a.prdSwiperCtrl&&a.pageUI.curPrdSwiperIdx>0&&d(function(){try{a.prdSwiperCtrl.moveSpeedIndex(a.pageUI.curPrdSwiperIdx,10),b.element(c).trigger("scroll")}catch(d){console.warn(d)}},500);var e=s.query;if("Y"==e.isp){var f=e.resCode,g=decodeURIComponent(e.resMsg),h=decodeURIComponent(e.ord_no);"9999"==f?a.pageUI.showOrder=!1:a.talkOrderCallBack(f,g,h)}e.lastCommand&&"Y"==D.getSessionStorage("vcLastCommandFlag")&&(D.setSessionStorage("vcLastCommandFlag","N"),d(function(){R.commandExec(e.lastCommand)},500))}var R=this;R.changeState=function(e,f,g){if("home"==e||"prod_list"==e||"prod_detail"==e||"cart"==e||"wish"==e||"order"==e||"order_complete"==e){if(a.pageUI.showHotKeyword=!1,a.pageUI.hotKeyword=[],"home"==a.pageUI.state?f&&f.guideFlag?a.startVoiceGuide():a.stopVoiceGuide():R.allHideLayer(),a.pageUI.state==e)return!1;"home"!=e&&a.hideEvtTxt(),a.orderDecideYesNoTimer&&(d.cancel(a.orderDecideYesNoTimer),a.orderDecideYesNoTimer=null),a.pageUI.state=e,a.pageLoading=!0,k.getHelpInfo(a.pageUI.state).then(function(b){a.pageUI.helpInfo=b,L()})["catch"](function(){console.error("도움말 코너 정보 연동 실패")})["finally"](function(){a.pageLoading=!1}),g||("prod_detail"==e&&(a.pageUI.msg.top=""),a.pageUI.stateHistory.push({state:e,msgTop:a.pageUI.msg.top})),F(),"home"==a.pageUI.state?a.startVoiceGuide():"prod_list"==a.pageUI.state?a.prodListQuantity=-1:"prod_detail"==a.pageUI.state?a.prodListQuantity=-1:"cart"==a.pageUI.state||"wish"==a.pageUI.state||("order"==a.pageUI.state?a.prodListQuantity=-1:"order_complete"==a.pageUI.state),b.element(c).trigger("scroll")}},R.stateHistoryBack=function(c){return("cart"==a.pageUI.state||"wish"==a.pageUI.state)&&a.pageUI.curPage>1?void a.cartWishListPrev():(a.pageUI.stateHistory.length>0&&!c&&a.pageUI.stateHistory.pop(),a.pageUI.stateHistory.length>=0&&(R.changeState(a.pageUI.stateHistory[a.pageUI.stateHistory.length-1].state,null,!0),"home"!=a.pageUI.state&&(a.pageUI.msg.top=a.pageUI.stateHistory[a.pageUI.stateHistory.length-1].msgTop)),void("home"==a.pageUI.state?a.startVoiceGuide():("cart"==a.pageUI.state||"wish"==a.pageUI.state||"prod_list"==a.pageUI.state)&&a.pageUI.curPrdSwiperIdx>-1&&a.prdSwiperCtrl&&(b.element(".prod_list_wrap").css("opacity",0),a.prdSwiperCtrl.init(),d(function(){a.pageUI.curPrdSwiperIdx=a.pageUI.curPrdSwiperIdx,a.prdSwiperCtrl.moveSpeedIndex(a.pageUI.curPrdSwiperIdx,10),b.element(".prod_list_wrap").css("opacity",1)},300))))},R.allHideLayer=function(){a.pageUI.sideNavOpenFlag=!1,a.pageUI.sideNavGuideOpenFlag=!1,a.pageUI.showShare=!1,a.pageUI.showMsg.guide=!1,a.pageUI.showMsg.home=!1,a.pageUI.showMsg.q=!1,a.pageUI.showHelp=!1,a.pageUI.showAlert=!1,a.pageUI.inputMode="",a.pageUI.showPrdImgDetail=!1,a.pageUI.showPrdComment=!1,a.pageUI.showPrdOpt=!1,a.pageUI.showOrder=!1},R.chkShowLayer=function(){var b=!1;return(a.pageUI.sideNavOpenFlag||a.pageUI.sideNavGuideOpenFlag||a.pageUI.showShare||a.pageUI.showHelp||a.pageUI.showPrdImgDetail||a.pageUI.showPrdComment||a.pageUI.showPrdOpt||a.pageUI.showOrder)&&(a.pageUI.sideNavOpenFlag=!1,a.pageUI.sideNavGuideOpenFlag=!1,a.pageUI.showShare=!1,a.pageUI.showHelp=!1,a.pageUI.showPrdImgDetail=!1,a.pageUI.showPrdComment=!1,a.pageUI.showPrdOpt=!1,a.pageUI.showOrder=!1,b=!0),b},R.startAppTTS=function(b){a.pageUI.app.nowTTS=!0,g.startTTS(b)},R.stopAppTTS=function(){a.pageUI.app.nowTTS&&(g.stopTTS(),a.pageUI.app.nowTTS=!1)},R.startAppSTT=function(){a.pageUI.app.nowSTT=!0,g.startSTT(a.pageUI.app.soundFlag)},R.stopAppSTT=function(){a.pageUI.app.nowSTT=!1,g.stopSTT(a.pageUI.app.soundFlag)},g.setIsSilentModeCallback(function(b){a.isSessionChk||(a.pageUI.app.soundFlag=b===!0||"true"==b?!1:!0),Q()}),g.getSilentMode(),g.setBackKeyCallback(G),c.showStateHistoryScope=function(){console.table(a.pageUI.stateHistory)},g.setTTSEndCallback(function(){if(a.pageUI.app.nowTTS=!1,Y&&a.pageUI.showMsg.q&&!a.pageUI.showPrdComment){d.cancel(X),X=null,a.pageUI.showMsg.q=!1,a.pageUI.inputMode="";var b=!1;if(null!=a.viewInfoTemp){switch(a.viewInfoTemp.txt){case m.msg.needLoginYesNo.txt:case m.msg.prdOptShow.txt:case m.msg.orderDecideHelp.txt:b=!0}a.viewInfoTemp.viewMicCheck&&(b=!0),b&&a.actionInput(null)}}}),g.setSTTTextCallback(function(b){a.pageUI.micVoiceTxt=b,a.pageUI.activeVoice=!0}),g.setSTTEndCallback(function(b){a.pageUI.micVoiceTxt=b,a.pageUI.activeVoice=!1,b&&a.sendSemantic("mic",b),d(function(){a.pageUI.app.nowSTT=!1,a.pageUI.micVoiceTxt="듣고 있어요"},1500)}),A(H,50),R.shareDataSet=function(){var a={},b=R.getCurProdInfo();return b&&(a.goodsNo=b.goods_no,a.goodsNm=b.goods_nm,a.shareImg=b.img_url),a};var S=null,T=0,U=10;a.showAlertHide=!1,R.showAlert=function(){a.pageUI.showAlert=!0,d(function(){a.showAlertHide=!0,d(function(){a.pageUI.showAlert=!1,a.showAlertHide=!1},500)},2500)},a.startVoiceGuide=function(){a.pageUI.curVoiceGuideIdx=0,a.voiceGuideActive=!0,a.pageUI.showMsg.guide=!0,S&&A.cancel(S),S=A(J,500)},a.stopVoiceGuide=function(){a.pageUI.showMsg.guide=!1,A.cancel(S)},R.getCurProdInfo=function(){var b=null;return a.pageUI.prdList&&a.pageUI.curPrdSwiperIdx>-1&&(b=a.pageUI.prdList[a.pageUI.curPrdSwiperIdx]),b},R.initProdOpt=function(){a.pageUI.optInfo={isOpt:!1,optType:"",goodsNo:null,prdOptStepCnt:0,prdOptInfo:[],prdOptList:[],curOptValArr:[],selectedOptItemInfo:null,selectedOptItemNo:null,curOptStep:0,curLayerOptValArr:[]}},R.showOpt=function(b){var c=R.getCurProdInfo();"Y"!=c.vic_ord_psb_yn?"prod_list"==a.pageUI.state||"wish"==a.pageUI.state?f.goPrdDetail(c.goods_no):"cart"==a.pageUI.state&&("Y"==c.smp_only_yn||"Y"==c.input_option_yn?f.goCart():(a.pageUI.optInfo.curOptStep=0,a.pageUI.optInfo.curLayerOptValArr=[],R.getOpt(b,!0))):"cart"==a.pageUI.state&&"Y"==c.smpick_yn?f.goCart():(a.pageUI.optInfo.curOptStep=0,a.pageUI.optInfo.curLayerOptValArr=[],R.getOpt(b,!0))},R.getOpt=function(b,c,d,e){R.allHideLayer();var f=R.getCurProdInfo();if(f&&f.goods_no){var g=f.goods_no;b?a.pageUI.optInfo.optType=b:a.pageUI.optInfo.optType="",a.pageUI.optInfo.goodsNo==g?R.prdOptLoadComplete(c,d,e):(a.pageLoading=!0,l.getPrdOptInfo(g).then(function(b){if(a.pageUI.optInfo.isOpt=!1,a.pageUI.optInfo.prdOptStepCnt=0,a.pageUI.optInfo.prdOptInfo=[],a.pageUI.optInfo.prdOptList=[],b){var f=b.optSelectList,h=b.optItems;f&&f.length>0&&h&&h.length>0&&(a.pageUI.optInfo.isOpt=!0,a.pageUI.optInfo.prdOptStepCnt=f.length,a.pageUI.optInfo.prdOptInfo=f,a.pageUI.optInfo.prdOptList=h)}a.pageUI.optInfo.curOptValArr=[],a.pageUI.optInfo.goodsNo=g,R.prdOptLoadComplete(c,d,e)})["catch"](function(){console.log("상품 옵션정보 오류")})["finally"](function(){a.pageLoading=!1}))}else console.log("현재 선택된 상품 번호 없음")},R.chkNowStepOptSoldout=function(){var b=0,c=0,d="",e=a.pageUI.optInfo.curLayerOptValArr.length,f=null,g=R.getCurProdInfo();if(a.pageUI.optInfo.prdOptInfo.length-1<e)return!1;for(b=0;b<a.pageUI.optInfo.curLayerOptValArr.length;b++)d+=a.pageUI.optInfo.curLayerOptValArr[b].item.optValCd+" x ";for(b=0;b<a.pageUI.optInfo.prdOptInfo[e].itemList.items.length;b++)for(f=new RegExp("^"+d+a.pageUI.optInfo.prdOptInfo[e].itemList.items[b].optValCd+"([^0-9]|$)"),a.pageUI.optInfo.prdOptInfo[e].itemList.items[b].isSoldout=!0,c=0;c<a.pageUI.optInfo.prdOptList.length;c++)if(f.exec(a.pageUI.optInfo.prdOptList[c].optValCd+"")){a.pageUI.optInfo.prdOptList[c].invQty>=g.min_lmt_qty?a.pageUI.optInfo.prdOptInfo[e].itemList.items[b].isSoldout=!1:a.pageUI.optInfo.prdOptInfo[e].itemList.items[b].isSoldout=!0;break}},R.prdOptLoadComplete=function(b,c,d){if(a.pageUI.optInfo.prdOptInfo.length>0){if(!a.pageUI.optInfo.curOptValArr||0==a.pageUI.optInfo.curOptValArr.length){R.chkNowStepOptSoldout();var e=R.getCurProdInfo(),f=0,g=0,h=(a.pageUI.optInfo.prdOptList[0].optValCd+"").split(" x ");for(f=0;f<a.pageUI.optInfo.prdOptList.length;f++)if(parseInt(e.min_lmt_qty)<=a.pageUI.optInfo.prdOptList[f].invQty){h=(a.pageUI.optInfo.prdOptList[f].optValCd+"").split(" x ");break}for(f=0;f<a.pageUI.optInfo.prdOptInfo.length;f++)for(g=0;g<a.pageUI.optInfo.prdOptInfo[f].itemList.items.length;g++)if(h[f]==a.pageUI.optInfo.prdOptInfo[f].itemList.items[g].optValCd){a.pageUI.optInfo.curOptValArr.push({name:a.pageUI.optInfo.prdOptInfo[f].optNm,item:a.pageUI.optInfo.prdOptInfo[f].itemList.items[g]});break}R.setSelectedProdOptItemInfo()}b&&(a.pageUI.optInfo.curOptStep=0,a.pageUI.showPrdOpt=!0,R.showMsg(m.getMsgData("원하는 "+a.pageUI.optInfo.prdOptInfo[a.pageUI.optInfo.curOptStep].optNm+" 번호를 말해보세요","원하는 "+a.pageUI.optInfo.prdOptInfo[a.pageUI.optInfo.curOptStep].optNm+" 번호를 말해보세요","q"),null,!0)),d&&R.addCartProgress()}else c?d&&R.addCartProgress():R.showMsg(m.msg.notInventory)},R.chkOpt=function(){var b=R.getCurProdInfo(),c=!1;return b&&"Y"==(b.option_yn+"").toUpperCase()||"Y"==b.input_option_yn?c=!0:(a.pageUI.optInfo.selectedOptItemInfo=null,a.pageUI.optInfo.selectedOptItemNo=0),c},R.setSelectedProdOptItemInfo=function(){var b="",c=0;if(a.pageUI.optInfo.curOptValArr&&a.pageUI.optInfo.curOptValArr.length>0){for(c=0;c<a.pageUI.optInfo.curOptValArr.length;c++)0!=c&&(b+=" x "),b+=a.pageUI.optInfo.curOptValArr[c].item.optValCd;for(c=0;c<a.pageUI.optInfo.prdOptList.length;c++)if(a.pageUI.optInfo.prdOptList[c].optValCd==b){a.pageUI.optInfo.selectedOptItemInfo=a.pageUI.optInfo.prdOptList[c],a.pageUI.optInfo.selectedOptItemNo=a.pageUI.optInfo.prdOptList[c].itemNo;break}}else console.error("선택된 옵션에 대한 매칭 옵션 없음")},R.getProdDetailInfo=function(b){var c=R.getCurProdInfo();console.log("$scope.prodListQuantity : ",a.prodListQuantity),c&&c.goods_no&&("Y"==c.vic_ord_psb_yn?(R.getOpt(!1,!1,!0),a.pageLoading=!0,j.getPrdDetailListInfo(c.goods_no).then(function(b){a.pageUI.curPrdDetailInfo=b,a.pageUI.orderInfo.orderCnt=parseInt(c.min_lmt_qty)>0?parseInt(c.min_lmt_qty):1,R.changeState("prod_detail")})["catch"](function(){console.error("상품상세 정보 없음")})["finally"](function(){a.pageLoading=!1}),a.pageLoading=!1,j.getPrdDetailHtmlInfo(c.goods_no).then(function(b){a.pageUI.curPrdHtmlInfo=b})["catch"](function(){console.error("상품상세 Html 정보 없음")})["finally"](function(){a.pageLoading=!1})):(console.log("음성주문 불가 상품상세 이동"),R.showMsg(m.msg.notVoiceOrder),f.goPrdDetail(c.goods_no)))},R.addCart=function(a){return"default"==a?void(R.chkOpt()?R.getOpt(!1,!1,!1,!0):R.addCartProgress()):void(R.chkOpt()?(console.log("옵션 체크: 옵션있음"),R.showOpt("cart")):(console.log("옵션 체크: 옵션없음"),R.addCartProgress()))},R.addCartProgress=function(){var b=R.getCurProdInfo();a.pageLoading=!0,o.chkProdQty(b.goods_no,a.pageUI.optInfo.selectedOptItemNo).then(function(b){var c=R.getCurProdInfo();parseInt(a.pageUI.orderInfo.orderCnt)<parseInt(c.min_lmt_qty)&&parseInt(c.min_lmt_qty)>0?a.pageUI.orderInfo.orderCnt=parseInt(c.min_lmt_qty):parseInt(a.pageUI.orderInfo.orderCnt)>parseInt(c.max_lmt_qty)&&parseInt(c.max_lmt_qty)>0&&(a.pageUI.orderInfo.orderCnt=parseInt(c.max_lmt_qty)),a.pageUI.optInfo.selectedOptItemNo||0===a.pageUI.optInfo.selectedOptItemNo||(a.pageUI.optInfo.selectedOptItemNo=0),a.pageLoading=!0,u.addCart({member_no:a.loginInfo.mbrNo,goods_no:c.goods_no,item_no:a.pageUI.optInfo.selectedOptItemNo,ord_qty:a.pageUI.orderInfo.orderCnt,goods_cmps_cd:c.goods_cmps_cd,voice:"Y",cart_page_yn:"N"}).then(function(b){a.pageUI.alertType="cart",R.showAlert()})["catch"](function(b){console.error("장바구니 담기 실패"),b.response_code&&"00000"!=b.response_code&&b.response_msg&&""!=b.response_msg&&a.alert_2016("["+b.response_code+"] "+b.response_msg)})["finally"](function(){a.pageLoading=!1})})["catch"](function(){console.error("재고 없음")})["finally"](function(){a.pageLoading=!1})},R.addWish=function(){var b=R.getCurProdInfo();a.pageLoading=!0,v.addWish({member_no:a.loginInfo.mbrNo,goods_no:b.goods_no}).then(function(b){"00000"==b?(a.pageUI.alertType="wish",R.showAlert()):(a.pageUI.alertType="wish_duplicate",R.showAlert())})["catch"](function(){console.error("위시 담기 연동 실패")})["finally"](function(){a.pageLoading=!1})},R.orderDecide=function(b,c,e){if(!a.loginInfo.isLogin||!a.basicInfo.member_info.et_mbr_dlvp_chk||!a.basicInfo.member_info.base_op_pay_chk)return!1;var f=R.getCurProdInfo();return parseInt(a.pageUI.orderInfo.orderCnt)<parseInt(f.min_lmt_qty)&&parseInt(f.min_lmt_qty)>0?(a.pageUI.orderInfo.orderCnt=parseInt(f.min_lmt_qty),console.log("최소/최대 구매수량 오류"),!1):parseInt(a.pageUI.orderInfo.orderCnt)>parseInt(f.max_lmt_qty)&&parseInt(f.max_lmt_qty)>0?(a.pageUI.orderInfo.orderCnt=parseInt(f.max_lmt_qty),console.log("최소/최대 구매수량 오류"),!1):(a.pageLoading=!0,void o.chkProdQty(f.goods_no,a.pageUI.optInfo.selectedOptItemNo).then(function(g){var h={member_nm:a.loginInfo.name,member_no:a.loginInfo.mbrNo,goods_no:f.goods_no,goods_cmps_cd:f.goods_cmps_cd};b&&c?(h.cart_sn=b,f.ord_qty!=a.pageUI.orderInfo.orderCnt?h.ord_qty=a.pageUI.orderInfo.orderCnt:h.ord_qty=f.ord_qty):b&&e?(h.cart_sn=b,f.item_no!=a.pageUI.optInfo.selectedOptItemNo?h.item_no=a.pageUI.optInfo.selectedOptItemNo:h.item_no=f.item_no):(h.item_no=a.pageUI.optInfo.selectedOptItemNo,h.ord_qty=a.pageUI.orderInfo.orderCnt),a.pageLoading=!0,p.getOrderDecide(h).then(function(b){a.pageUI.orderInfo.cart_sn=b.cart_sn?b.cart_sn:null,a.pageUI.orderInfo.deliver_info=b.deliver_info?b.deliver_info:null,a.pageUI.orderInfo.discount_amt=b.discount_amt?b.discount_amt:0,a.pageUI.orderInfo.discount_list=b.discount_list&&b.discount_list.items?b.discount_list.items:null,a.pageUI.orderInfo.goods_list=b.goods_list.items&&b.goods_list.items[0]?b.goods_list.items[0]:null,a.pageUI.orderInfo.pay_info=b.pay_info?b.pay_info:null,a.pageUI.orderInfo.total_amt=b.total_amt?b.total_amt:0,a.pageUI.orderInfo.total_price=b.total_price?b.total_price:0,a.pageUI.orderInfo.total_deli_amt=b.total_deli_amt?b.total_deli_amt:0,a.pageUI.orderInfo.cart_sn&&a.pageUI.orderInfo.deliver_info&&a.pageUI.orderInfo.goods_list&&a.pageUI.orderInfo.total_amt&&a.pageUI.orderInfo.total_price&&(R.changeState("order"),a.pageUI.orderInfo.discount_amt>0?R.showMsg(m.msg.orderDecideDiscount,[a.pageUI.orderInfo.discount_amt,a.pageUI.orderInfo.total_price]):R.showMsg(m.msg.orderDecide),a.orderDecideYesNoTimer&&d.cancel(a.orderDecideYesNoTimer),a.orderDecideYesNoTimer=d(function(){"mic"!=a.pageUI.inputMode&&R.showMsg(m.msg.orderDecideHelp)},3500))})["catch"](function(a){alert("주문 확정 정보 오류 : "+a),console.error("주문확정 정보 오류")})["finally"](function(){a.pageLoading=!1})})["catch"](function(a){a?console.error(a.inv_stat_cd,a.inv_stat_msg):console.error("재고 체크 오류")})["finally"](function(){a.pageLoading=!1}))},R.order=function(){return a.loginInfo.isLogin&&a.basicInfo.member_info.et_mbr_dlvp_chk&&a.basicInfo.member_info.base_op_pay_chk?(R.showMsg(m.msg.orderProgress),void("40"==a.basicInfo.member_info.pay_mean_cd?q.authLpayMerchant(a.basicInfo.member_info.onlCno,function(b){b?q.getLpayPaymentInfo(a.basicInfo.member_info.pay_card_rcgn_id,function(b){b?(a.basicInfo.member_info.fnCoNm=b.fnCoNm,a.basicInfo.member_info.pmtMthdAlias=b.pmtMthdAlias,K()):(console.error("결제 수단 확인 실패"),a.basicInfo.member_info.base_op_pay_chk=!1)}):(console.error("Lpay 인증 실패"),a.basicInfo.member_info.base_op_pay_chk=!1)}):K())):!1},a.talkOrderCallBack=function(c,d,e){function f(){g.hideHeader()}"0000"==c?(a.pageLoading=!0,r.getOrderComplete({member_no:a.loginInfo.mbrNo,ord_no:e}).then(function(b){a.pageUI.orderCompleteInfo.ord_no=b.ord_no?b.ord_no:null,a.pageUI.orderCompleteInfo.ord_no||(a.pageUI.orderCompleteInfo.ord_no=e),a.pageUI.orderCompleteInfo.goods_list=b.goods_list&&b.goods_list.items&&b.goods_list.items[0]?b.goods_list.items[0]:null,a.pageUI.orderCompleteInfo.deliver_info=b.deliver_info?b.deliver_info:null,a.pageUI.orderCompleteInfo.total_amt=b.total_amt?b.total_amt:0,a.pageUI.orderCompleteInfo.discount_amt=b.discount_amt?b.discount_amt:0,a.pageUI.orderCompleteInfo.total_price=b.total_price?b.total_price:0,a.pageUI.orderCompleteInfo.send_due_code=b.send_due_code?b.send_due_code:null,a.pageUI.orderCompleteInfo.send_due_date=b.send_due_date?b.send_due_date:null,a.pageUI.orderCompleteInfo.send_due_month=b.send_due_month?b.send_due_month:null,a.pageUI.orderCompleteInfo.send_due_day=b.send_due_day?b.send_due_day:null,a.pageUI.orderCompleteInfo.send_due_week=b.send_due_week?b.send_due_week:null,a.pageUI.showOrder=!1,R.changeState("order_complete");var c=x("number")(parseInt(a.pageUI.orderCompleteInfo.total_price))+"원에 결제가 완료되었어요.<br />",d=x("number")(parseInt(a.pageUI.orderCompleteInfo.total_price))+"원에 결제가 완료되었어요.";"01"==a.pageUI.orderCompleteInfo.send_due_code?(c+="<strong>"+a.pageUI.orderCompleteInfo.send_due_month+"월 "+a.pageUI.orderCompleteInfo.send_due_day+"일 도착 예정</strong>이며,<br />",d+=a.pageUI.orderCompleteInfo.send_due_month+"월 "+a.pageUI.orderCompleteInfo.send_due_day+"일 도착 예정이며,"):"02"==a.pageUI.orderCompleteInfo.send_due_code?(c+="<strong>"+a.pageUI.orderCompleteInfo.send_due_month+"월 "+a.pageUI.orderCompleteInfo.send_due_day+"일 발송 예정</strong>이며,<br />",d+=a.pageUI.orderCompleteInfo.send_due_month+"월 "+a.pageUI.orderCompleteInfo.send_due_day+"일 발송 예정이며,"):"03"==a.pageUI.orderCompleteInfo.send_due_code&&(c+="",d+=""),c+="자세한 주문정보는 주문배송조회에서 확인하실 수 있어요.",d+="자세한 주문정보는 주문배송조회에서 확인하실 수 있어요.",R.showMsg(m.getMsgData(c,d,"top"))})["catch"](function(){console.log("결제 실패 - 결제정보 없음"),a.pageUI.showOrder=!1})["finally"](function(){a.pageLoading=!1})):(a.alert_2016("["+c+"] "+d),a.pageUI.showOrder=!1,b.element("#ordIframe").prop("src","")),f()},c.talkOrderCallBack=a.talkOrderCallBack,a.iptGuideActiveIdx=0,a.iptGuideHideIdx=-1;var V=null,W=3e3;R.needLoginCommand=function(a){D.setSessionStorage("vcLastCommandFlag","Y"),f.goLogin(a)};var X=null,Y=5e3;R.showMsg=function(c,e,f){if(!c)return!1;"q"==c.position||"top"==c.position?(a.pageUI.showMsg.guide=!1,a.pageUI.showMsg.home=!1):("guide"==c.position||"home"==c.position)&&(a.pageUI.showMsg.top=!1,a.pageUI.showMsg.q=!1);var g=b.copy(c);if(e&&e.length>0){var h=0;for(h=0;h<e.length;h++){var i;i=Number(e[h])?x("number")(e[h]):e[h],g.txt=(g.txt+"").replace("{}",i),g.voice=(g.voice+"").replace("{}",i)}}switch(a.viewInfoTemp=null,g.position){case"home":a.stopVoiceGuide(),a.pageUI.msg.home=g.txt,a.pageUI.showMsg.home=!0;break;case"top":a.pageUI.msg.top=g.txt,a.pageUI.stateHistory[a.pageUI.stateHistory.length-1].msgTop=g.txt,a.pageUI.showMsg.top=!0;break;case"q":"home"==a.pageUI.state&&(a.pageUI.showMsg.guide=!0),a.pageUI.showMsg.q=!0,a.pageUI.inputMode="",a.pageUI.msg.q=g.txt,a.viewInfoTemp=g,f&&(a.viewInfoTemp.viewMicCheck=!0),X&&(d.cancel(X),X=null),N()}R.stopAppTTS(),a.pageUI.app.soundFlag?(a.pageUI.inputMode="",d(function(){R.startAppTTS(g.voice)},200)):X=d(function(){d.cancel(X),X=null,a.pageUI.showMsg.q=!1,a.pageUI.inputMode="";var b=!1;if(null!=a.viewInfoTemp){switch(a.viewInfoTemp.txt){case m.msg.needLoginYesNo.txt:case m.msg.prdOptShow.txt:case m.msg.orderDecideHelp.txt:b=!0}a.viewInfoTemp.viewMicCheck&&(b=!0),b&&a.actionInput(null)}},Y),g.voice&&R.showToast(g.voice)},a.devToastMsg="",a.devToastMsgShowFlag=!1,R.showToast=function(b){a.devToastMsg=b,a.devToastMsgShowFlag=!0,d(function(){a.devToastMsgShowFlag=!1},3e3)},R.semanticMsgShow=function(a){a.topScreenMent?R.showMsg(m.getMsgData(a.topScreenMent,a.basicVoiceMent,"top")):a.queryMent?R.showMsg(m.getMsgData(a.queryMent,a.basicVoiceMent,"q")):a.homeScreenMent&&R.showMsg(m.getMsgData(a.homeScreenMent,a.basicVoiceMent,"home"))};var Z=!1,$=!1,_=!1;a.prodListQuantity=-1,a.prdSwiperMoveCommand="",a.cartWishListPrevState=!1,R.commandExec=function(e,g,l,o){switch(a.pageUI.isChangeCommandState=!1,a.cartWishListPrevState?a.pageUI.isChangeCommandState=!1:("getCart"==e||"getWish"==e)&&(a.pageUI.curPage=1,a.pageUI.isChangeCommandState=!0),a.cartWishListPrevState=!1,e){case"talk":case"prohibit":if(g&&(g.homeScreenMent||g.queryMent)){R.changeState("home");var p=g.homeScreenMent||g.queryMent,q="home";!g.homeScreenMent&&g.queryMent&&(q="q");var r=p.replace(/(\\n|\n)/g,"<br />"),s=g.basicVoiceMent.replace(/(\\n|\n)/g,"");R.showMsg(m.getMsgData(r,s,q))}"talk"==e?a.setGATag("공통_일상대화","일상대화",l,o):a.setGATag("공통_금칙어","금칙어",l,o);break;case"goLogin":if(!a.loginInfo.isLogin){f.go(e,a.loginInfo.isLogin);break}R.showMsg(m.msg.nowLogin),a.setGATag("공통_로그인","로그인",l,o);break;case"goChangePayment":if(!a.loginInfo.isLogin){R.showMsg(m.msg.needLogin),a.setGATag("햄버거_등록","결제수단",l,o);break}a.setGATag("공통_정보변경","결제수단 변경",l,o),f.go(e,a.loginInfo.isLogin);break;case"goChangeDelivery":if(!a.loginInfo.isLogin){a.setGATag("햄버거_등록","배송지",l,o),R.showMsg(m.msg.needLogin);break}a.setGATag("공통_정보변경","배송지 변경",l,o),f.go(e,a.loginInfo.isLogin);break;case"goPurchaseList":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","주문배송조회 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goCoupon":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","쿠폰 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goPoint":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","포인트 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goWish":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","위시리스트 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goEvent":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","이벤트응모내역 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goPurchaseBenefitList":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","구매사은 이동",l,o),f.go(e,a.loginInfo.isLogin);
break;case"goMembership":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","멤버십 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goTalkAdvice":a.loginInfo.isLogin||R.showMsg(m.msg.needLogin),a.setGATag("공통_이동","톡상담 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"goMyLotte":a.setGATag("공통_이동","마이롯데 이동",l,o),f.go(e);break;case"goCart":a.setGATag("공통_이동","장바구니 이동",l,o),f.go(e);break;case"goRecently":a.setGATag("공통_이동","최근본상품 이동",l,o),f.go(e);break;case"goMallMimitoutou":a.setGATag("공통_이동","미미뚜뚜 이동",l,o),f.go(e);break;case"goMallSpecialTasty":a.setGATag("공통_이동","특별한맛남이동",l,o),f.go(e);break;case"goMallStyleshop":a.setGATag("공통_이동","스타일샵 이동",l,o),f.go(e);break;case"goMallLottebrand":a.setGATag("공통_이동","롯데브랜드관 이동",l,o),f.go(e);break;case"goMallKshop":a.setGATag("공통_이동","케이샵 이동",l,o),f.go(e);break;case"goMallScalp":a.setGATag("공통_이동","두피전문관 이동",l,o),f.go(e);break;case"goMallTVoutlet":a.setGATag("공통_이동","tv아울렛 이동",l,o),f.go(e);break;case"goMallBook":a.setGATag("공통_이동","도서 이동",l,o),f.go(e);break;case"goMallTenbyten":a.setGATag("공통_이동","텐바이텐 이동",l,o),f.go(e);break;case"goMallVine":a.setGATag("공통_이동","바인 이동",l,o),f.go(e);break;case"goMain":a.setGATag("공통_이동","홈 이동",l,o),f.go(e);break;case"goMainBest":a.setGATag("공통_이동","베스트 이동",l,o),f.go(e);break;case"goMainGift":a.setGATag("공통_이동","기프트 이동",l,o),f.go(e);break;case"goMainEvent":a.setGATag("공통_이동","이벤트쿠폰 이동",l,o),f.go(e);break;case"goDirectAttend":a.setGATag("공통_이동","출석체크 이동",l,o),f.go(e);break;case"goPurchaseBenefit":a.setGATag("공통_이동","구매사은 이동",l,o),f.go(e,a.loginInfo.isLogin);break;case"actionHelp":"home"==a.pageUI.state||"order_complete"==a.pageUI.state?(a.pageUI.sideNavGuideOpenFlag=!a.pageUI.sideNavGuideOpenFlag,a.setGATag("공통_상단영역","도움말",l,o)):(a.pageLoading=!0,k.getHelpInfo(a.pageUI.state).then(function(b){a.pageUI.helpInfo=b,R.allHideLayer(),a.pageUI.showHelp=!0})["catch"](function(){console.error("도움말 코너 정보 연동 실패")})["finally"](function(){a.pageLoading=!1}),a.setGATag("공통_상단영역","도움말",l,o));break;case"actionChangeMyInfo":a.pageUI.sideNavOpenFlag=!0,R.showMsg(m.msg.changeMyInfo),a.setGATag("공통_정보변경","내정보 변경",l,o);break;case"actionBack":"home"==a.pageUI.state?(a.setGATag("음성명령어","이전",l,o),R.showMsg(m.msg.isHome)):"prod_list"==a.pageUI.state?(a.setGATag("음성명령어","이전",l,o),G()):"prod_detail"==a.pageUI.state?(a.setGATag("음성명령어","이전",l,o),G()):"order"==a.pageUI.state?(a.setGATag("음성명령어","이전",l,o),G()):"cart"==a.pageUI.state?a.pageUI.curPage>1?a.cartWishListPrev():G():"wish"==a.pageUI.state?(console.log("$scope.pageUI.curPage : ",a.pageUI.curPage),a.pageUI.curPage>1?a.cartWishListPrev():G()):"order_complete"==a.pageUI.state&&(a.setGATag("음성명령어","이전",l,o),G());break;case"actionMore":if("home"==a.pageUI.state)R.showMsg(m.msg.homeMore),a.setGATag("음성명령어","더보여줘",l,o);else if("prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state)a.pageUI.prdList.length-1>a.pageUI.curPrdSwiperIdx?a.prdSwiperCtrl.moveIndex(a.pageUI.curPrdSwiperIdx+1):(a.pageUI.curPage<a.getTotalRowPerPage()?a.cartWishListNext():R.showMsg(m.msg.prdListEnd),a.setGATag("음성명령어","더보여줘",C.setDigit(a.pageUI.curPrdSwiperIdx+1),o));else if("prod_detail"==a.pageUI.state){var u=b.element(c).scrollTop()+b.element(c).height();b.element("html, body").stop().animate({scrollTop:u},300,"swing"),a.setGATag("음성명령어","더보여줘",l,o)}else("order"==a.pageUI.state||"order_complete"==a.pageUI.state)&&a.setGATag("음성명령어","더보여줘",l,o);break;case"actionFirst":"home"==a.pageUI.state?(a.pageUI.showHotKeyword=!1,a.setGATag("음성명령어","처음으로",l,o),R.showMsg(m.msg.isHome)):(a.pageUI.showMsg.top=!1,a.setGATag("음성명령어","처음으로",l,o),R.changeState("home",{guideFlag:!0},!0));break;case"actionUp":"prod_detail"==a.pageUI.state&&b.element("html, body").stop().animate({scrollTop:0},300,"swing"),a.setGATag("음성명령어","위로",l,o);break;case"actionDown":if("prod_detail"==a.pageUI.state){var u=b.element(c).scrollTop()+b.element(c).height();b.element("html, body").stop().animate({scrollTop:u},300,"swing")}a.setGATag("음성명령어","아래로",l,o);break;case"actionClose":a.pageUI.showPrdOpt&&("voice"==o||"keyboard"==o)&&a.setGATag("옵션레이어","닫기",l,o),a.pageUI.showShare&&("voice"==o||"keyboard"==o)&&a.setGATag("공유레이어","닫기",l,o),R.chkShowLayer()||a.exit();break;case"actionUnknown":"home"==a.pageUI.state?R.showMsg(m.msg.unknownHome):R.showMsg(m.msg.unknown),a.setGATag("음성명령어","의미분석실패",l,o);break;case"actionOrder":case"goPayment":if("home"==a.pageUI.state||a.pageUI.prdList.length<1)return void R.showMsg(m.msg.unknownHome);var v=R.getCurProdInfo(),z=g&&g.commandNumber?parseInt(g.commandNumber)-1:-1,A=g&&g.commandQuantity?parseInt(g.commandQuantity):0,B=!1;if(A>=1){if("order"==a.pageUI.state){a.pageUI.orderInfo.orderCnt=A,v.cart_sn?R.orderDecide(v.cart_sn,!0):R.orderDecide(),a.setGATag("음성명령어","수량 변경 주문",l,o);break}B=!0,a.pageUI.orderInfo.orderCnt=A,a.setGATag("음성명령어","수량 변경 주문",l,o)}else a.prodListQuantity>0?a.pageUI.orderInfo.orderCnt=a.prodListQuantity:a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty);if(a.pageUI.orderInfo.orderCnt<parseInt(v.min_lmt_qty)){R.showMsg(m.msg.errMinLmtQty,[parseInt(v.min_lmt_qty)]),a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty);break}if(a.pageUI.orderInfo.orderCnt>parseInt(v.max_lmt_qty)){R.showMsg(m.msg.errMxnLmtQty,[parseInt(v.max_lmt_qty)]),a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty);break}if("prod_list"==a.pageUI.state||"wish"==a.pageUI.state||"cart"==a.pageUI.state)if(z>-1&&a.pageUI.prdList.length>z&&(a.pageUI.curPrdSwiperIdx=z,console.log("번호발화 있음",z),a.prdSwiperCtrl.moveSpeedIndex(z,10)),"cart"==a.pageUI.state)if("Y"==v.vic_ord_psb_yn){if(O()){if(a.pageUI.optInfo.selectedOptItemNo=v.item_no,R.chkOpt()&&v.goods_option){a.pageUI.optInfo.curOptValArr=[];var D=v.goods_option,E=[],F=null,H=0;for("Y"==v.input_option_yn&&v.goods_input_option&&(D+=", "+v.goods_input_option),E=(D+"").split(", "),H=0;H<E.length;H++)F=null,F=(E[H]+"").split(" : "),2==F.length&&a.pageUI.optInfo.curOptValArr.push({name:F[0],item:{optValue:F[1]}})}!B&&v.ord_qty&&(a.pageUI.orderInfo.orderCnt=v.ord_qty),v.cart_sn&&("Y"==v.smpick_yn?B?P(v):(f.voiceUnableOrder(v.cart_sn),R.showMsg(m.msg.notVoiceOrder)):R.orderDecide(v.cart_sn,B))}}else"Y"!=v.m_sale_possible_yn?R.showMsg(m.msg.notMobileOrder):v.cart_sn&&(B?P(v):(R.showMsg(m.msg.notVoiceOrder),f.voiceUnableOrder(v.cart_sn)));else"Y"==v.vic_ord_psb_yn?O()&&(R.chkOpt()?R.showOpt("order"):R.orderDecide()):(R.showMsg(m.msg.notVoiceOrder),f.goPrdDetail(v.goods_no));else"prod_detail"==a.pageUI.state?O()&&R.orderDecide():"order"==a.pageUI.state&&O()&&R.order();"prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state?a.setGATag("유닛노출명령어","주문해줘",l,o):"prod_detail"==a.pageUI.state&&a.setGATag("상품상세노출명령어","주문해줘",l,o);break;case"actionDetail":if("prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state)R.getProdDetailInfo(),a.setGATag("유닛노출명령어","자세히",l,o);else if("prod_detail"==a.pageUI.state){var I=b.element("#prodDescription").offset().top-b.element("header").outerHeight();b.element("html, body").stop().animate({scrollTop:I},300,"swing"),a.setGATag("음성명령어","자세히",l,o)}break;case"actionAddWish":if("prod_list"==a.pageUI.state||"cart"==a.pageUI.state){var z=g&&g.commandNumber?parseInt(g.commandNumber)-1:-1;z>-1&&a.pageUI.prdList.length>z&&(a.pageUI.curPrdSwiperIdx=z,console.log("번호발화 있음",z),a.prdSwiperCtrl.moveSpeedIndex(z,10));var v=R.getCurProdInfo();console.log("curPordInfo +++",v),"Y"==v.vic_ord_psb_yn?a.loginInfo.isLogin?R.addWish():($=!0,R.showMsg(m.msg.needLoginYesNo)):a.loginInfo.isLogin?"Y"!=v.m_sale_possible_yn?R.showMsg(m.msg.notMobileOrder):"Y"==v.limit_age_yn?"prod_list"==a.pageUI.state?f.goPrdDetail(v.goods_no):"cart"==a.pageUI.state&&R.addWish():"Y"==v.gfct_yn&&a.loginInfo.isSimple?R.showMsg(m.msg.notSimpleMemberCartWish):R.addWish():($=!0,R.showMsg(m.msg.needLoginYesNo))}else"wish"==a.pageUI.state?(a.pageUI.alertType="wish_duplicate",R.showAlert(),R.showMsg(m.msg.alreadyWish)):"prod_detail"==a.pageUI.state&&(a.loginInfo.isLogin?R.addWish():($=!0,R.showMsg(m.msg.needLoginYesNo)));a.setGATag("음성명령어","위시리스트 담기",l,o);break;case"actionAddCart":var v=R.getCurProdInfo(),z=g&&g.commandNumber?parseInt(g.commandNumber)-1:-1,A=g&&g.commandQuantity?parseInt(g.commandQuantity):0,B=!1;if(A>=1?(console.log("수량발화 있음",a.pageUI.orderInfo.orderCnt),B=!0,a.pageUI.orderInfo.orderCnt=A):a.prodListQuantity>0?a.pageUI.orderInfo.orderCnt=a.prodListQuantity:a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty),a.pageUI.orderInfo.orderCnt<parseInt(v.min_lmt_qty)){R.showMsg(m.msg.errMinLmtQty,[parseInt(v.min_lmt_qty)]),a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty);break}if(a.pageUI.orderInfo.orderCnt>parseInt(v.max_lmt_qty)){R.showMsg(m.msg.errMxnLmtQty,[parseInt(v.max_lmt_qty)]),a.pageUI.orderInfo.orderCnt=parseInt(v.min_lmt_qty);break}"prod_list"==a.pageUI.state||"wish"==a.pageUI.state?(z>-1&&a.pageUI.prdList.length>z&&(a.pageUI.curPrdSwiperIdx=z,console.log("번호발화 있음",z),a.prdSwiperCtrl.moveSpeedIndex(z,10)),"Y"==v.vic_ord_psb_yn?R.addCart("default"):"Y"!=v.m_sale_possible_yn||"Y"==v.smp_only_yn||"Y"==v.rental_yn||"Y"==v.limit_age_yn||"Y"==v.sale_promotion_yn||"Y"==v.input_option_yn?(R.showMsg(m.msg.notVoiceCart),f.goPrdDetail(v.goods_no)):"Y"==v.gfct_yn?a.loginInfo.isLogin?a.loginInfo.isSimple?R.showMsg(m.msg.notSimpleMemberCartWish):R.addCart("default"):(_=!0,R.showMsg(m.msg.needLoginYesNo)):R.addCart("default")):"cart"==a.pageUI.state?(a.pageUI.alertType="cart_duplicate",R.showAlert()):"prod_detail"==a.pageUI.state&&R.addCartProgress(),"prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state?a.setGATag("유닛노출명령어","찜",l,o):"prod_detail"==a.pageUI.state&&a.setGATag("상품상세노출명령어","찜",l,o);break;case"actionShare":("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state)&&(R.allHideLayer(),a.pageUI.showShare=!0),"prod_list"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state?a.setGATag("유닛노출명령어","공유",l,o):"prod_detail"==a.pageUI.state&&("mic"==o||"keyboard"==o?a.setGATag("음성명령어","공유",l,o):a.setGATag("공유레이어","공유",l,o));break;case"actionShareKakao":t.sendAppShare(R.shareDataSet(),"kakaotalk"),"click"==o?a.setGATag("공유레이어","카카오톡",l,o):a.setGATag("SNS공유함께발화","카카오톡",l,o);break;case"actionShareKaKaoStory":t.sendAppShare(R.shareDataSet(),"kakaostory"),"click"==o?a.setGATag("공유레이어","카카오스토리",l,o):a.setGATag("SNS공유함께발화","카카오스토리",l,o);break;case"actionShareTwitter":t.sendAppShare(R.shareDataSet(),"twitter"),"click"==o?a.setGATag("공유레이어","트위터",l,o):a.setGATag("SNS공유함께발화","트위터",l,o);break;case"actionShareSMS":t.sendAppShare(R.shareDataSet(),"sms"),"click"==o?a.setGATag("공유레이어","문자",l,o):a.setGATag("SNS공유함께발화","문자",l,o);break;case"actionShareFacebook":t.sendAppShare(R.shareDataSet(),"facebook"),"click"==o?a.setGATag("공유레이어","페이스북",l,o):a.setGATag("SNS공유함께발화","페이스북",l,o);break;case"actionShareURL":t.sendAppShare(R.shareDataSet(),"url_copy_voice"),a.pageUI.alertType="copy",R.showAlert(),"click"==o?a.setGATag("공유레이어","url복사",l,o):a.setGATag("SNS공유함께발화","url복사",l,o);break;case"actionProdImg":if("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state){R.allHideLayer();var J=R.getCurProdInfo();a.pageLoading=!0,j.getProdImgInfo(J.goods_no).then(function(c){c&&c.length>0?(a.pageUI.prodImgInfo=c,a.pageUI.showPrdImgDetail=!0,b.element(".img_layer_wrap .pop_layer .img_area").scrollTop(0)):console.error("상품이미지 정보 없음")})["catch"](function(){console.error("상품 이미지 정보 로드 오류")})["finally"](function(){a.pageLoading=!1})}a.setGATag("음성명령어","상품이미지보여줘",l,o);break;case"actionProdComment":if("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state){var J=R.getCurProdInfo();J&&J.goods_no&&(J.pmg_gdas_cnt>0?(a.pageUI.prodCommentPageIndex=1,a.pageLoading=!0,n.getProdComment(J.goods_no,a.pageUI.prodCommentPageIndex).then(function(b){a.pageUI.prodComment=b,R.allHideLayer(),a.pageUI.starScoreOpen=!0,a.pageUI.customerSatisOpen=!0,a.pageUI.showPrdComment=!0,R.showMsg(m.msg.prdComment)})["catch"](function(){console.error("상품평 정보 없음."),R.showMsg(m.msg.notPrdComment)})["finally"](function(){a.pageLoading=!1})):R.showMsg(m.msg.notPrdComment))}a.setGATag("음성명령어","상품평 보여줘",l,o);break;case"actionProdOptShow":("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state)&&(R.chkOpt()?R.showOpt():R.showMsg(m.msg.notPrdOption),a.setGATag("음성명령어","옵션 보여줘",l,o));break;case"actionProdOptChange":"prod_detail"==a.pageUI.state?R.chkOpt()?(R.showOpt(),a.setGATag("상품상세노출명령어","옵션 변경해줘",l,o)):R.showMsg(m.msg.notPrdOption):"prod_list"==a.pageUI.state||"wish"==a.pageUI.state?(R.chkOpt()?(Z=!0,R.showMsg(m.msg.prdOptShow)):R.showMsg(m.msg.notPrdOption),a.setGATag("음성명령어","옵션 변경해줘",l,o)):"cart"==a.pageUI.state?(R.chkOpt()?R.showOpt():R.showMsg(m.msg.notPrdOption),a.setGATag("음성명령어","옵션 변경해줘",l,o)):"order"==a.pageUI.state?(R.chkOpt()?R.showOpt("order"):R.showMsg(m.msg.notPrdOption),a.setGATag("음성명령어","옵션 변경해줘",l,o)):"home"==a.pageUI.state&&(R.showMsg(m.msg.unknownHome),a.setGATag("음성명령어","옵션 변경해줘",l,o));break;case"actionYesNo":var K=g?"Y"==(g.commandVal+"").toUpperCase():!1;if(console.log("optChangeYNDelayFlag",Z),console.log("addWishLoginFlag",$),console.log("addCartLoginFlag",_),console.log("isCommandYes",K),("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"wish"==a.pageUI.state)&&K&&Z)Z=!1,R.chkOpt()?R.showOpt():R.showMsg(m.msg.notPrdOption);else if("cart"==a.pageUI.state&&K&&Z){Z=!1;var J=R.getCurProdInfo();"Y"==J.limit_age_yn||"Y"==J.input_option_yn||"Y"==J.smpick_yn?(R.showMsg(m.msg.notVoiceCart),f.goPrdDetail(J.goods_no)):"Y"==J.gfct_yn?R.showMsg(m.msg.notSimpleMemberCartWish):R.showOpt()}else("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state)&&K&&$?($=!1,R.needLoginCommand("actionAddWish")):("prod_list"==a.pageUI.state||"wish"==a.pageUI.state)&&K&&_?(_=!1,R.needLoginCommand("actionAddCart")):"order"==a.pageUI.state&&1==K?(a.setGATag("샬롯질의","주문동의",l,o),R.order()):"order"==a.pageUI.state&&0==K&&a.setGATag("샬롯질의","주문동의거부",l,o);break;case"actionNumber":if("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state||"order"==a.pageUI.state){var z=g&&g.commandNumber?parseInt(g.commandNumber)-1:-1;if(z>-1)if(a.pageUI.showPrdOpt){var L=x("filter")(a.pageUI.optInfo.prdOptInfo[a.pageUI.optInfo.curOptStep].itemList.items,{isSoldout:!1});L.length>z?(a.selectOptItem(L[z].idx,!0),"voice"==o?a.setGATag("옵션레이어","옵션선택",l,o):"keyboard"==o&&a.setGATag("옵션레이어","옵션선택",l,o)):R.showMsg(m.msg.unknown)}else a.prdSwiperCtrl&&a.pageUI.prdList.length>z&&a.prdSwiperCtrl.moveIndex(z)}else"home"==a.pageUI.state?R.showMsg(m.msg.unknownHome):R.showMsg(m.msg.unknown);break;case"answerDeliveryFee":case"answerDeliveryTime":if("prod_list"==a.pageUI.state||"prod_detail"==a.pageUI.state||"cart"==a.pageUI.state||"wish"==a.pageUI.state){var v=R.getCurProdInfo();v&&v.goods_no?(a.pageLoading=!0,w.getDeliveryInfo({goods_no:v.goods_no}).then(function(b){if("answerDeliveryFee"==e)0==parseInt(b.dlvFee)?R.showMsg(m.msg.prdDeliveryFree):R.showMsg(m.msg.prdDeliveryCharge,[b.dlvFee,b.stdAmt]),a.setGATag("음성명령어","배송비 얼마야",l,o);else{"99"==b.gubunCd?R.showMsg(m.msg.prdDeliveryHolidayDate):"1"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDateSmart,[b.smp_dlv_area]):"2"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDateRese,[b.dlvDate,b.dlvDesc]):"3"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDateSet,[b.dlvDate]):"4"==b.gubunCd?R.showMsg(m.msg.prdDeliveryDateRental,[b.dlvDate]):"5"==b.gubunCd?R.showMsg(m.msg.prdDeliveryDate,[b.dlvDate,b.dlvDesc]):"6"==b.gubunCd||"7"==b.gubunCd||"8"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDate,[b.dlvDate,b.dlvDesc]):"9"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDateCou,[b.dlvDate]):"10"==b.gubunCd?"cart"==a.pageUI.state&&"Y"==v.smpick_yn?R.showMsg(m.msg.prdDeliveryDateSmart,[v.smp_dlv_area]):R.showMsg(m.msg.prdDeliveryDate,[b.dlvDate,b.dlvDesc]):R.showMsg(m.msg.prdDeliveryDate,[b.dlvDate]),a.setGATag("음성명령어","배송 언제와",l,o)}})["catch"](function(){console.error("배송정보 확인 오류")})["finally"](function(){a.pageLoading=!1})):console.error("상품정보 오류")}break;case"getCart":case"getWish":case"getRecom":var M={};if(M.siteNo=1,M.adultYn=!1,M.chlNo=i.getCookie("CHLNO"),M.chlDtlNo=i.getCookie("CHLDTLNO"),a.loginInfo.isLogin&&(M.mbrNo=a.loginInfo.mbrNo,M.gradeCd=a.loginInfo.gradeCd,M.adultYn=a.loginInfo.isAdult?!0:!1),"getCart"==e)M.searchType="J",M.page=a.pageUI.curPage,M.rowsPerPage=a.pageUI.rowsPerPage,a.setGATag("공통_장바구니보기","장바구니보기",l,o);else if("getWish"==e){if(!a.loginInfo.isLogin){R.showMsg(m.msg.needLogin),R.needLoginCommand("getWish");break}M.searchType="W",M.page=a.pageUI.curPage,M.rowsPerPage=a.pageUI.rowsPerPage,a.setGATag("공통_위시리스트보기","위시리스트보기",l,o)}else{if(!g){console.error("상품 추천 데이터 없음"),a.setGATag("공통_추천","상품결과없음",l,o);break}if(a.pageUI.preReqParam=g.preReqParam?g.preReqParam:null,a.pageUI.preReqParamObj=null,a.pageUI.preReqParam){var N=(a.pageUI.preReqParam+"").replace(/^\&|\?/i,""),Q=N.split("&"),S={};if(Q&&Q.length>0){var T=0,U=null;for(T=0;T<Q.length;T++)U=null,U=Q[T].split("="),U&&2==U.length&&(S[U[0]]=U[1]);S&&(a.pageUI.preReqParamObj=S)}}if(console.log("$scope.pageUI.preReqParamObj",a.pageUI.preReqParamObj),!(g.goodsNoList&&g.goodsNoList.length>0)){if(a.pageUI.preReqParamObj&&a.pageUI.preReqParamObj.talkId&&"2"==a.pageUI.preReqParamObj.talkId){a.pageLoading=!0,y.getHotKeyword().then(function(b){b&&(a.setGATag("공통_추천","상품결과없음",l,o),R.changeState("home"),a.pageUI.showHotKeyword=!0,a.pageUI.hotKeyword=b,R.showMsg(m.msg.prdDataEmpty))})["catch"](function(){console.error("인기키워드 오류")})["finally"](function(){a.pageLoading=!1});break}if(a.pageUI.preReqParamObj&&a.pageUI.preReqParamObj.talkId>"2"){console.log("2차 발화 이상 - 상품 없음, data : ",g),a.setGATag("공통_추천","상품결과없음",l,o),g.queryMent&&g.basicVoiceMent&&R.semanticMsgShow(g);break}console.log("발화 차수 정보 없음 - 상품 없음, data : ",g),a.setGATag("공통_추천","상품결과없음",l,o),g.queryMent&&g.basicVoiceMent&&R.semanticMsgShow(g);break}M.searchType="G",M.goodsNo=(g.goodsNoList+"").trim()}R.initProdOpt(),a.pageLoading=!0,h.getPrdListInfo(M).then(function(c){if(!c.prd_list)return a.pageUI.prdList=[],void("getCart"==e?(R.changeState("cart"),R.showMsg(m.msg.cartNone)):"getWish"==e&&(R.changeState("wish"),R.showMsg(m.msg.wishNone)));if(a.pageUI.prdList=c.prd_list.items,a.pageUI.showPrd10=!1,a.pageUI.showPrd20=!1,a.pageUI.showPrdEnd=!1,"getCart"==e)a.pageUI.cartCnt=c.total_cnt,R.changeState("cart"),a.pageUI.isChangeCommandState&&(a.pageUI.cartCnt>a.pageUI.rowsPerPage?R.showMsg(m.msg.cartShow,[a.pageUI.cartCnt]):a.pageUI.cartCnt>0?R.showMsg(m.msg.cartShowUnder,[a.pageUI.cartCnt]):0==a.pageUI.cartCnt&&R.showMsg(m.msg.cartNone));else if("getWish"==e)a.pageUI.wishCnt=c.total_cnt,R.changeState("wish"),a.pageUI.isChangeCommandState&&(a.pageUI.wishCnt>a.pageUI.rowsPerPage?R.showMsg(m.msg.wishShow,[a.pageUI.wishCnt]):a.pageUI.wishCnt>0?R.showMsg(m.msg.wishShowUnder,[a.pageUI.wishCnt]):0==a.pageUI.wishCnt&&R.showMsg(m.msg.wishNone));else{var f,h=JSON.parse(g.recommendData);if(g.preReqParam){var i=(g.preReqParam+"").replace(/^\&|\?/i,""),j=i.split("&"),k={};if(j&&j.length>0){var n=0,p=null;for(n=0;n<j.length;n++)p=null,p=j[n].split("="),p&&2==p.length&&(k[p[0]]=p[1]);k&&(f=k)}}var q=({"베스트 R":f.searchType,"통합검색 인기검색어 T":f.searchType,"발화 : talkId":f.talkId,"카테고리 C":f.searchType,"성별":h.gender,"나이":h.age,"아이템":h.itemValue,"브랜드":h.brandNo,"가격대":f.priceValue,"가격대 최소":h.priceMin,"가격대 최대":h.priceMax,"무료배송":h.freeDeliYN,"무이자혜택":h.freeInstYN,"퀵배송":h.delQuickYN,"포인트적립":h.pointYN,"오늘도착":h.delTdarYN,"무료선물포장":h.pkgYN,"컬러":h.color,"정렬":h.sort},[f.searchType?f.searchType:"",2==f.talkId?"1차":"2차",h.itemValue?"아이템":"",f.keyword?"아이템":"",h.brandNo?"브랜드":"",f.priceValue?"가격대":"",h.freeDeliYN?"무료배송":"",h.freeInstYN?"무이자혜택":"",h.delQuickYN?"퀵배송":"",h.pointYN?"포인트적립":"",h.delTdarYN?"오늘도착":"",h.pkgYN?"무료선물포장":"",h.color?"컬러":"",h.sort?"정렬":""]),r=[f.searchType?f.searchType:"",2==f.talkId?"1차":"2차",f.priceValue?"가격대":"",h.freeDeliYN?"무료배송":"",h.freeInstYN?"무이자혜택":"",h.delQuickYN?"퀵배송":"",h.pointYN?"포인트적립":"",h.delTdarYN?"오늘도착":"",h.pkgYN?"무료선물포장":"",h.color?"컬러":"",h.sort?"정렬":""],s=[],t=[];for(n=0;n<q.length;n++)""!=q[n]&&s.push(q[n]);for(n=0;n<r.length;n++)""!=r[n]&&t.push(r[n]);"R"==f.searchType&&h.gender&&h.age?a.setGATag("공통_추천","베스트_"+h.gender+"_"+h.age,l,o):"R"==f.searchType&&h.gender?a.setGATag("공통_추천","베스트_"+h.gender,l,o):"R"==f.searchType&&h.age&&a.setGATag("공통_추천","베스트_"+h.age,l,o),("C"==f.searchType||"T"==f.searchType)&&(2==f.talkId?a.setGATag("공통_추천",s.join("_"),l,o):a.setGATag("공통_추천",t.join("_"),l,o)),console.table(f),R.changeState("prod_list"),R.semanticMsgShow(g)}a.prdSwiperCtrl&&(b.element(".prod_list_wrap").css("opacity",0),a.prdSwiperCtrl.init(),d(function(){a.pageUI.curPrdSwiperIdx=0,a.prdSwiperCtrl.setIndex(0),b.element(".prod_list_wrap").css("opacity",1)},300))})["catch"](function(b){a.pageUI.prdList=[],"getCart"==e?R.showMsg(m.msg.cartNone):"getWish"==e&&R.showMsg(m.msg.wishNone)})["finally"](function(){a.pageLoading=!1});break;case"actionQuantity":case"actionQuantityChange":case"actionQuantityMore":case"actionOrderMore":var v=R.getCurProdInfo(),A=g&&g.commandQuantity?parseInt(g.commandQuantity):0;("actionQuantityMore"==e||"actionOrderMore"==e)&&("actionQuantityMore"==e?a.setGATag("음성명령어","수량 늘리기",l,o):"actionOrderMore"==e&&a.setGATag("음성명령어","수량 늘리기 주문",l,o),"prod_detail"==a.pageUI.state?(a.prodListQuantity<1&&(a.prodListQuantity=1),A=a.prodListQuantity+A):"order"==a.pageUI.state&&(A=a.pageUI.orderInfo.orderCnt+A)),A>0&&A>=parseInt(v.min_lmt_qty)&&A<=parseInt(v.max_lmt_qty)?"prod_detail"==a.pageUI.state?(a.prodListQuantity=A,a.setGATag("음성명령어","수량 변경",l,o),"actionOrderMore"==e&&(a.pageUI.orderInfo.orderCnt=A,R.orderDecide())):"order"==a.pageUI.state?(a.pageUI.orderInfo.orderCnt=A,a.setGATag("음성명령어","수량 변경",l,o),v.cart_sn?R.orderDecide(v.cart_sn,!0):R.orderDecide()):R.showMsg(m.msg.unknown):A<parseInt(v.min_lmt_qty)?R.showMsg(m.msg.errMinLmtQty,[parseInt(v.min_lmt_qty)]):A>parseInt(v.max_lmt_qty)&&R.showMsg(m.msg.errMxnLmtQty,[parseInt(v.max_lmt_qty)])}"actionUnknown"!=e&&("actionProdOptChange"!=e?Z=!1:"actionAddWish"!=e?$=!1:"addCartLoginFlag"!=e&&(_=!1))},-1==navigator.userAgent.indexOf("mlotte001")&&Q(),a.VCCtrl=R}]),d.directive("lotteContainer",["LotteCommon","commInitData","$timeout","VCSendMsg","VCBasicInfo","VCPageMove","$window","VCMsgData","LotteUtil","LotteGA","VCUpdateCart",function(c,d,e,f,g,h,i,j,k,l,m){return{templateUrl:"/lotte/resources_dev/talk/voiceCommerce_container.html",replace:!0,controller:"LotteContainerCtrl",link:function(l,n,o,p){function q(){b.element(i).off(".actionInput").on("touchend.actionInput",function(a){var c=l.pageUI.inputMode,d=b.element(a.target);if(!(d.hasClass("voice_mic")||d.parents(".voice_mic").length>0)&&(console.log("touchend",d),"keyboard"==c||"mic"==c)){b.element(i).off(".actionInput");var e=d.attr("id");"iptSendTxt"!=e&&"btnMic"!=e&&"btnKeyboard"!=e&&(p.stopAppSTT(),b.element("#iptSendTxt").blur(),l.pageUI.inputMode="",l.pageUI.inputTxt="")}})}function r(){if(l.pageUI.optInfo.prdOptStepCnt==l.pageUI.optInfo.curLayerOptValArr.length){var a=l.pageUI.optInfo.curOptValArr;if(l.pageUI.optInfo.curOptValArr=l.pageUI.optInfo.curLayerOptValArr,console.log("선택옵션",l.pageUI.optInfo.curOptValArr),p.setSelectedProdOptItemInfo(),null!=l.pageUI.optInfo.selectedOptItemNo){if("order"==l.pageUI.optInfo.optType){var c=p.getCurProdInfo();p.orderDecide(c.cart_sn,!1,!0)}else if("cart"==l.pageUI.optInfo.optType)p.addCartProgress();else if("cart"==l.pageUI.state){var c=p.getCurProdInfo(),d=l.pageUI.optInfo.selectedOptItemNo;l.pageLoading=!0,m.updateCart({cart_sn:c.cart_sn,item_no:d,ord_qty:c.ord_qty,update_ck:!0,goods_no:c.goods_no,goods_cmps_cd:c.goods_cmps_cd}).then(function(a){var d=[];b.forEach(l.pageUI.optInfo.curOptValArr,function(a,b){d.push(a.name+" : "+a.item.optValue)}),c.goods_option=d.join(", ")})["catch"](function(){console.error("장바구니 옵션 업데이트 실패"),l.alert_2016("장바구니 옵션 반영 오류 발생")})["finally"](function(){l.pageLoading=!1})}else p.getProdDetailInfo();l.pageUI.showPrdOpt=!1}else l.pageUI.optInfo.curOptValArr=a}else l.pageUI.optInfo.curOptStep++,p.showMsg(j.getMsgData("원하는 "+l.pageUI.optInfo.prdOptInfo[l.pageUI.optInfo.curOptStep].optNm+" 번호를 말해보세요","원하는 "+l.pageUI.optInfo.prdOptInfo[l.pageUI.optInfo.curOptStep].optNm+" 번호를 말해보세요","q"),null,!0)}l.DEV_MODE="Y"==d.query.dev_mode,l.pageUI.devMode="Y"==d.query.dev_mode,"m.lotte.com"==location.host&&(l.DEV_MODE=!1,l.pageUI.devMode=!1),l.toggleDevMode=function(){l.pageUI.testMode=!l.pageUI.testMode},l.execCommand=function(a,b){p.commandExec(a,b,"개발테스트모드","mic")};var s=0,t=!1;"iPhone"==l.appObj.iOsType&&(t=!0);var u=!1;b.element("#iptSendTxt").bind("blur",function(c){b.element("#voiceMain").removeClass("disableScroll"),t&&"prod_detail"==l.pageUI.state&&e(function(){$(a).scrollTop(s)},10),"keyboard"==l.pageUI.inputMode&&(l.pageUI.inputMode=""),u=!0,e(function(){u=!1},50)}),b.element("#iptSendTxt").bind("focus",function(c){t&&"prod_detail"==l.pageUI.state&&(s=$(a).scrollTop(),b.element("#voiceMain").addClass("disableScroll"))}),l.showDevToast=function(a){p.showToast(a)},l.actionInput=function(a,b){switch(u&&(l.pageUI.inputMode="keyboard"),l.pageUI.inputMode){case"mic":console.log("Input Mode : Mic"),l.pageUI.inputTxt="","keepMic"==b?(l.pageUI.inputMode="",l.setGATag("공통_마이크기능","마이크_ON",null,"click")):(l.pageUI.inputMode="keyboard",l.setGATag("공통_마이크기능","키패드_전환",null,"click")),p.stopAppSTT();break;case"keyboard":console.log("Input Mode : Keyboard"),l.pageUI.inputTxt="",l.pageUI.inputMode="mic",p.stopAppTTS(),l.setGATag("공통_마이크기능","마이크_전환",null,"click"),l.pageUI.micVoiceTxt="듣고 있어요",e(function(){p.startAppSTT()},l.pageUI.appSchemaDelay);break;default:console.log("Input Mode : default",l.pageUI.lastInputMode),"keyboard"==l.pageUI.lastInputMode?("keepBlank"!=b&&(l.setGATag("공통_마이크기능","키패드_ON",null,"click"),l.pageUI.inputMode="keyboard"),p.stopAppSTT()):(l.pageUI.inputTxt="",l.pageUI.inputMode="mic",p.stopAppTTS(),l.setGATag("공통_마이크기능","마이크_ON",null,"click"),l.pageUI.micVoiceTxt="듣고 있어요",e(function(){p.startAppSTT()},l.pageUI.appSchemaDelay))}q(),l.pageUI.lastInputMode=l.pageUI.inputMode},l.getDoubleQuotationMarks=function(a){var b=(a+"").match(/\".+\"/gi);return b&&b.length>0&&(b=b[0]),!b&&a&&(b=a),b?b:""},l.enterSendSemantic=function(a,b,c){a&&13==a.keyCode&&l.sendSemantic(b,c)},l.sendSemantic=function(a,c,d){var e="",h=null;"mic"==a||"click"==a?e=c:"keyboard"==a&&(e=l.pageUI.inputTxt,l.setGATag("공통_마이크기능","키패드_전송",null,"click")),l.prdSwiperMoveCommand=a,"prod_list"==l.pageUI.state&&(h=l.pageUI.preReqParam),"mic"!=a&&"keyboard"!=a&&"click"!=a||!e||("mic"==a?(l.pageUI.inputMode="",l.pageUI.inputTxt=""):"keyboard"==a&&(l.pageUI.inputMode="",l.pageUI.inputTxt="",b.element("#iptSendTxt").blur()),l.pageUI.semanticFlag||(l.pageUI.semanticFlag=!0,l.pageLoading=!0,f.sendSemanticAnalysis({screen:l.pageUI.state,qType:a,text:e,history:d,mbrNo:l.loginInfo.isLogin?l.loginInfo.mbrNo:null,preReqParam:h}).then(function(b){p.commandExec(b.command,b,e,a)})["catch"](function(){})["finally"](function(){l.SemanticHistory=g.getSemanticeHistory(),"mic"==a?(l.pageUI.inputMode="",l.pageUI.inputTxt=""):"keyboard"==a&&(l.pageUI.inputMode="",l.pageUI.inputTxt="",b.element("#iptSendTxt").blur()),l.pageUI.semanticFlag=!1,l.pageLoading=!1})))},l.prdgetRecomrCtrl=null,l.getPrdSwiperControl=function(a){l.prdSwiperCtrl=a,l.pageUI.curPrdSwiperIdx>0&&e(function(){l.pageUI.curPrdSwiperIdx=l.pageUI.curPrdSwiperIdx,l.prdSwiperCtrl.moveSpeedIndex(l.pageUI.curPrdSwiperIdx,10)},10)},l.prdSwiperEnd=function(a){l.pageUI.curPrdSwiperIdx!=a&&(p.initProdOpt(),l.pageUI.curPrdSwiperIdx=a,"mic"==l.prdSwiperMoveCommand?l.setGATag("음성명령어","더보여줘",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"mic"):"keyboard"==l.prdSwiperMoveCommand?l.setGATag("음성명령어","더보여줘",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"keyboard"):("touch"==l.prdSwiperMoveCommand||""==l.prdSwiperMoveCommand)&&l.setGATag("유닛스와이프","유닛스와이프",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click"),l.prdSwiperMoveCommand=""),"prod_list"==l.pageUI.state&&$(".prod_list_wrap").hasClass("prod_list")&&"R"!=l.pageUI.preReqParamObj.searchType&&(l.pageUI.preReqParamObj&&l.pageUI.preReqParamObj.talkId&&"2"==l.pageUI.preReqParamObj.talkId?l.pageUI.prdList.length-1>10?9==l.pageUI.curPrdSwiperIdx?l.pageUI.showPrd10||(console.log("1차발화 :  10개이상"),l.VCCtrl.showMsg(j.msg.priceQuest),l.pageUI.showPrd10=!0,l.setGATag("샬롯재질의","가격재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")):19==l.pageUI.curPrdSwiperIdx?l.pageUI.showPrd20||(console.log("1차발화 :  20개"),l.VCCtrl.showMsg(j.msg.helpQuest),l.pageUI.showPrd20=!0,l.setGATag("샬롯재질의","도와줘재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")):l.pageUI.prdList.length-1<20&&l.pageUI.prdList.length-1==l.pageUI.curPrdSwiperIdx&&(l.pageUI.showPrdEnd||(console.log("1차발화 :  10개이상 20개이하 마지막"),l.VCCtrl.showMsg(j.msg.helpQuest),l.pageUI.showPrdEnd=!0,l.setGATag("샬롯재질의","도와줘재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click"))):l.pageUI.prdList.length-1>2&&l.pageUI.prdList.length-1==l.pageUI.curPrdSwiperIdx&&(l.pageUI.showPrdEnd||(console.log("1차발화 :  10개이하 마지막"),l.VCCtrl.showMsg(j.msg.priceQuest),l.pageUI.showPrdEnd=!0,l.setGATag("샬롯재질의","가격재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click"))):l.pageUI.prdList.length-1>10?9==l.pageUI.curPrdSwiperIdx&&(l.pageUI.showPrd10||(console.log("2차발화 :  10개이상"),l.VCCtrl.showMsg(j.msg.helpQuest),l.pageUI.showPrd10=!0,l.setGATag("샬롯재질의","도와줘재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click"))):l.pageUI.prdList.length-1>2&&l.pageUI.prdList.length-1<=10&&l.pageUI.prdList.length-1==l.pageUI.curPrdSwiperIdx&&(l.pageUI.showPrdEnd||(console.log("2차발화 :  10개이하 마지막"),l.VCCtrl.showMsg(j.msg.helpQuest),l.pageUI.showPrdEnd=!0,l.setGATag("샬롯재질의","도와줘재질의",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click"))))},l.setInfo=function(a){l.pageUI.curPrdSwiperIdx!=a&&(p.initProdOpt(),l.pageUI.curPrdSwiperIdx=a,l.setGATag("상품이미지 스와이프","상품이미지 스와이프",null,"click"))},l.cartWishListPrev=function(){l.pageUI.curPage--,l.pageUI.curPage<1&&(l.pageUI.curPage=1),l.cartWishListPrevState=!0,l.pageUI.curPage>=1&&("cart"==l.pageUI.state?p.commandExec("getCart"):"wish"==l.pageUI.state&&p.commandExec("getWish")),p.showMsg(j.msg.prdPrev),l.setGATag("음성명령어","이전",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")},l.cartWishListNext=function(){l.cartWishListPrevState=!0,l.pageUI.curPage++;var a=0;"cart"==l.pageUI.state?(l.pageUI.curPage>Math.ceil(l.pageUI.cartCnt/l.pageUI.rowsPerPage)&&(l.pageUI.curPage=Math.ceil(l.pageUI.cartCnt/l.pageUI.rowsPerPage)),a=l.pageUI.cartCnt,p.commandExec("getCart")):"wish"==l.pageUI.state&&(l.pageUI.curPage>Math.ceil(l.pageUI.wishCnt/l.pageUI.rowsPerPage)&&(l.pageUI.curPage=Math.ceil(l.pageUI.wishCnt/l.pageUI.rowsPerPage)),a=l.pageUI.wishCnt,p.commandExec("getWish")),l.pageUI.curPage<l.getTotalRowPerPage()?a=l.pageUI.rowsPerPage:(a%=l.pageUI.rowsPerPage,0==a&&(a=l.pageUI.rowsPerPage)),p.showMsg(j.msg.prdNext,[a]),l.setGATag("음성명령어","더보여줘",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")},l.getTotalRowPerPage=function(){var a;return"cart"==l.pageUI.state?a=Math.ceil(l.pageUI.cartCnt/l.pageUI.rowsPerPage):"wish"==l.pageUI.state&&(a=Math.ceil(l.pageUI.wishCnt/l.pageUI.rowsPerPage)),a},l.prevBtnShow=function(){var a=!1;return l.pageUI.prdList&&l.pageUI.curPage>1&&0==l.pageUI.curPrdSwiperIdx&&(a=!0),a},l.nextBtnShow=function(){var a,b=!1;return l.pageUI.curPrdSwiperIdx+1==l.pageUI.rowsPerPage&&(1<l.getTotalRowPerPage()?(b=!0,"cart"==l.pageUI.state?a=Math.ceil(l.pageUI.cartCnt/(l.pageUI.rowsPerPage*l.pageUI.curPage)):"wish"==l.pageUI.state&&(a=Math.ceil(l.pageUI.wishCnt/(l.pageUI.rowsPerPage*l.pageUI.curPage))),
1==a&&(b=!1)):b=!1),b},l.prdStarBG=function(a){return{width:20*a+"%"}},l.goTalkAdvice=function(){h.go("goTalkAdvice",l.loginInfo.isLogin)},l.goPrdDetailPage=function(a){var b=p.getCurProdInfo();b&&b.goods_no&&h.goPrdDetail(b.goods_no)},l.prdShare=function(a){p.commandExec("actionShare",null,null,"click")},l.prdShareHide=function(){p.commandExec("actionClose",null,null,"click"),l.setGATag("공유레이어","닫기",null,"click"),l.showLayerHide=!0,l.pageUI.showShare=!1,e(function(){l.showLayerHide=!1},2e3)},l.prdCart=function(a){p.commandExec("actionAddCart",null,null,"click")},l.addCart=function(){p.commandExec("actionAddCart",null,null,"click")},l.prdOrder=function(a){p.commandExec("actionOrder",null,null,"click")},l.order=function(){p.commandExec("actionOrder",null,null,"click")},l.prdDetail=function(a){a>=0&&("prod_list"==l.pageUI.state||"cart"==l.pageUI.state||"wish"==l.pageUI.state)&&p.commandExec("actionDetail",null,null,"click")},l.closePrdOptLayer=function(){l.pageUI.showPrdOpt=!1,l.setGATag("옵션레이어","닫기",null,"click")};var v=null;l.selectOptItem=function(a,b){var c=l.pageUI.optInfo.prdOptInfo[l.pageUI.optInfo.curOptStep].optNm,d=l.pageUI.optInfo.prdOptInfo[l.pageUI.optInfo.curOptStep].itemList.items;if(a<d.length){var f=d[a];if(l.pageUI.optInfo.curLayerOptValArr.length==l.pageUI.optInfo.curOptStep)l.pageUI.optInfo.curLayerOptValArr.push({name:c,item:f}),1==b||l.setGATag("옵션레이어","옵션선택",k.setDigit(a+1),"click");else{if(l.pageUI.optInfo.curLayerOptValArr.length-1!=l.pageUI.optInfo.curOptStep)return l.pageUI.optInfo.curOptStep=0,l.pageUI.optInfo.curLayerOptValArr=[],!1;l.pageUI.optInfo.curLayerOptValArr.pop(),l.pageUI.optInfo.curLayerOptValArr.push({name:c,item:f})}p.chkNowStepOptSoldout(),v&&(e.cancel(v),v=null),v=e(r,l.pageUI.optInfo.optSelectDelayTime)}},l.helpInfoClick=function(a){l.sendSemantic("click",l.getDoubleQuotationMarks(a)),l.pageUI.showHelp=!1},l.helpInfoHide=function(){l.pageUI.showHelp=!1},l.goCommentLayer=function(){p.commandExec("actionProdComment",null,null,"click")},l.commentLayerHide=function(){l.pageUI.showPrdComment=!1,l.setGATag("상품평레이어","닫기",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")},l.goProdImgLayer=function(){p.commandExec("actionProdImg",null,null,"click")},l.backPrdList=function(){l.setGATag("음성명령어","이전",null,"click"),p.stateHistoryBack()},l.changeProdOpt=function(){p.commandExec("actionProdOptChange",null,null,"click")},l.prodImgLayerHide=function(){l.pageUI.showPrdImgDetail=!1,l.setGATag("이미지레이어","닫기",k.setDigit(l.pageUI.curPrdSwiperIdx+1),"click")},l.toggleOrderTermLayer=function(){l.pageUI.orderInfo.termLayerFlag=!l.pageUI.orderInfo.termLayerFlag},l.ts_clause={visible:!1,index:0},l.ts_clause.index=0,l.ts_clause.visible=!1,l.showHideClause=function(a){l.ts_clause.visible=a,a&&(0==l.ts_clause.index?e(function(){l.loadClause(1)},10):e(function(){l.loadClause(l.ts_clause.index)},10))},l.loadClause=function(a){l.ts_clause.index=a;var d="";switch(a){case 1:d=c.clauseECommerce;break;case 2:d=c.clausePIUse;break;case 3:d=c.clausePIConsign;break;default:return}b.element(".ts_clause_cont > div").scrollTop(0),b.element(".ts_clause_cont > div").scrollLeft(0),b.element("#clauseHolder").load(d+" .clause_wrap")},l.ordLayerHide=function(){l.pageUI.showOrder=!1,l.setGATag("닫기","닫기",null,"click")},l.shareSNS=function(a){switch(a){case"sms":p.commandExec("actionShareSMS",null,null,"click");break;case"kakaotalk":p.commandExec("actionShareKakao",null,null,"click");break;case"kakaostory":p.commandExec("actionShareKaKaoStory",null,null,"click");break;case"facebook":p.commandExec("actionShareFacebook",null,null,"click");break;case"twitter":p.commandExec("actionShareTwitter",null,null,"click");break;case"url_copy_voice":p.commandExec("actionShareURL",null,null,"click")}}}}}]),d.directive("vcPrdDetailInfo",["$window",function(a){return{templateUrl:"/lotte/resources_dev/talk/voiceCommerce_dtl_info.html",replace:!0,scope:{curPrdHtmlInfo:"=curPrdHtmlInfo"},link:function(c,d,e){c.defenseBadHtml=function(a,b){a=a?a:"",a=a.replace(/<link(.*?)>/gi,""),a=a.replace(/<meta(.*?)>/gi,""),a=a.replace(/<script/gi,"<noscript"),a=a.replace(/<\/script/gi,"</noscript"),b.html(a),b.find("style, object, embed, noscript").remove()},c.prdDetailInfoModified=function(c,d){return c&&d?void d.each(function(d,e){var f=b.element(a),g=null,h=null,i=null,j=null,k=null,l=0,m=!1,n=50,o=1,p=0,q=0,r=0,s=f.width(),t=function(){},u=function(){},v=function(){};"TABLE"==e.tagName?(g=b.element('<div class="prddetail_scrollwrap"></div>'),h=b.element(e),i=b.element('<div class="prddetail_scrollbox"></div>'),j=b.element('<span class="scroll_arrow left">&lt;</span>'),k=b.element('<span class="scroll_arrow right">&gt;</span>'),t=function(){var a=i.scrollLeft();q=h.outerWidth(),a>5?(j.stop().css("opacity",0).show().animate({opacity:1},1e3),g.addClass("left_scroll")):(g.removeClass("left_scroll"),j.hide()),a+5<q-i.width()?(k.stop().css("opacity",0).show().animate({opacity:1},1e3),g.addClass("right_scroll")):(g.removeClass("right_scroll"),k.hide())},u=function(){h.after(g),g.append(i.append(h),j,k),i.on("scroll",t),v(),t()},v=function(){return s==f.width()?!1:(s=f.width(),q=h.outerWidth(),r=h.outerHeight(),m?(j.css("top",r/2-j.height()/2),k.css("top",r/2-k.height()/2)):(j.css("top",n),k.css("top",n)),void(h.width()>s-l?(i.attr("style","max-width:100%;overflow-x:scroll;width:"+(s-l)+"px !important"),j.show(),k.show()):(i.removeAttr("style"),j.hide(),k.hide())))}):"IFRAME"==e.tagName&&(g=b.element('<div class="resizer"></div>'),h=b.element(e),u=function(){h.after(g),g.append(h)},v=function(){o=c.width()/h.width(),p=h.height()*o,1>o&&(h.css({"-transform-origin":"0 0",transform:"scale("+o+", "+o+")"}),g.attr("style","overflow:hidden;height:"+Math.round(p)+"px !important"))}),u(),v(),f.on("resize.prdDetailInfoModified",v)}):!1},c.defenseBadHtml(c.curPrdHtmlInfo.max,b.element("#detailLayout")),c.prdDetailInfoModified(b.element("#detailLayout"),b.element("#detailLayout iframe, #detailLayout #sizeGuideTable .tabel_list_wrap >table"))}}}]),d.filter("timeChange",[function(){return function(a){var b=new Date(a),c=b.toLocaleString("ko-KR",{hour:"numeric",minute:"numeric",hour12:!0});return c}}]),d.filter("ceil",function(){return function(a){return Math.ceil(a)}}),d.filter("starScorePolicy",function(){return function(a,b){if(!a)return 0;var d=5,e=Math.ceil(2*a)/2;return b!=c&&(e=e/d*b),e}}),d.filter("brToComma",function(){return function(a){return a?String(a).replace(/<br\/>/gm,", "):""}}),d.directive("moreScroll",["$window","$timeout","VCGetProdComment",function(a,c,d){return function(c,e,f){var g=e[0],h=b.element(a),i=0,j=h.height(),k=!0;e.bind("scroll",function(){if(k&&(i=b.element(g).children().height(),k=!1,c.pageUI.prodCommentPageIndex++),i<=g.scrollTop+j&&!c.pageUI.prodCommentAjaxLoadFlag&&!c.pageUI.prodCommentLastPage){c.pageUI.prodCommentAjaxLoadFlag=!0,c.pageUI.jsonLoading=!0;var a=c.VCCtrl.getCurProdInfo();a&&a.goods_no&&(c.pageLoading=!0,d.getProdComment(a.goods_no,c.pageUI.prodCommentPageIndex).then(function(a){if(a.critList.total_count>0)for(var b=0;b<a.critList.items.length;b++)c.pageUI.prodComment.critList.items.push(a.critList.items[b]);else c.pageUI.prodCommentLastPage=!0;c.pageUI.prodCommentAjaxLoadFlag=!1,c.pageUI.jsonLoading=!0,k=!0})["catch"](function(){console.error("상품평 정보 없음."),c.pageUI.prodCommentAjaxLoadFlag=!1,c.pageUI.jsonLoading=!0})["finally"](function(){c.pageLoading=!1}))}})}}]),d.directive("ngTouchstart",function(){return{controller:function(a,b,c){function d(c){var d=b.attr("ng-touchstart");a.$event=c,a.$apply(d)}b.bind("touchstart",d)}}})}(window,window.angular);