function searchOrdDeliveryListClose(){$("#ordSearchDeliPop").hide(),$("#ordSearchDeliPop").find("iframe").remove(),scrollYN("Y","DELI"),$("#ordSearchDeliInfo input").trigger("change"),$("#change_mode").trigger("click"),$(document).scrollTop($("#addressInfoCtrlContainer").offset().top-150)}function scrollYN(a,b){"N"==a?($("html, body").css({overflow:"hidden"}),"DELI"==b&&$("body").on("scroll touchmove mousewheel",function(a){return a.preventDefault(),a.stopPropagation(),!1}),"Safari"!=browserChk()&&history.pushState("history1","")):($("html, body").css({overflow:"visible"}),"DELI"==b&&$("body").off("scroll touchmove mousewheel"),"Safari"!=browserChk()&&null!=history.state&&history.back())}function searchOrdDeliveryListPop(a,b){var c='<iframe id="deliIframe" src=""></iframe>',d=$("input[name=indlvpsn]").val(),e="/popup/ord_search_delivery_list.do?deli_cnt="+a+"&selectedDlvpSn="+d+"&single="+b;$("#ordSearchDeliPop").show(),$("#ordSearchDeliPop").html(c),$("#ordSearchDeliPop").find("iframe").attr("src",e),scrollYN("N","DELI")}function browserChk(){var a="",b=window.navigator.userAgent;return b.indexOf("Safari")>0&&(a=b.indexOf("Chrome")>0?"Chrome":"Safari"),a}function sendTclick(a){}!function(a,b,c){"use strict";var d=b.module("addressInfo",["lotteComm"]);d.controller("AddressInfoCtrl",["$scope","LotteCommon",function(a,b){}]),d.directive("addressInfo",["LotteCommon","$window","$timeout","$parse","$http",function(a,b,d,e,f){return{templateUrl:"/lotte/resources_dev/mylotte/address_info.html",replace:!0,link:function(a,b,d){a.has_address=!1,a.pageGubun=!1,"선물 확인"==a.subTitle&&(a.pageGubun=!0);var e=function(){if(a.giftData==c)setTimeout(function(){e()},500),console.log("load again");else{var b={};if(a.loginInfo.isLogin?(a.giftData.user_addr_info!=c&&a.giftData.user_addr_info.default_addr.addr1!=c&&(b=a.giftData.user_addr_info.default_addr,a.has_address=!0),a.giftData.ord_addr_info!=c&&a.giftData.ord_addr_info.addr1!=c&&(b=a.giftData.ord_addr_info,a.has_address=!0)):a.giftData.ord_addr_info!=c&&a.giftData.ord_addr_info.addr1!=c&&(b=a.giftData.ord_addr_info,a.has_address=!0),a.user_msg="배송메시지",a.has_address){var d=b.addr_tel.split("-");a.oinfo={indlvpsn:b.dlvp_sn,inpbasedlvpyn:"",inprmitnm:b.r_name,inpdlvpnm:b.addr_name,inpzip1:b.addr_post.substr(0,3),inpzip2:b.addr_post.substr(3,3),inpaddr1:b.addr1,inpaddr2:b.addr2,stnm_inp_zip1:"",stnm_inp_zip2:"",stnm_inp_addr1:"",stnm_inp_addr2:"",incellsctno:d[0],incelltxnono:d[1],incellendno:d[2]},null!=b.stnm_addr_post&&""!=b.stnm_addr_post&&(a.oinfo.stnm_inp_zip1=b.stnm_addr_post.substr(0,3),a.oinfo.stnm_inp_zip2=b.stnm_addr_post.substr(3,3),a.oinfo.stnm_inp_addr1=b.stnm_addr1,a.oinfo.stnm_inp_addr2=b.stnm_addr2)}else a.oinfo={indlvpsn:"",inpbasedlvpyn:"",inprmitnm:"",inpdlvpnm:"",inpzip1:"",inpzip2:"",inpaddr1:"",inpaddr2:"",stnm_inp_zip1:"",stnm_inp_zip2:"",stnm_inp_addr1:"",stnm_inp_addr2:"",incellsctno:"",incelltxnono:"",incellendno:""}}};setTimeout(function(){e()},5),a.getlastAddress=function(){var b={};if(""==a.oinfo.inpaddr1&&""==a.oinfo.stnm_inp_addr1)alert("주소찾기를 완료해주세요.");else{var c=$("#message").val();if(a.writeMessage&&(c=$("#message2").val(),c.length<1))return alert("배송메시지를 입력해주세요."),$("#message2").focus(),b;b={idx:0,is_default:a.oinfo.inpbasedlvpyn,dlvp_sn:a.oinfo.indlvpsn,r_name:a.oinfo.inprmitnm,addr_name:a.oinfo.inpdlvpnm,addr_post:a.oinfo.inpzip1+""+a.oinfo.inpzip2,addr1:a.oinfo.inpaddr1,addr2:a.oinfo.inpaddr2,addr_tel:a.oinfo.incellsctno+"-"+a.oinfo.incelltxnono+"-"+a.oinfo.incellendno,message:c,stnm_addr_post:a.oinfo.stnm_inp_zip1+""+a.oinfo.stnm_inp_zip2,stnm_addr1:a.oinfo.stnm_inp_addr1,stnm_addr2:a.oinfo.stnm_inp_addr2}}return b},a.writeMessage=!1,a.messageChange=function(){console.log("in",$("#message").val()),""==$("#message").val()&&(a.writeMessage=!0)},a.myAddrChange=function(b){b?(""!=a.oinfo.inpaddr1||""!=a.oinfo.stnm_inp_addr1)&&(a.has_address=!0):a.has_address=!1},a.checkField=function(a,b){var c=$(b).val();return""==c?(alert(a+" 입력해주세요."),$(b).focus(),!0):!1}}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","addressInfo"]);d.controller("giftcheckCtrl",["$scope","LotteCommon","$http","commInitData",function(a,b,d,e){a.loading=!1,a.state=0,a.showWrap=!0,a.contVisible=!0,a.subTitle="선물 확인",a.order_no=e.query.orderNo,a.key=decodeURI(e.query.key),a.test=decodeURI(e.query.test),a.presentListUrl=b.presentListUrl+"?"+baseParam,a.presentShop=b.mainUrl+"?"+baseParam+"&dispNo=5556743",a.appBanner=null,d.get(b.mainPopupData,{params:{}}).success(function(b){a.appBanner=b.app_down_popup[0]}),a.load=function(){var e={orderNo:a.order_no,KEY:a.key,mbr_no:a.loginInfo.mbrNo};d({url:b.giftCheckUrl,data:$.param(e),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(a.giftData=b,"0"==a.test&&(a.giftData.gift_state=0),"1"==a.giftData.gift_state)location.href=a.presentListUrl;else if("2"==a.giftData.gift_state||"3"==a.giftData.gift_state)a.state=2,a.subTitle="선물 확인 완료",a.checkGiftPage=!0,a.getGoodsList();else if("4"==a.giftData.gift_state)a.state=4,a.subTitle="선물 확인",a.checkGiftPage=!0,a.getGoodsList();else{if(a.giftData.gift_state==c)return void console.log("데이타 로드 실패");a.loading=!0}if(a.giftData.gift_msg_info.msg!=c&&(a.giftData.gift_msg_info.msg=a.giftData.gift_msg_info.msg.replace(/\n/g,"<br />")),a.loginInfo.isLogin&&a.giftData.user_addr_info!=c&&(a.myAddr_tab=!0),a.giftData.gift_msg_info.bg_color==c&&(a.giftData.gift_msg_info.bg_color="#ffffff"),a.zeroOpt=[],a.giftData.gift_prd_info.opt_item_lst!=c){var d=a.giftData.gift_prd_info.opt_item_lst;if(d.length>1)for(var e=0;e<d.length;e++)a.zeroOpt.push(d[e].opt_tval.split(" x "))}a.giftData.orderNo=a.order_no,a.giftData.ordDtlSn=a.giftData.gift_prd_info.ord_dtl_sn,a.giftData.ord_addr_info!=c&&null!=a.giftData.ord_addr_info&&a.giftData.ord_addr_info.addr_post!=c&&a.myAddrChange(!1)}).error(function(){})},setTimeout(function(){a.load()},500)}]),d.directive("lotteContainer",["LotteCommon","$http","LotteLink",function(b,d,e){return{templateUrl:"/lotte/resources_dev/mylotte/giftcheck_container.html",replace:!0,link:function(f,g,h){f.gotoApp=function(){e.appDeepLink("lotte","http://m.lotte.com",null,null)},f.checkGiftPage=!1,f.confirm_submit=function(e){var g={order_no:f.order_no,key:f.key,ordDtlSn:f.giftData.gift_prd_info.ord_dtl_sn,addr1:"",addr2:"",addr_name:"",addr_post:"",addr_tel:"",password:"",r_name:"",message:"",dlvp_sn:""};if(e){if(g=f.getlastAddress(),g.message==c)return;if(f.checkField("비밀번호를","#pass1")||f.checkField("비밀번호를","#pass2"))return;if($("#pass1").val()!=$("#pass2").val())return alert("비밀번호가 일치하지 않습니다."),$("#pass2").val(""),void $("#pass2").focus();if(0==$("#agreeInfoCheck:checked").length)return void alert("선물 수령을 위한 정보제공에 대하여 동의해주세요.");g.ordDtlSn=f.giftData.gift_prd_info.ord_dtl_sn,g.order_no=f.order_no,g.key=f.key,g.password=$("#pass1").val(),g.reject_msg=""}else{if(""==$("#refuse_message").val())return void alert("거절 메시지를 선택해주세요.");g.reject_msg=$("#refuse_message").val(),f.state=2}d.get(b.confirm_gift,{params:g}).success(function(b){if("0000"==b.result.result_code)$(a).scrollTop(0),f.subTitle="선물 확인 완료",f.checkGiftPage=!0,f.getGoodsList();else{if(b.result!=c){var d=b.result.error_msg;(d==c||""==d)&&(d="선물 확인 중 에러가 발생했습니다."),alert(d),console.log(b.result.result_code,b.result.error_msg)}e||location.reload()}}).error(function(a){console.log(a.result.result_code,a.result.error_msg),"ETC"==a.result.result_code&&location.reload()})},f.getGoodsList=function(){d.get(b.gift_epilogue,{params:null}).success(function(a){f.recom_prd_lst=a.recom_prd_lst}).error(function(){})},f.refuseLayerFlag=!1,f.refuse_rLayer=function(b){b&&$(a).scrollTop(0),f.refuseLayerFlag=b},f.optFlag=!1,f.changeOpt=function(){f.optFlag=!f.optFlag,f.optFlag&&f.initOptCheck()},f.getOptionString=function(){for(var a,b=[],c=f.giftData.gift_prd_info.opt_list.length,d=0;c>d;d++)a=$("#prod_option_"+d),b.push(a.val());return b.join(" x ")},f.saveOpt=function(){if(f.giftData.gift_prd_info.opt_item_lst!=c){for(var a,e=f.getOptionString(),g=-1,h=f.giftData.gift_prd_info.opt_item_lst,i=h.length,j="",k="",l=0,m=0;m<f.giftData.gift_prd_info.opt_list.length;m++)m>0&&(j+=" x "),j+=f.giftData.gift_prd_info.selected_opt[m].opt_value;for(m=0;i>m;m++)a=h[m],a.opt_tval==e&&(g=a.item_no,l=a.inv_qty),a.opt_tval==j&&(k=a.item_no);if(k==g)return void alert("동일한 옵션을 선택하셨습니다.");if(0==l)return void alert("재고 수량이 부족합니다.");if(!(0>g)){var n=b.presentDetailOption,o={ord_no:f.order_no,ord_dtl_sn:f.giftData.gift_prd_info.ord_dtl_sn,goods_no:f.giftData.gift_prd_info.goods_no,item_no:k,chg_item_no:g,rel_qty:f.giftData.gift_prd_info.rel_qty};d.get(n,{params:o}).success(function(a){if("0000"==a.result_code){alert("저장하였습니다."),f.optFlag=!1;for(var b=0;b<f.giftData.gift_prd_info.selected_opt.length;b++)f.giftData.gift_prd_info.selected_opt[b].opt_value=$("#prod_option_"+b).val();f.giftData.gift_prd_info.ord_dtl_sn=a.ord_dtl_sn}else{var d=a.error_msg;(d==c||""==d)&&(d="변경 사항을 저장하지 못했습니다."),alert(d)}}).error(function(){console.log("Data Error : 옵션 변경")})}}},f.productDetailPop=!1,f.detailHtml="",f.ProductDetailLayer=function(){var a={goods_no:f.giftData.gift_prd_info.goods_no};d.get(b.productProductDetailHtmlData,{params:a}).success(function(a){var b=a.max;b=f.replaceAll(b,'\\"','"'),b=f.replaceAll(b,"&#34;","'"),f.detailHtml=f.replaceAll(b,"\r\n",""),f.productDetailPop=!0}).error(function(){})},f.closeProductDetailLayer=function(){f.productDetailPop=!1},f.replaceAll=function(a,b,d){return a!=c&&null!=a&&""!=a&&(a=a.split(b).join(d)),a},f.gotoLink=function(c,d){var e="&tclick=m_DC_SrhResult_Clk_Prd_idx"+(d+1);a.location.href=b.prdviewUrl+"?"+f.baseParam+"&goods_no="+c.goods_no+e},f.initOptCheck=function(){for(var a=[0],b=f.giftData.gift_prd_info.opt_list,c=0;c<b[0].opt_value_lst.length;c++)a[0]=b[0].opt_value_lst[c],b.length>1?f.treecheck(a,1,b)&&$("#prod_option_0").find("option").eq(c+1).hide():f.checkZero(a)&&$("#prod_option_0").find("option").eq(c+1).hide()},f.checkOptCnt=function(a){var b=f.giftData.gift_prd_info.opt_list;if(b.length>1)for(var c,d=[],e=!0,g=0;g<b.length;g++)if(g>a){if($("#prod_option_"+g).find("option").show(),b[g].selectID=0,g<b.length-1){if(e){d.push(0);for(var h=0;h<b[g].opt_value_lst.length;h++)d[g]=b[g].opt_value_lst[h],f.treecheck(d,g+1,b)&&$("#prod_option_"+g).find("option").eq(h+1).hide();e=!1}}else if(e){d.push(0);for(var h=0;h<b[g].opt_value_lst.length;h++)d[g]=b[g].opt_value_lst[h],c=f.checkZero(d),c&&$("#prod_option_"+g).find("option").eq(h+1).hide()}}else{if(0==b[g].selectID){for(;g<b.length;g++)b[g].selectID=0;break}d.push($("#prod_option_"+g).val())}},f.treecheck=function(a,b,c){var d,e,g=!0;if(b<c.length-1)for(d=a.concat(0),e=0;e<c[b].opt_value_lst.length;e++)d[b]=c[b].opt_value_lst[e],f.treecheck(d,b+1,c)||(e=c[b].opt_value_lst.length,g=!1);else for(d=a.concat(0),e=0;e<c[b].opt_value_lst.length;e++){d[b]=c[b].opt_value_lst[e];var h=f.checkZero(d);h||(e=c[b].opt_value_lst.length,g=!1)}return g},f.checkZero=function(a){for(var b=0,c=!0,d=0;d<f.zeroOpt.length;d++){b=0;for(var e=0;e<f.zeroOpt[d].length;e++)a[e]==f.zeroOpt[d][e]&&b++;b==f.zeroOpt[d].length&&(d=f.zeroOpt.length,c=!1)}return c},f.appObj.isApp||(f.appDownBann=!0),f.appDownBnrClose=function(){f.appDownBann=!1}}}}])}(window,window.angular);
//# sourceMappingURL=/giftcheck.min.js.map