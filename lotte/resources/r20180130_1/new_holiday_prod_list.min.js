!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteUtil","lotteSideCtg","lotteCommFooter","lotteProduct","lotteNgSwipe"]);d.filter("pageRange",[function(){return function(a,b,c){for(var d=[],e=0;e<a.length;e++)e>=b*c&&(b+1)*c>e&&d.push(a[e]);return d}}]),d.controller("CateHolidayProdListCtrl",["$window","$location","$http","$scope","$timeout","$filter","LotteStorage","LotteCommon","commInitData",function(d,e,f,g,h,i,j,k,l){function m(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}g.showWrap=!0,g.contVisible=!0,g.productMoreScroll=!0,g.screenID="HolidayCateTpl",g.subTitle="",g.templateType="list",g.pageLoading=!0,(g.screenDataReset=function(){g.pageOptions={initPageParam:!1,tabShow:!1,tabIndex:0,sortIdx:0,tipShow:!1,selectStore:"A",selectDept:!1,selectCategory:0,selectCategoryCode:"",selectCategoryParentNo:0,selectCategoryDepth:1,selectBrand:[],brandSort:1,brandOrder:"-brnd_cnt",checkShipFree:!1,checkPoint:!1,checkDividFree:!1,checkSmartPic:!1,selectSmartPic:0,selectSmartPicText:"전체",smartPicBox:!1,detailOption1:null,detailOption2:null,detailOption3:null,sort:[{sortText:"판매순",sortClass:"updown",searchKey:"11"},{sortText:"상품평",sortClass:"updown",searchKey:"14"},{sortText:"신상품",sortClass:"updown",searchKey:"10"},{sortText:"가격",sortClass:"down",searchKey:"12"},{sortText:"가격",sortClass:"up",searchKey:"13"}]},g.screenData={page:0,pageSize:20,pageEnd:!1,disp_name:null,disp_no:null,idx:"",mGrpNo:"",goodsTotal:0,maxGoodsTotal:0,hasDept:!1,goodsList:[],D_CATE:[],L_CATE:[],CATE:[],ParentCateInfo:[],BrandList:[],StoreList:[],DetailDepth1:[],DetailDepth2:[],DetailDepth3:[]}})(),l.query.mGrpNo!=c&&(g.screenData.mGrpNo=l.query.mGrpNo),l.query.title!=c&&(g.screenData.disp_name=decodeURIComponent(l.query.title),g.subTitle=g.screenData.disp_name),l.query.curDispNo!=c&&(g.screenData.disp_no=l.query.curDispNo,g.pageOptions.selectCategory=g.screenData.disp_no),l.query.disp_no!=c&&(g.screenData.disp_no=l.query.disp_no,g.pageOptions.selectCategory=g.screenData.disp_no),l.query.idx!=c&&(g.screenData.idx=l.query.idx),g.curDispNo=g.screenData.disp_no;var n=parseInt(l.query.sort);isNaN(n)&&(n=0),(0>n||n>4)&&(n=0),g.pageOptions.sortIdx=n,"5560947"==g.curDispNo&&(g.pageOptions.sortIdx=3),g.curDispNoSctCd=73,g.tabResetCore=function(a){switch(a){case 1:g.pageOptions.selectStore="A",g.pageOptions.selectCategoryCode="",g.pageOptions.selectCategory=g.screenData.disp_no,g.pageOptions.selectCategoryDepth=1,g.tabResetCore(2),g.tabResetCore(3),g.tabResetCore(4),g.screenData.DetailDepth1=[],g.getSearchOptionData(null,{disp_no:g.screenData.disp_no,cate_depth:g.pageOptions.selectCategoryDepth});break;case 4:g.pageOptions.sortIdx=0,g.pageOptions.tipShow=!1}},g.tabReset=function(){g.tabResetCore(g.pageOptions.tabIndex),g.reSearch()},g.buildSearchUrl=function(){var a=k.cateHolidayProdListData+"?"+g.baseParam;return-1==location.href.indexOf(".ellotte.com")&&""!=g.screenData.mGrpNo&&(a+="&mGrpNo="+g.screenData.mGrpNo),g.pageOptions.selectDept&&(a+="&grpTp=D"),null!=g.pageOptions.detailOption3?(a+="&curDispNo="+g.pageOptions.detailOption3.disp_no,a+="&cateDepth="+g.pageOptions.detailOption3.cate_depth):null!=g.pageOptions.detailOption2?(a+="&curDispNo="+g.pageOptions.detailOption2.disp_no,a+="&cateDepth="+g.pageOptions.detailOption2.cate_depth):null!=g.pageOptions.detailOption1?(a+="&curDispNo="+g.pageOptions.detailOption1.disp_no,a+="&cateDepth="+g.pageOptions.detailOption1.cate_depth):(0!=g.pageOptions.selectCategory&&(a+="&curDispNo="+g.pageOptions.selectCategory),0!=g.pageOptions.selectCategoryDepth&&(a+="&cateDepth="+g.pageOptions.selectCategoryDepth)),a+="&sort="+g.pageOptions.sort[g.pageOptions.sortIdx].searchKey,g.screenData.page&&(a+="&page="+g.screenData.page),g.screenData.pageSize&&(a+="&dispCount="+g.screenData.pageSize),a},g.buildSearchOption=function(a){var b=k.mallCateAttrData+"?";return-1==location.href.indexOf(".ellotte.com")&&""!=g.screenData.mGrpNo&&(b+="&mGrpNo="+g.screenData.mGrpNo),b+="&cateNo="+a.disp_no,b+="&cateDepth="+a.cate_depth},g.getSearchOptionData=function(a,b){try{f.get(g.buildSearchOption(b)).success(function(b){1==a?g.screenData.DetailDepth1=b:2==a?g.screenData.DetailDepth2=b:3==a&&(g.screenData.DetailDepth3=b)})}catch(c){console.log(c)}},g.lrange=[],g.getProductData=function(){if(!g.screenData.pageEnd){g.screenData.page++,g.screenData.page>1?(g.sendTclick(g.tClickBase+g.screenID+"_Scl_Prd_page"+g.screenData.page),g.productListLoading=!0):g.pageLoading=!0,g.$parent.LotteSuperBlockStatus=!0;try{f.get(g.buildSearchUrl()).success(function(a){if(!g.screenData.L_CATE.length){g.pageOptions.initPageParam=!0,g.screenData.L_CATE=a.CateList.L_CATE,g.screenData.ParentCateInfo=a.cateInfo,g.pageOptions.minLimitPrice=a.goodsList.price_min?a.goodsList.price_min:0,g.pageOptions.maxLimitPrice=a.goodsList.price_max?a.goodsList.price_max:0,g.screenData.maxGoodsTotal=a.goodsList.rs_total_cnt,g.screenData.StoreList=a.StoreInfo;for(var c=0;c<g.screenData.StoreList.length;c++)"D_CATE"==g.screenData.StoreList[c].mall_nm&&"0"!=g.screenData.StoreList[c].cate_cnt&&(g.screenData.hasDept=!0)}g.screenData.goodsTotal=a.goodsList.rs_total_cnt,g.screenData.page>1?b.forEach(a.goodsList.items,function(a,b){g.screenData.goodsList.push(a)}):g.screenData.goodsList=a.goodsList.items,g.screenData.goodsTotal<g.screenData.page*g.screenData.pageSize&&(g.screenData.pageEnd=!0,g.productMoreScroll=!1),g.productListLoading=!1,g.$parent.LotteSuperBlockStatus=!1,g.pageLoading=!1}).error(function(){g.productListLoading=!1,g.$parent.LotteSuperBlockStatus=!1,g.pageLoading=!1})}catch(a){}}},g.reSearch=function(){g.productMoreScroll=!0,g.screenData.pageEnd=!1,g.screenData.page=0,g.screenData.goodsTotal=0,g.screenData.goodsList=[],b.element(d).scrollTop(0),g.getProductData()},g.getBrandSwipeSize=function(){if(g.screenData.BrandList.length){var a=parseInt(g.screenData.BrandList.length/8);return g.screenData.BrandList.length%8!=0&&a++,new Array(a)}return new Array};var o=j.getSessionStorage(g.screenID+"Loc"),p=j.getSessionStorage(g.screenID+"Data"),q=j.getSessionStorage(g.screenID+"ScrollY");if(o==a.location.href&&g.locationHistoryBack){var r=JSON.parse(p);g.pageLoading=!1,g.templateType=r.templateType,g.pageOptions=r.pageOptions,g.screenData=r.screenData,g.subTitle=g.screenData.ParentCateInfo.DISP_NM,h(function(){b.element(d).scrollTop(q)},800)}else g.getSearchOptionData(null,{disp_no:g.screenData.disp_no,cate_depth:g.pageOptions.selectCategoryDepth}),g.getProductData();b.element(d).on("unload",function(a){var c={};c.templateType=g.templateType,c.pageOptions=g.pageOptions,c.screenData=g.screenData,!l.query.localtest&&g.leavePageStroage&&(j.setSessionStorage(g.screenID+"Loc",e.absUrl()),j.setSessionStorage(g.screenID+"Data",c,"json"),j.setSessionStorage(g.screenID+"ScrollY",b.element(d).scrollTop()))}),g.cateViewFlag=!1,g.cateView=function(){g.sendTclick("m_DC_new_prod_list_Clk_Ttl"),g.cateViewFlag=!g.cateViewFlag},g.cateDepth1={},g.cateDepth2={},g.depthCurDispNo={},g.paramTitle=m("cateDepth1"),g.paramSubTitle=m("cateDepth2"),g.paramCurDispNo=m("curDispNo"),g.paramCurDispNo2=m("curDispNo2"),""==m("cateDepth1")?g.cateDepth1="":g.paramTitle.length>=1&&(g.cateDepth1=g.paramTitle),""==m("paramCurDispNo")?g.depthCurDispNo="":g.paramCurDispNo.length>=1&&(g.depthCurDispNo=g.paramCurDispNo),g.paramSubTitle.length>=1&&(g.cateDepth2=g.paramSubTitle),g.paramCurDispNo2.length>=1&&(g.curDispNo=g.paramCurDispNo2)}]),d.directive("lotteContainer",["$window","LotteCommon",function(a,c){return{templateUrl:"/lotte/resources_dev/category/m/new_holiday_prod_list_container.html",replace:!0,link:function(a,c,d){a.tabClick=function(b){a.sendTclick(a.tClickBase+a.screenID+"_Clk_Flt"+b),a.pageOptions.tabIndex==b?(a.pageOptions.tabIndex=0,a.pageOptions.tabShow=!1,a.pageOptions.tipShow=!1):(a.pageOptions.tabIndex=b,a.pageOptions.tabShow=!0)},a.sortClick=function(b){a.pageOptions.sortIdx!=b&&(a.sendTclick(a.tClickBase+a.screenID+"_Clk_Flt4_idx0"+b),a.pageOptions.sortIdx=b,a.reSearch())},a.tipShowClick=function(){a.pageOptions.tipShow=!a.pageOptions.tipShow},a.subCateClick=function(b,c,d){""==c&&null==d?a.sendTclick(a.tClickBase+a.screenID+"_Clk_Cat_A"):null==d?a.sendTclick(a.tClickBase+a.screenID+"_Clk_Cat_B"):a.sendTclick(a.tClickBase+a.screenID+"_Clk_Cat_C"),a.pageOptions.selectCategory==b.disp_no?(a.pageOptions.selectCategory=a.screenData.disp_no,a.pageOptions.selectCategoryDepth=1,a.pageOptions.selectCategoryCode="",a.pageOptions.detailOption1=null,a.pageOptions.detailOption2=null,a.pageOptions.detailOption3=null,a.screenData.DetailDepth1=[],a.screenData.DetailDepth2=[],a.screenData.DetailDepth3=[],a.pageOptions.cateRadioDep1="",a.pageOptions.cateRadioDep2="",a.pageOptions.cateRadioDep3="",a.getSearchOptionData(null,b)):(a.pageOptions.selectCategoryCode=c,a.pageOptions.selectCategory=b.disp_no,a.pageOptions.selectCategoryDepth=b.cate_depth,null!=d?(a.pageOptions.selectCategoryParentNo=d.disp_no,a.getSearchOptionData(1,b)):a.pageOptions.selectCategoryParentNo=b.disp_no),a.tabResetCore(2),a.tabResetCore(3),a.tabResetCore(4),a.reSearch()},a.storeClick=function(){a.reSearch()},a.tabClose=function(){a.pageOptions.tabShow=!1,a.pageOptions.tabIndex=0,b.element("#headerSpace").css("height",0)},a.selectSmartPicClick=function(b){null==b?(a.pageOptions.selectSmartPic=0,a.pageOptions.selectSmartPicText="전체"):(a.pageOptions.selectSmartPic=b.disp_no,a.pageOptions.selectSmartPicText=b.disp_nm),a.closeSamrtPicClick(),a.reSearch()},a.closeSamrtPicClick=function(){a.pageOptions.smartPicBox&&(a.dimmedClose(),a.pageOptions.smartPicBox=!1)}}}}])}(window,window.angular);