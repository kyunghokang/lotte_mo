!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteUtil","lotteSns"]);d.controller("EventSaunMainCtrl",["$scope","$http","$window","$timeout","LotteCommon","LotteUtil","$filter",function(a,b,c,d,e,f,g){function h(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}a.showWrap=!0,a.contVisible=!0,a.subTitle="구매사은신청",a.isShowThisSns=!0,a.loginAlertFlag=!1,a.allEventViewFlag=!0,a.myEventViewFlag=!1,a.eventInfoLoading=!0,a.joinEvetClickTitle="신청하기",a.joinEvetClickFlag=!0,a.eventInfo=[],a.share_img="",a.isShowLoadingImage=!0,a.evtNoParam=h("evt_no");var i=e.eventSaunMainData+"?evt_no="+a.evtNoParam;b.get(i).success(function(b){a.eventInfo=b.saun,a.eventInfoList=b.saun.fvr_info_list.items,a.eventInfoLoading=!1,a.joinButtonCheck(a.eventInfo.fvrPolcStrtAmt,a.eventInfo.totalAmount),a.isShowLoadingImage=!1}).error(function(b){a.eventInfoLoading=!1,a.isShowLoadingImage=!1,console.log("Error Data : ")}),d(function(){a.share_img=a.eventInfo.evtDtlImg1PathNm+a.eventInfo.evtDtlImg1FileNm},2e3),a.evtFvrTpTitle=function(a){if(null==a)return"L.POINT";switch(a){case"10":return"L.POINT";case"20":return"L-money";default:return"혜택"}},a.evtFvrTpValue=function(b){if(null==b)return g("number")(a.eventInfo.totalSaun);switch(b){case"10":return g("number")(a.eventInfo.totalSaun);case"20":return g("number")(a.eventInfo.totalSaun);default:return a.eventInfo.etcGoodNm}},a.goLoginClick=function(){var b="&targetUrl="+encodeURIComponent(c.location.href,"UTF-8");c.location.href=e.loginUrl+"?"+a.baseParam+b},a.myListClick=function(c){a.myEventViewFlag=!0,a.evtNo=c;var c=a.evtNo;a.totalMyAmount=0,a.eventMyist=[];var d=e.eventSaunDetailData+"?evt_no="+c;b.get(d).success(function(b){if(null!=b.saunApplyList){for(var c=0,d=0;d<b.saunApplyList.total_count;d++){var e=b.saunApplyList.items[d];e.evtNo=d,e.ordApplyPayAmt>0&&(c+=e.ordApplyPayAmt,a.eventMyist.push(e))}a.totalMyAmount=c}}).error(function(b,c,d,e){a.joinEvetClickFlag=!0,console.log("Error Data : ",c,d,e)}),a.dimmedOpen({target:"myList",callback:this.myListClose})},a.joinButtonCheck=function(b,c){b>c?(a.joinEvetClickTitle="대상 결제 금액이 부족합니다.",a.joinEvetClickFlag=!1):(a.joinEvetClickTitle="신청하기",a.joinEvetClickFlag=!0)},a.myListClose=function(){a.myEventViewFlag=!1,a.dimmedClose()},a.joinEventClick=function(d){if(a.loginInfo.isLogin)a.joinEvetClickFlag&&("N"==a.eventInfo.eventStatus?alert("신청기간이 아닙니다."):"Y"==a.eventInfo.areadyEnter?alert("이미 응모한 이벤트입니다."):"N"==a.eventInfo.enterPossible?alert("이벤트 응모 대상이 아닙니다."):b({url:"/json/event/regist_saun.json?evt_no="+d,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a,b,f,g){console.log(a.data_set.response_msg),console.log(b),alert(a.data_set.response_msg),c.location.href=e.eventSaunMain+"?evt_no="+d}).error(function(a,b,c,d){alert("error")}));else{alert("로그인 후 응모가능합니다.");var f="&targetUrl="+encodeURIComponent(c.location.href,"UTF-8");c.location.href=e.loginUrl+"?"+a.baseParam+f}},a.joinEventEndClick=function(){alert("이미 응모한 이벤트입니다.")}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/event/m/eventSaunMain_container.html",replace:!0,link:function(a,b,c){}}}),d.directive("myEventlist",["$window","$location",function(a,b){return{templateUrl:"/lotte/resources_dev/event/m/eventMyMoney.html",replace:!0,link:function(a,b,c){}}}]),d.filter("strToDate",[function(){return function(a){return""==a?"":a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2)}}]),d.filter("strToDate2",[function(){return function(a){return""==a?"":a.substr(0,4)+"/"+a.substr(5,2)+"/"+a.substr(8,2)}}])}(window,window.angular);var ajaxResponseFailHandler=function(a){alert("처리중 오류가 발생하였습니다."),a&&a()},ajaxResponseErrorHandler=function(a,b){if(a.error){var c=a.error.response_code,d=a.error.response_msg;if("9004"==c){var e="targetUrl="+encodeURIComponent(location.href,"UTF-8");location.href="/login/m/loginForm.do?"+e}else alert("["+c+"] "+d)}else alert("처리중 오류가 발생하였습니다.");b&&b()};