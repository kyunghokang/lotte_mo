function calcBytes(a){var b=0;for(i=0;i<a.length;i++){var c=a.charAt(i);escape(c).length>4?b+=2:"\n"==c?"\r"!=a.charAt(i-1)&&(b+=1):b+="<"==c||">"==c?4:1}return b}function maxLengthCheck(a,b,c,d){var e,f,g=c.value.length,h=parseInt(a),i="",j=0;if(0==g)null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h);else for(k=0;k<g;k++){if(e=c.value.charAt(k),"\n"==e&&j++,escape(e).length>4?h-=2:h--,0>h){alert("총 한글 "+a/2+"자 영문 "+a+"자 까지 쓰실 수 있습니다."),c.value=i;break}if(null!=b&j>parseInt(b)){alert("라인수 "+b+"라인을 넘을 수 없습니다."),j=0,f=i.length-1,c.value=i.substring(0,f);break}null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h),i+=e}}!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","dearpetSubCategory","lotteSns"]);d.controller("DearpetNewsCtrl",["$http","$scope","$window","$location","LotteCommon","commInitData","LotteStorage","$timeout",function(c,d,e,f,g,h,i,j){function k(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}d.isMain=!1,d.showWrap=!0,d.contVisible=!0,d.subTitle="",d.screenID="DearpetNews",d.pageLoading=!0,d.dispNo="",d.productListLoading=!0,d.productMoreScroll=!0,d.shareRendingURL=location.href,d.shareCodeis="MIMI TOUTOU",(d.screenDataReset=function(){d.screenData={page:0,disp_name:"",dispNo:"",curDispNo:"",cateNodeName:[],top_banner:[],showAllCategory:!1,selectCate1:h.query.beforeNo,selectCate2:0,selectCate3:0,selectedCategory:0,cate_list:[],event_list:[],event_list:[],pageSize:10,pageEnd:!1,galleryTotal:0}})();var l=h.query.scrollback;d.screenData.curDispNo=k("curDispNo"),d.subTitle=d.screenData.disp_name="뉴스",d.getCateNodeName=function(a,b){var c=[];switch(""!=a&&(c=a.split(",")),b){case 1:for(var e=0;e<d.screenData.cate_list.length;e++)null!=d.screenData.cate_list[e].sub_cate_list&&d.getCateNodeName(e+"",b+1);break;case 2:for(var e=0;e<d.screenData.cate_list[c[0]].sub_cate_list.length;e++)if(null!=d.screenData.cate_list[c].sub_cate_list[e].sub_cate_list)d.getCateNodeName(a+","+e,b+1);else if(d.screenData.cate_list[c[0]].sub_cate_list[e].disp_no==d.screenData.curDispNo)return d.screenData.cateNodeName[0]=d.screenData.cate_list[c[0]].disp_nm,d.screenData.cateNodeName[1]=d.screenData.cate_list[c[0]].sub_cate_list[e].disp_nm,void(d.screenData.cateNodeName[2]="");break;case 3:for(var e=0;e<d.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list.length;e++)if(d.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list[e].disp_no==d.screenData.curDispNo)return d.screenData.cateNodeName[0]=d.screenData.cate_list[c[0]].disp_nm,d.screenData.cateNodeName[1]=d.screenData.cate_list[c[0]].sub_cate_list[c[1]].disp_nm,void(d.screenData.cateNodeName[2]=d.screenData.cate_list[c[0]].sub_cate_list[c[1]].sub_cate_list[e].disp_nm)}},d.loadScreenData=function(a){if(console.log("스크린 데이터 로드..."),!d.screenData.pageEnd){d.screenData.page++,d.screenData.page>1?d.productListLoading=!0:d.pageLoading=!0;var b=g.petMalleventData+"?dispNo="+d.screenData.curDispNo+"&page="+d.screenData.page+"&pageSize="+d.screenData.pageSize;c.get(b).success(function(a){var b=[];if(b=a.dearpet_news,null!=b.event_list){b.event_list.items;d.screenData.event_list=b.event_list.items;try{d.screenData.event_old_list=b.event_old_list.items}catch(c){d.screenData.event_old_list=[]}d.screenData.pageEnd=!0,j(function(){for(var a=0;a<d.screenData.event_list.length;a++)d.screenData.event_list[a].big=!1,d.screenData.event_list[a].open=!1,$("#swaglist_cont"+a).height()>35&&(d.screenData.event_list[a].big=!0)},100),d.contMoreClick=function(a){a.open=!a.open,a.more=!a.more},d.screenData.galleryTotal<d.screenData.page*d.screenData.pageSize&&(d.screenData.pageEnd=!0,d.productMoreScroll=!1),d.productListLoading=!1,d.pageLoading=!1}d.screenData.cate_list.length||(d.screenData.cate_list=b.cate_list.items,d.sendCategoryData(b.cate_list.items))})}},d.getSubCateDataFunc,d.$on("getSubCateData",function(a,b){!d.getSubCateDataFun&&b&&(d.getSubCateDataFunc=b);try{d.screenData.cate_list.length&&d.sendCategoryData(d.screenData.cate_list)}catch(c){}}),d.sendCategoryData=function(a){d.getSubCateDataFunc&&d.getSubCateDataFunc(a)};var m=i.getSessionStorage(d.screenID+"Loc"),n=i.getSessionStorage(d.screenID+"Data"),o=i.getSessionStorage(d.screenID+"ScrollY");if(m==a.location.href&&d.locationHistoryBack){var p=JSON.parse(n);d.pageLoading=!1,d.pageOptions=p.pageOptions,d.screenData=p.screenData,j(function(){b.element(e).scrollTop(o)},800)}else d.loadScreenData(),"y"==l&&j(function(){b.element(e).scrollTop(o)},800);b.element(e).on("unload",function(a){var c={};c.pageOptions=d.pageOptions,c.screenData=d.screenData,!h.query.localtest&&d.leavePageStroage&&(i.setSessionStorage(d.screenID+"Loc",f.absUrl()),i.setSessionStorage(d.screenID+"Data",c,"json"),i.setSessionStorage(d.screenID+"ScrollY",b.element(e).scrollTop()))}),d.petShare=function(a){d.sendTclick("m_DC_SpeDisp_Dearpet_Clk_Shr"),d.showSharePop({tclick:"m_DC_SpeDisp_Dearpet_Clk_Shr"}),j(function(){getScope().noCdnUrl=location.href},300)}}]),d.filter("hidestr",function(){return function(a){var b="";if(a!=c){b=a.substr(0,3);for(var d=3;d<a.length;d++)b+="*"}return b}}),d.directive("lotteContainer",["$window","LotteCommon","$timeout",function(a,c,d){return{templateUrl:"/lotte/resources_dev/mall/pet/dearpet_news_container.html",replace:!0,link:function(d,e,f){d.mallMainClick=function(b){var e=c.petMallMainUrl+"?"+d.baseParam;b&&(e+="&tclick="+b),a.location.href=e},d.mallProductClick=function(b,e){var f=c.prdviewUrl+"?"+d.baseParam+"&goods_no="+b.goods_no+"&curDispNoSctCd=95";e&&(f+="&tclick="+e),a.location.href=f},d.eventClick=function(b,c){var e=b.img_link+"&"+d.baseParam;c&&(e+="&tclick="+c),a.location.href=e},d.idChange=function(a){for(var b=a.substr(0,3),c=3;c<a.length;c++)b+="*";return b};var g=b.element(a),h=b.element("body"),i=g.height(),j=h[0].scrollHeight,k=4;g.on("scroll",function(a){!d.productMoreScroll||d.productListLoading||d.pageLoading||(j=h[0].scrollHeight,k=g.width()>=640?2:4,j-i*k>i&&g.scrollTop()+i>=j-i*k&&d.loadScreenData())})}}}]),d.directive("subHeaderEach",["$window","AppDownBnrService","$timeout",function(a,c,d){return{replace:!0,link:function(a,e,f){a.subHeaderFixed=!0;b.element(e),a.subHeaderHeight;a.$on("winScroll",function(b,e){e.scrollPos>=c.appDownBnrInfo.height||e.scrollPos<0?a.headerFixed=!0:(a.headerFixed=!1,console.log("fix")),d(function(){a.$apply()})})}}}])}(window,window.angular),function(a,b,c){"use strict";b.module("dearpetSubCategory",["lotteComm"]).controller("petMallSubCtgCtrl",["$scope","commInitData",function(a,c){function d(c){var d=null;return b.forEach(a.pet_cate_data,function(a,e){return d?d:(c!=a.disp_no||d||(d=a),void b.forEach(a.sub_cate_list,function(a,e){c!=a.disp_no||d||(d=a),b.forEach(a.sub_cate_list,function(a,b){c!=a.disp_no||d||(d=a)})}))}),d}function e(b){if(b){a.pet_cate_data=b;var e=[c.query.beforeNo||null,c.query.curDispNo||null,c.query.cate3||null];e[1]==e[2]&&e.splice(2,1);for(var f=0;f<e.length;++f)if(e[f]){var g=d(e[f]);if(g&&a.pet_cate_linemap.push(g),!g.sub_cate_list)break}for(var h=a.pet_cate_linemap.length,f=h;3>f;++f){var i=a.pet_cate_linemap[a.pet_cate_linemap.length-1];if((i.sub_cate_list&&i.sub_cate_list.length||i.extra)&&g){var j=i.extra?i.extra[0]:i.sub_cate_list[0];a.pet_cate_linemap.push(j)}}a.connectCategoryDirectiveFunc&&a.connectCategoryDirectiveFunc()}}a.pet_cate_linemap=[],a.$emit("getSubCateData",e),a.connectCategoryDirectiveFunc=null,a.directiveIsCallController=function(b){return a.pet_cate_data?void b():void(a.connectCategoryDirectiveFunc=b)}}]).directive("petMallSubCtg",["$window","$timeout","LotteCommon","commInitData",function(c,d,e,f){return{templateUrl:"/lotte/resources_dev/mall/pet/dearpet_mall_sub_category.html",restrict:"E",replace:!0,link:function(g,h,i){function j(a){for(var b=0;b<g.pet_cate_linemap.length;++b)a!=b&&(g.pet_cate_linemap[b].active=!1)}function k(a){var b=e.petMallProdListUrl;if(("5566305"==a||"5566436"==a||"5566437"==a||"5566438"==a)&&(b=e.petMallgalleryUrl),"5585896"==a&&(b=e.petMalleventUrl),"5585895"==a&&(b=e.petMallStoryUrl),"5572261"==a){var c=g.pet_cate_data[6].sub_cate_list[0].disp_no;b=5585896==c?e.petMalleventUrl:e.petMallStoryUrl}return b}function l(a){if(!a)return[];if(a.length<10)return[a];for(var b=a.length/10,c=[],d=0;b>d;++d){for(var e=[],f=0;10>f;++f)a[10*d+f]&&e.push(a[10*d+f]);e.length&&c.push(e)}return c}function m(a){if(g.pet_cate_linemap[a].disp_no){switch(String(a)){case"0":g.currentCateList=l(g.pet_cate_data);break;default:g.currentCateList=l(g.pet_cate_linemap[a-1].sub_cate_list)}g.select_depth_index=a,g.swipeIndex=0,g.select_disp_no=g.pet_cate_linemap[a].disp_no}}function n(){var a=b.element(c).width();return 360>a?13:a>450&&640>a?19:a>640?31:18}function o(){for(var a=0,b=n(),c=0;c<g.pet_cate_linemap.length;++c)a+=g.pet_cate_linemap[c].disp_nm.length;if(a>b){var d=a-b,e=g.pet_cate_linemap[g.pet_cate_linemap.length-1];e.cut_name=e.disp_nm.substr(0,e.disp_nm.length-d)+"..."}}g.currentCateList,g.select_disp_no,g.chkNo,g.swipeIndex=0,g.select_depth_index=-1,g.swipe_item_width=b.element(".dearpet_mall_sub_category").width(),g.swipeSlideFinish=function(a){g.swipeIndex=a},g.subcateClick=function(a){j(a),g.currentCateList=null,g.select_disp_no=null,g.pet_cate_linemap[a].active=!g.pet_cate_linemap[a].active,g.pet_cate_linemap[a].disp_no&&g.sendTclick("m_DC_SpeDisp_Dearpet_Clk_"+g.pet_cate_linemap[a].disp_no),g.pet_cate_linemap[a].active&&m(a)},g.subcateClose=function(){g.currentCateList=null,g.select_disp_no=null,g.select_depth_index=-1,j(null)},g.subcateLink=function(b,c){if(console.log(b+"####"),b){var d="",e="",f="",h=2,i=k(b);switch(String(g.select_depth_index)){case"0":e=b;try{d=g.pet_cate_data[c].sub_cate_list[0].disp_no,d||(d=b)}catch(j){d=b}break;case"1":e=g.pet_cate_linemap[0].disp_no,d=b,h=3;break;case"2":e=g.pet_cate_linemap[0].disp_no,d=g.pet_cate_linemap[1].disp_no,f=d===b?"":b,h=3}i+="?"+g.baseParam+"&beforeNo="+e+"&curDispNo="+d+"&cate3="+f+"&chkDepth="+h,i+="&tclick=m_DC_SpeDisp_Dearpet_Clk_"+b,a.location.href=i}},g.swipeObj={getCtrl:function(a){g.swipeObj.ctrl=a},ctrl:null},g.currentSwipeCategory=function(a){a&&d(function(){g.swipeObj.ctrl.moveIndex(a)},500)},g.directiveIsCallController(function(){d(function(){try{var a=1;f.query.chkDepth&&3==g.pet_cate_linemap.length&&(a=Number(f.query.chkDepth)-1),g.pet_cate_linemap[a].active=!0,g.select_disp_no=g.pet_cate_linemap[a].disp_no,g.chkNo=a,m(a)}catch(b){}})}),b.element(c).bind("resize",function(a){o()})}}}])}(window,window.angular);