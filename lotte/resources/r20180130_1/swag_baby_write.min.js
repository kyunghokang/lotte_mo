function calcBytes(a){var b=0;for(i=0;i<a.length;i++){var c=a.charAt(i);escape(c).length>4?b+=2:"\n"==c?"\r"!=a.charAt(i-1)&&(b+=1):b+="<"==c||">"==c?4:1}return b}function maxLengthCheck(a,b,c,d){var e,f,g=c.value.length,h=0,i="",j=0;if(0==g)null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h);else for(k=0;k<g;k++){if(e=c.value.charAt(k),"\n"==e&&j++,escape(e).length>4?h+=2:h++,h>350){alert("총 한글 "+a/2+"자 영문 "+a+"자 까지 쓰실 수 있습니다."),c.value=i;break}if(null!=b&j>parseInt(b)){alert("라인수 "+b+"라인을 넘을 수 없습니다."),j=0,f=i.length-1,c.value=i.substring(0,f);break}null!=document.getElementById("spn_input_char")&&(document.getElementById("spn_input_char").innerText=h),i+=e}}!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter"]);d.controller("SwagBabyWriteCtrl",["$http","$scope","LotteCommon","LotteUtil","LotteForm","$timeout","$window","LotteStorage","$location",function(a,d,e,f,g,h,j,k,l){function m(){return!0}function n(){a.get("/json/mall/swag_write.json",{}).success(function(a){d.input.login_id=a.swag_write.login_id,d.input.mbr_email=a.swag_write.mbr_email,d.input.mbr_nm=a.swag_write.mbr_nm,d.input.mbr_no=a.swag_write.mbr_no,d.input.site_no=a.swag_write.site_no}).error(function(a){ajaxResponseErrorHandler(a)})}d.showWrap=!0,d.contVisible=!0,d.subTitle="육아 TIP 작성",d.screenID="육아 TIP 작성",d.top_title=k.getSessionStorage("param_more1"),d.dispNo=k.getSessionStorage("param_more2"),d.top_title==c&&(d.top_title=""),null==d.dispNo&&(d.dispNo="5571270"),d.input={},d.input.swagTxt="",d.isNewestApp=m(),b.element(document).ready(function(){h(function(){if(d.appObj.isApp){var a=b.element(".appPhotoArea");if(d.appObj.isAndroid)try{j.lottepetswag.callAndroid("swag://position?top="+a.offset().top)}catch(c){}else location.href="swag://position?top="+a.offset().top,console.log("SEND APP TOP POSI",a.offset().top)}},200)}),d.attachImage=function(){d.appObj.isApp?location.href="ghost://CommentWithPhoto":confirm("롯데닷컴 앱에서 이용 가능합니다. 지금 설치하시겠습니까?")&&(location.href=e.appDown+"?"+d.baseParam)},d.cancel=function(){if(confirm("육아TIP 작성을 취소하시겠습니까?")){var a=l.absUrl().split("&"),b=[];for(i=0;i<a.length;i++)a[i].indexOf("mcate")>-1&&(b=a[i].split("="));location.replace(e.infantMainUrl+"?"+d.baseParam+"&dispNo="+d.dispNo+"&dcate=2&mcate="+(b[1]||""))}},d.save=function(){var a=l.absUrl().split("&"),b=[];for(i=0;i<a.length;i++)a[i].indexOf("mcate")>-1&&(b=a[i].split("="));var c=d.input.swagTxt,f=document.querySelector("#reviewTxt");return 0==c.trim().length?(alert("내용을 작성해 주세요."),f.focus(),!1):calcBytes(c)<6?(alert("내용을 한글 3자 이상 입력하세요."),f.focus(),!1):calcBytes(c)>350?(alert("내용은 750자[한글기준] 이내로 제한되어 있습니다."),f.focus(),!1):(g.FormSubmitForAjax(e.infantTipWriteCheckData+"?swagTxt="+c).success(function(a){if("0000"!=a.chk_swag_cont.response_code)alert(a.chk_swag_cont.response_msg);else{if(d.appObj.isApp){var c="swag://writeSwag";return c+="?swagTxt="+encodeURIComponent(d.input.swagTxt),c+="&loginId="+d.input.login_id,c+="&mbrNo="+d.input.mbr_no,c+="&mbrNm="+d.input.mbr_nm,c+="&mbrEmail="+d.input.mbr_email,c+="&isPhoto=N&site_no="+d.input.site_no,c+="&imageServerURL=/mobile/swagBabyImgParamReq.lotte&dispNo="+d.dispNo,c+="&returnUrlData=/mall/baby/baby_main.do?"+d.baseParam+"&dispNo="+d.dispNo+"&dcate=2&mcate="+(b[1]||""),d.isNewestApp||(c+="&radio1=",c+="&radio2=",c+="&radio3=",c+="&radio4=",c+="&radio5=",c+="&radio6=",c+="&check_cont=",c+="&img_no=",c+="&img_file_1=",c+="&img_file_2=",c+="&img_file_3=",c+="&img_file_4=",c+="&img_path_1=",c+="&img_path_2=",c+="&img_path_3=",c+="&img_path_4=",c+="&prdt_clor_eval_desc=",c+="&prdt_size_eval_desc=",c+="&use_flag=",c+="&wrtr_pur_dt="),console.log(c),void h(function(){location.href=c},200)}var c=e.swagWriteData+"?bbcNo="+d.bbc_no+d.baseParam;g.FormSubmitForAjax(c,d.input).success(function(a){h(function(){location.replace(e.infantMainUrl+"?"+d.baseParam+"&dispNo="+d.dispNo+"&dcate=2&mcate="+(b[1]||""))},200)}).error(function(a){ajaxResponseErrorHandler(a)})}}),!1)},n()}]),d.directive("lotteContainer",["$timeout","$http",function(a,b){return{templateUrl:"/lotte/resources_dev/mall/baby/swag_write_container.html",replace:!0,link:function(a,b,c){}}}])}(window,window.angular);var ajaxResponseErrorHandler=function(a,b){if(a.error){var c=a.error.response_code,d=a.error.response_msg;if("9004"==c){var e="targetUrl="+encodeURIComponent(location.href,"UTF-8");location.href="/login/m/loginForm.do?"+e}else alert("["+c+"] "+d)}else alert("처리중 오류가 발생하였습니다.");b&&b()};