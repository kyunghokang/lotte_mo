!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter"]);d.controller("smartAlarmListCtrl",["$scope","LotteCommon","$http","$filter","LotteUtil","$window","$location","LotteStorage",function(b,c,d,e,f,g,h,i){if(b.showWrap=!0,b.contVisible=!0,b.subTitle="알림",b.pushConfirm=!0,b.app=f.isApp(),b.tabControl=b.app?"first":"second",b.locationHistoryBack){var j=i.getSessionStorage("smartAlarmListTabControl");null!=j&&"undefined"!=typeof j&&(b.tabControl=j)}b.startledNewAlarm=!1,b.smartNewAlarm=!1,b.switchTab=function(a){b.tabControl=a,i.setSessionStorage("smartAlarmListTabControl",b.tabControl),"first"==a?b.smartNewAlarm=!1:"second"==a?b.startledNewAlarm=!1:"third"==a&&(b.startledNewAlarm=!1,b.smartNewAlarm=!1)},b.setAlarmList=function(c){if(i.setLocalStorage("amlist",c),f.isApp()&&f.boolAndroid(navigator.userAgent))try{a.JsObject.callAndroid("amlist="+c)}catch(d){}b.shareStorage("local","amlist",c)},b.getStartledAlarmList=function(){b.startledAlarmLoading=!0,d.get(c.startledAlarmListData+"?"+b.baseParam+"&amlist="+encodeURIComponent(i.getLocalStorage("amlist"))).success(function(a){a.startled_alarm_list.ntc_rcv_yn?(b.startledAlarmEmpty=!a.startled_alarm_list.alarm_list.total_count,b.startledAlarmList=a.startled_alarm_list.alarm_list.items,b.startledNewAlarm=a.startled_alarm_list.new_alarm,b.setAlarmList(a.startled_alarm_list.alarm_txt)):b.pushConfirm=!1,b.getSmartAlarmList(),b.startledAlarmLoading=!1}).error(function(a){b.getSmartAlarmList(),ajaxResponseErrorHandler(a),b.startledAlarmLoading=!1})},b.getSmartAlarmList=function(){b.smartAlarmLoading=!0,d.get(c.smartAlarmListData+"?"+b.baseParam+"&amlist="+encodeURIComponent(i.getLocalStorage("amlist"))).success(function(a){b.smartAlarmEmpty=!a.smart_alarm_list.alarm_list.total_count,b.smartAlarmList=a.smart_alarm_list.alarm_list.items,b.smartNewAlarm=a.smart_alarm_list.new_alarm,b.setAlarmList(a.smart_alarm_list.alarm_txt),i.setLocalStorage("smart_alarm_view_time",a.smart_alarm_list.alarm_view_time),b.smartAlarmLoading=!1}).error(function(a){ajaxResponseErrorHandler(a),b.smartAlarmLoading=!1})},b.pushConfirm&&b.app?b.getStartledAlarmList():b.getSmartAlarmList();try{b.emailBargainLoading=!0,d.get(c.emailBargainListData+"?"+b.baseParam).success(function(a){b.emailBargainEmpty=!a.email_bargain_list.email_list.total_count,b.emailBargainList=a.email_bargain_list.email_list.items,b.emailBargainLoading=!1}).error(function(a){ajaxResponseErrorHandler(a),b.emailBargainLoading=!1})}catch(k){console.error(k)}b.linkToStartledAlarm=function(a,e){var f=b.startledAlarmList[a].app_link;f+=(-1!=f.indexOf("?")?"&":"?")+b.baseParam;var g=b.startledAlarmList[a];g.read_yn="Y",d({url:c.startledAlarmReadData+"?"+b.baseParam,data:"user_msg_id="+g.user_msg_id+"&msg_id="+g.msg_id,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(a){location.href=f}).error(function(a){location.href=f}),e.preventDefault()},b.getSmartAlarmLinkUrl=function(a){var d=b.smartAlarmList[a];return"NTC_CART"==d.sum_tgt_sct_cd?c.cateLstUrl+"?"+b.baseParam:"/product/product_view.do?"+b.baseParam+"&goods_no="+d.goods_no},b.showAppConfig=function(){b.sendTclick("m_DC_MyPage_Clk_Btn_24"),f.boolAndroid(navigator.userAgent)?a.lottebridge.opensetting("on"):f.boolAppInstall(navigator.userAgent)&&(location.href="lottebridge://opensetting")}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/planshop/m/smartAlarmList_container.html",replace:!0,link:function(a,b,c){}}})}(window,window.angular);var ajaxResponseFailHandler=function(a){alert("처리중 오류가 발생하였습니다."),a&&a()},ajaxResponseErrorHandler=function(a,b){if(a.error){var c=a.error.response_code,d=a.error.response_msg;if("undefined"!=typeof movePage&&movePage)return;if("9004"==c){movePage=!0;var e="targetUrl="+encodeURIComponent(location.href,"UTF-8");location.href="/login/m/loginForm.do?"+e}else alert("["+c+"] "+d)}else alert("처리중 오류가 발생하였습니다.");b&&b()};