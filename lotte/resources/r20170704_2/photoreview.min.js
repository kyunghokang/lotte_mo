!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteSns","lotteCommFooter","ngPinchZoom"]);d.filter("trustUrl",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),d.directive("videoPoster",[function(){return{restrict:"A",link:function(a,c,d){d.videoPoster&&b.element(c).attr("poster",d.videoPoster)}}}]),d.directive("videoSource",[function(){return{restrict:"A",link:function(a,c,d){d.videoSource&&b.element(c).attr("src",d.videoSource)}}}]),d.controller("photoreviewCtrl",["$http","$scope","LotteCommon","commInitData","$window","$timeout","$compile",function(a,c,d,e,f,g,h){c.showWrap=!0,c.contVisible=!0,c.subTitle="고객 등록 콘텐츠",c.screenID="고객 등록 콘텐츠",(c.screenDataReset=function(){c.pageOptions={},c.screenData={page:0,pageSize:20,pageEnd:!1}})();var i=e.query.goods_no,j=e.query.usm_goods_no,k=e.query.totCnt;c.goods_img=e.query.goods_img,c.sid=parseInt(e.query.id),c.sid||(c.sid=0),c.sid_sub=0,c.mgoods_nm||(c.mgoods_nm=""),c.reqDetailParam={usm_goods_no:j,goods_no:i,photoview:"Y",totCnt:k};var l=5;l=parseInt(b.element(f).width()/74+1),a.get(d.commentCommentViewMobileData,{params:c.reqDetailParam}).success(function(a){try{c.totaldata=a.data_set.product_review.items,c.baseinfo=a.data_set,c.max=c.totaldata.length-1,c.dataset=[],c.photolist=[],g(function(){if(c.scl=0,c.dataset=c.totaldata,c.setInfo(c.sid),c.goods_img||(c.goods_img=c.photolist[0].img_url),g(function(){$(".infopop").hide()},3e3),c.appObj.isApp){var a=0,d=0;b.element(f).on("scroll",function(){d=$(f).scrollTop(),d-a>10?$(".bottomcont").removeClass("barsize"):-10>d-a&&$(".bottomcont").addClass("barsize"),a=d})}},100)}catch(d){console.log(d)}}).error(function(){console.log("Data Error : getCommentViewListPaging 실패")}),c.resizeVideoHeight=function(){b.element("div.video_wrap").each(function(a,b){var c=$(b);c.css({height:c.find("video").height()})})}}]),d.directive("lotteContainer",["$http","$timeout",function(a,c){return{templateUrl:"/lotte/resources_dev/product/m/photoreview_container.html",replace:!0,link:function(d,e,f){function g(a,b,c,e){if(""!=a){var f=a.split("|");d.photolist.push({img_url:"http://image.lotte.com"+f[0],index:b,id:c,vdo_url:e})}}d.moveEnd=function(a){},d.movePhoto=function(a){d.sid_sub+=a,d.sid_sub<0?(d.sid+=a,d.sid<0&&(d.sid=d.max),d.setInfo(d.sid),d.sid_sub=d.photolist.length-1,b.element(".photolistbox").animate({scrollLeft:71*d.sid},500)):d.sid_sub>=d.photolist.length&&(d.sid+=a,d.sid>d.max&&(d.sid=0),d.setInfo(d.sid),b.element(".photolistbox").animate({scrollLeft:71*d.sid},500))},d.setInfo=function(a){d.sid=a,d.sid_sub=0,d.sComment=d.dataset[a],d.sComment&&(d.photolist=[],g(d.sComment.img_path_1_nm+d.sComment.img_file_1_nm,0,a,d.sComment.mpic_url_addr),g(d.sComment.img_path_2_nm+d.sComment.img_file_2_nm,1,a),g(d.sComment.img_path_3_nm+d.sComment.img_file_3_nm,2,a),setTimeout(function(){autoVideoPlay("autoVideo1","#autoVideo1"),d.resizeVideoHeight()},100),setTimeout(function(){d.resizeVideoHeight()},1e3),setTimeout(function(){d.resizeVideoHeight()},2500)),d.control&&d.control.init()},d.getControl1=function(a){d.control=a},d.imgload=function(a){c(function(){d.imageSetSize(a)},600)},d.imageSetSize=function(a){var b=$("#imgbox_"+a),e=b.width(),f=b.height();f>100?(f>e?(b.find("img").height(e),b.find("img").width(parseInt(e*e/f))):e>f&&b.find("img").css({"margin-top":parseInt((e-f)/2)+"px"}),b.addClass("loaded")):c(function(){d.imageSetSize(a)},100)},d.barsize=!0,d.recomm_click=function(b){d.loginInfo.isLogin?a.get("/json/comment/comment_recomm_write.json?gdas_no="+b.gdas_no+"&goods_no="+d.reqDetailParam.goods_no).success(function(a){"reg_success"==a.result?(alert("추천하셨습니다."),b.recomm_cnt+=1,b.ok=!0):"reg_clv_success"==a.result?(alert("추천하셨습니다.\n클로버 20개 적립되었습니다.\nID당 1일 3회까지 지급됩니다."),b.recomm_cnt+=1,b.ok=!0):"reg_duplicate"==a.result?alert("이미 추천하셨습니다."):"reg_mywrit"==a.result?alert("본인이 작성한 상품평에는 추천하실 수 없습니다."):alert("다시 한번 시도해주시기 바랍니다.")}):d.loginMoveProc("","N")}}}}]),d.filter("splitimg",["$sce",function(a){return function(a,b){var c=a.split("|");return c[0]}}])}(window,window.angular),angular.module("ngPinchZoom",[]).directive("ngPinchZoom",function(){function a(a,b,c){function d(a){var b=a.originalEvent?a.originalEvent.touches:a.touches;x=b[0].clientX,y=b[0].clientY,t=r,u=s,z=0,A=0}function e(a){var c=a.originalEvent?a.originalEvent.touches:a.touches;""===k&&(1===c.length&&n>1?k="swipe":2===c.length&&(k="pinch",p=n,m=g(c),v=c[0].clientX-parseInt((c[0].clientX-c[1].clientX)/2,10)-b[0].offsetLeft-t,w=c[0].clientY-parseInt((c[0].clientY-c[1].clientY)/2,10)-b[0].offsetTop-u)),"swipe"===k?(a.preventDefault(),z=c[0].clientX-x,A=c[0].clientY-y,r=t+z,s=u+A,h()):"pinch"===k&&(a.preventDefault(),l=g(c),o=l/m,n=o*p,r=v*(1-o)+t+z,s=w*(1-o)+u+A,h())}function f(a){var b=a.originalEvent?a.originalEvent.touches:a.touches;""===k||b.length>0||(1>n?(n=1,r=0,s=0):n>q?(n=q,o=n/p,r=v*(1-o)+t+z,s=w*(1-o)+u+A):(r>0?r=0:i*(1-n)>r&&(r=i*(1-n)),s>0?s=0:j*(1-n)>s&&(s=j*(1-n))),h(.1),k="")}function g(a){var b=Math.sqrt(Math.pow(a[0].clientX-a[1].clientX,2)+Math.pow(a[0].clientY-a[1].clientY,2));return parseInt(b,10)}function h(a){var c=a?"all cubic-bezier(0,0,.5,1) "+a+"s":"",d=[n,0,0,n,r,s],e="matrix("+d.join(",")+")";b.css({"-webkit-transition":c,transition:c,"-webkit-transform":e+" translate3d(0,0,0)",transform:e})}console.log("pinch zoom -----");var i,j,k="",l=0,m=0,n=1,o=1,p=1,q=parseInt(c.maxScale,10);(isNaN(q)||1>=q)&&(q=3);var r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=new Image;B.onload=function(){i=b[0].clientWidth,j=b[0].clientHeight,b.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),b.on("touchstart",d),b.on("touchmove",e),b.on("touchend",f)},c.ngSrc?B.src=c.ngSrc:B.src=c.src}var b={restrict:"A",scope:!1,link:a};return b});