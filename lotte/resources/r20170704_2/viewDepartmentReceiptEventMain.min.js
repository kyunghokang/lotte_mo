!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteUtil"]);d.controller("ReceiptEventCtrl",["$scope","$http","$window","LotteCommon","LotteUtil",function(a,c,d,e,f){a.showWrap=!0,a.contVisible=!0,a.subTitle="영수증이벤트",a.departmentViewFlag=!0,a.dotcomViewFlag=!1,a.checkMyEventViewFlag=!1,a.recptNumber=null,a.onlyNumbers=/^\d+$/;var g=e.recieptDataUrl;e.recieptIframeUrl;c.get(g).success(function(b){a.receiptListData=b.receipt,a.shopListData=b.receipt.shop_list,a.resultRecieptListData=b.receipt.receipt_apply_list,a.orderListData=b.receipt.order_list}).error(function(a,b,c,d){console.log("Error Data : ",b,c,d)}),a.departmentClick=function(){a.departmentViewFlag=!0,a.dotcomViewFlag=!1},a.dotcomClick=function(){a.departmentViewFlag=!1,a.dotcomViewFlag=!0},a.checkMyEvent=function(){a.checkMyEventViewFlag=!0},b.isValue=function(a){return!(null===a||!b.isDefined(a)||b.isNumber(a)&&!isFinite(a))},a.receiptEventClick=function(f,g,h,i,j){a.recptNumber=f+g+h+i,a.evtShopNm=j;var k=a.recptNumber,l=a.evtShopNm=j;if(b.isDefined(j))if(b.isDefined(f)&&b.isDefined(g)&&b.isDefined(h)&&b.isDefined(i))if(20!=a.recptNumber.length)alert("응모번호를 20자로 입력하셔야 합니다.");else if(a.loginInfo.isLogin)c({method:"POST",url:e.recieptVoteUrl+"?recpt_no="+k+"&evt_sbsc_path_cd=J560&recpt_evt_tgt_cd=31&ordList=&saveUrl=DEPT&evt_shop_sn="+l,data:{recptNumbers:k},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}});else{if(!confirm("롯데 패밀리 회원 로그인 후 참여하실 수 있습니다."))return!1;var m="&targetUrl="+encodeURIComponent(d.location.href,"UTF-8");d.location.href=e.loginUrl+"?"+a.baseParam+m}else alert("응모번호를 입력하셔야 합니다.");else alert("사용백화점을 선택하셔야 합니다.")},a.orderEventClick=function(b){a.orderNumber="";var f=a.orderNumber;if(!a.appObj.isIOS)return alert("영수증 이벤트는 엘롯데 app에서 응모가 가능합니다."),!1;if(!a.appObj.isAndroid)return alert("영수증 이벤트는 엘롯데 app에서 응모가 가능합니다."),!1;if(a.loginInfo.isLogin)c({method:"POST",url:e.recieptVoteUrl+"?recpt_no&evt_sbsc_path_cd=J560&recpt_evt_tgt_cd=31&ordList="+b+"&saveUrl=DEPT&evt_shop_sn="+evt_shop_sn,data:{orderNo:f},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}});else{if(!confirm("롯데 패밀리 회원 로그인 후 참여하실 수 있습니다."))return!1;var g="&targetUrl="+encodeURIComponent(d.location.href,"UTF-8");d.location.href=e.loginUrl+"?"+a.baseParam+g}},a.myInfoChangClick=function(){if(a.loginInfo.isLogin)d.location.href=e.changeMyInfoUrl+"?sid=NMELLOTTE&returnurl=http%3A%2F%2Fm.ellotte.com%2Fmylotte%2Fm%2Fmyellotte.do%3Fc%3Dmlotte%26udid%3D%26v%3D%26cn%3D%26cdn%3D%26schema%3D%26tclick%3Dm_mylayer_mylotte&main_url=http%3A%2F%2Fm.ellotte.com%2Fmain.do%3Fc%3Dmellotte%26udid%3D%26v%3D%26cn%3D%26cdn%3D&custid=Pyu/aLhm0OOuX6oFuZJM2qjhkToHASLCq2qN1101FpI=&loginid="+LotteCookie.getCookie("LOGINID");else{var b="&targetUrl="+encodeURIComponent(d.location.href,"UTF-8");d.location.href=e.loginUrl+"?"+a.baseParam+b}}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/event/m/viewDepartmentReceiptEventMain_container.html",replace:!0,link:function(a,b,c){}}}),d.directive("numericOnly",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){var b=a?a.replace(/[^\d.-]/g,""):null;return b!=a&&(d.$setViewValue(b),d.$render()),b})}}})}(window,window.angular);var transformJsonToParam=function(a){var b=[];for(var c in a)if(Array.isArray(a[c]))for(var d=0;d<a[c].length;d++)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]));else b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};