!function(a,b,c){"use strict";var d=b.module("addressInfo",["lotteComm"]);d.controller("AddressInfoCtrl",["$scope","LotteCommon",function(a,b){}]),d.directive("addressInfo",["LotteCommon","$window","$timeout","$parse","$http",function(a,b,d,e,f){return{templateUrl:"/lotte/resources_dev/mylotte/address_info.html",replace:!0,link:function(b,d,e){b.myAddr_tab=!1,b.addressTab=!1,b.searchJListInput=!0,b.searchJListInput2=!0,b.searchJListFlag=!1,b.searchJList,b.moreAddress=!1,b.seq3_J_1_flag=!1,b.zipcode,b.addrData,b.searchAddressFlag=!1,b.addr_layer=!1,b.selectedAddress=null,b.editMode=!1,b.s_init=function(a){b.searchJListInput=!0,b.searchJListInput2=!0,b.searchJListFlag=!1,b.searchAddressFlag=!1,b.searchJList=[],b.moreAddress=!1,b.seq3_J_1_flag=!1,b.zipcode="",b.addrData=null,$("#inp_seq1_J_1").val(""),$("#key1_seq1_N_1").val(""),$("#key2_seq1_N_1").val(""),$("#key3_seq1_N_1").val(""),$("#key4_seq1_N_1").val(""),$("#key5_seq1_N_1").val(""),b.address_post="",b.address1="",b.address2="",b.inpcell1="010",b.inpcell2="",b.inpcell3="",(a==c||"all"==a)&&(b.addressTab=!1,b.inprmitnm="",b.inpdlvpnm="",b.editMode=!1,null!=b.selectedAddress&&$('input:radio[name="detail_list"]').prop("checked",!1))},b.search_step1=function(a){b.s_init("sa_btn"),b.searchAddressFlag=a},b.search_step2=function(a){b.searchJListInput=!0,b.searchJListInput2=!0,b.searchJListFlag=!1,b.searchJList=[],b.moreAddress=!1,b.seq3_J_1_flag=!1,b.addressTab=a},b.myAddrChange=function(a){a&&b.giftData.user_addr_info==c||(b.s_init(),b.myAddr_tab=a,b.giftData.ord_addr_info==c||null==b.giftData.ord_addr_info||a||(b.selectedAddress=b.giftData.ord_addr_info,b.editMyAddr(),b.editMode=!1))},b.addrLayer_show=function(a){b.addr_layer=a},b.list_edit=function(a,c){$("#tl_d"+a).trigger("click"),b.selectedAddress=c,b.editMyAddr(),b.addrLayer_show(!1)};var g=!1;b.list_del=function(c,d){return $("#tl_d"+c).trigger("click"),1==$("#filterType >ul >li").size()?(alert("마지막 배송지입니다."),!1):void(confirm("내 배송지 목록에서 삭제하시겠습니까?")&&(g?alert("배송지 삭제중입니다."):(g=!0,$.ajax({type:"post",async:!1,url:a.delete_address_list+"?dlvp_sn="+d.dlvp_sn+"&index="+d.idx+"&mbr_no="+b.loginInfo.mbrNo,success:function(a){return"0000"==a.result.response_code&&(d.del=!0),g=!1,!0},error:function(){g=!1}}))))},b.editMyAddr=function(){if(null==b.selectedAddress)for(var a=0;a<b.giftData.user_addr_info.addr_list.length;a++)b.giftData.user_addr_info.default_addr.addr_name==b.giftData.user_addr_info.addr_list[a].addr_name&&(b.selectedAddress=b.giftData.user_addr_info.addr_list[a]);if(b.editMode=!0,b.myAddr_tab=!1,b.searchAddressFlag=!1,b.inprmitnm=b.selectedAddress.r_name?b.selectedAddress.r_name:"",b.inpdlvpnm=b.selectedAddress.addr_name?b.selectedAddress.addr_name:"",b.address_post=b.selectedAddress.addr_post?b.selectedAddress.addr_post:"",b.address1=b.selectedAddress.addr1?b.selectedAddress.addr1:"",b.address2=b.selectedAddress.addr2?b.selectedAddress.addr2:"",b.selectedAddress.addr_tel){var c=b.selectedAddress.addr_tel.split("-");c&&3==c.length&&(b.inpcell1=c[0],b.inpcell2=parseInt(c[1],10),b.inpcell3=parseInt(c[2],10))}},b.addrLayer_select=function(){if(!$('input:radio[name="detail_list"]').is(":checked"))return b.selectedAddress=null,alert("배송지를 선택해 주세요"),!1;var a=$('input:radio[name="detail_list"]:checked').val();b.selectedAddress=b.giftData.user_addr_info.addr_list[a],b.giftData.user_addr_info.default_addr={},b.giftData.user_addr_info.default_addr.r_name=b.selectedAddress.r_name,b.giftData.user_addr_info.default_addr.addr_name=b.selectedAddress.addr_name,b.giftData.user_addr_info.default_addr.addr_post=b.selectedAddress.addr_post,b.giftData.user_addr_info.default_addr.addr1=b.selectedAddress.addr1,b.giftData.user_addr_info.default_addr.addr2=b.selectedAddress.addr2,b.giftData.user_addr_info.default_addr.addr_tel=b.selectedAddress.addr_tel,b.giftData.user_addr_info.default_addr.dlvp_sn=b.selectedAddress.dlvp_sn,b.addrLayer_show(!1)},b.searchAddress=function(d,e,g){var h={proc_div:e,addr_gbn:g,deli_cnt:d},i=null,j="";if("S"==e&&"J"==g){if(j=$.trim($("#inp_seq1_J_1").val()),j.length<=0)return alert("읍/면/동을 입력해 주세요."),$("#inp_seq1_J_1").focus(),!1;h.dong_nm=j,i=function(a){b.searchJListFlag=!0,b.searchJList=a.addr_lst}}else if("M"==e&&"J"==g){var k=$("#inp_seq2_J_1");if($.trim(k.val()).length<=0)return alert("상세주소를 입력해 주세요."),k.focus(),!1;h.zipcode=b.zipcode,h.addr1=b.txt_seq2_J_1,h.addr2=$("#inp_seq2_J_1").val(),i=function(a){b.addrData=a,b.searchJListFlag=!1,b.moreAddress=!1,b.seq3_J_1_flag=!0,b.noneData=!1,b.addrData.s_addr==c&&b.addrData.n_addr==c&&b.addrData.ipt_addr2!=c&&(b.noneData=!0,b.addrData.ipt_addr2.post_addr=b.addrData.ipt_addr2.addr1,b.addrData.ipt_addr2.dtl_addr=b.addrData.ipt_addr2.addr2)}}else if("S"==e&&"N"==g){var l=$("#key1_seq1_N_1"),m=$("#key2_seq1_N_1"),n=$("#key3_seq1_N_1"),o=$("#key4_seq1_N_1"),p=$("#key5_seq1_N_1"),q=!1;if(l.add(m).add(n).each(function(){return $.trim($(this).val()).length<=0?(alert("조회 필수항목을 입력해 주세요."),$(this).focus(),q=!0,!1):void 0}),q)return!1;h.keyword1=l.val(),h.keyword2=m.val(),h.keyword3=n.val(),""!=o.val()&&(h.keyword4=o.val()),""!=p.val()&&(h.keyword5=p.val()),i=function(a){b.searchJListFlag=!0,b.searchJList=a.addr_lst}}h.order_no=b.giftData.orderNo,h.ord_dtl_sn=b.giftData.ordDtlSn,f.get(a.searchAddress,{params:h}).success(function(a){if("IMPS_RGN"==a.result_code||"ETC"==a.result_code){var b=a.error_msg;return(b==c||""==b)&&(b="배송지를 조회하지 못했습니다."),void alert(b)}i!=c&&i(a)}).error(function(){})},b.other_address_post="",b.other_address1="",b.other_address2="",b.addrGubun=!1,b.selectAddress=function(a,c,d){if("SJ"==a)b.searchJListInput=!1,b.searchJListInput2=!1,b.txt_seq2_J_1=c.post_addr,b.inp_seq2_J_1=c.dtl_addr,b.zipcode=c.post_no,b.searchJListFlag=!1,b.moreAddress=!0,$("#inp_seq2_J_1").val(""),$("#inp_seq2_J_1").focus();else if("MJa"==a)b.searchAddressFlag=!1,b.seq3_J_1_flag=!1,b.address_post=c.post_no,b.address1=c.post_addr,b.address2=c.dtl_addr,b.other_address_post=b.addrData.n_addr[d].post_no,b.other_address1=b.addrData.n_addr[d].post_addr,b.other_address2=b.addrData.n_addr[d].dtl_addr,b.addrGubun=!1;else if("MJ"==a){b.searchAddressFlag=!1,b.seq3_J_1_flag=!1,b.address_post=c.post_no,b.address1=c.post_addr,b.address2=c.dtl_addr;try{b.other_address_post=b.addrData.s_addr[d].post_no,b.other_address1=b.addrData.s_addr[d].post_addr,b.other_address2=b.addrData.s_addr[d].dtl_addr}catch(e){b.other_address_post="",b.other_address1="",b.other_address2=""}b.addrGubun=!0}else"MJ_c"==a&&(b.searchAddressFlag=!1,b.seq3_J_1_flag=!1,b.address_post=c.post_no,b.address1=c.post_addr,b.address2=c.dtl_addr,b.other_address_post="",b.other_address1="",b.other_address2="",b.addrGubun=b.addressTab)};var h=function(a,b){var c=$(b).val();return""==c?(alert(a+" 입력해주세요."),$(b).focus(),!0):!1};b.checkField=h,b.writeMessage=!1,b.messageChange=function(){"write"==$("#message").val()&&(b.writeMessage=!0)},b.getlastAddress=function(){var a=null,d=$("#message").val();if(b.writeMessage&&(d=$("#message2").val()),b.loginInfo.isLogin){if(b.myAddr_tab&&!b.editMode)a=b.giftData.user_addr_info.default_addr,a.message=d,a.stnm_addr_post="",a.stnm_addr1="",a.stnm_addr2="";else if(!b.myAddr_tab&&b.editMode){if(b.searchAddressFlag)return alert("주소찾기를 완료해주세요."),{};if(h("받는분을","#inprmitnm1")||h("주소를","#address1")||h("나머지 주소를","#address2")||h("전화번호를","#inpcell2")||h("전화번호를","#inpcell3"))return{};a={idx:b.selectedAddress.idx,is_default:b.selectedAddress.is_default,dlvp_sn:b.selectedAddress.dlvp_sn,r_name:$("#inprmitnm1").val(),addr_post:b.address_post,addr1:$("#address1").val(),addr2:$("#address2").val(),addr_tel:b.inpcell1+"-"+$("#inpcell2").val()+"-"+$("#inpcell3").val(),message:d}}else if(!b.myAddr_tab&&!b.editMode){if(b.searchAddressFlag||""==b.address_post)return alert("주소찾기를 완료해주세요."),{};if(h("받는분을","#inprmitnm1")||h("주소를","#address1")||h("나머지 주소를","#address2")||h("전화번호를","#inpcell2")||h("전화번호를","#inpcell3"))return{};a=b.getResult("#inprmitnm1",d)}}else{if(b.searchAddressFlag||""==b.address_post||b.address_post==c)return alert("주소찾기를 완료해주세요."),{};if(h("받는분을","#inprmitnm2")||h("주소를","#address1")||h("나머지 주소를","#address2")||h("전화번호를","#inpcell2")||h("전화번호를","#inpcell3"))return{};a=b.getResult("#inprmitnm2",d)}return a},b.getResult=function(a,d){var e={r_name:$(a).val(),message:d,addr_tel:b.inpcell1+"-"+$("#inpcell2").val()+"-"+$("#inpcell3").val()};return b.giftData.ord_addr_info!=c&&null!=b.giftData.ord_addr_info&&$("#address1").val()==b.giftData.ord_addr_info.addr1?(e.dlvp_sn=b.giftData.ord_addr_info.dlvp_sn,e.stnm_addr_post="",e.stnm_addr1="",e.stnm_addr2="",e.addr_post="",e.addr1="",e.addr2=""):(e.dlvp_sn="",b.addrGubun?(console.log("도로명주소 입력한경우"),e.addr_post=b.other_address_post,e.addr1=b.other_address1,e.addr2=b.other_address2,e.stnm_addr_post=b.address_post,e.stnm_addr1=$("#address1").val(),e.stnm_addr2=$("#address2").val()):(console.log("지번주소 입력한경우"),e.stnm_addr_post=b.other_address_post,e.stnm_addr1=b.other_address1,e.stnm_addr2=b.other_address2,e.addr_post=b.address_post,e.addr1=$("#address1").val(),e.addr2=$("#address2").val())),e}}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","addressInfo"]);d.controller("giftcheckCtrl",["$scope","LotteCommon","$http","commInitData",function(a,b,d,e){a.loading=!1,a.state=0,a.showWrap=!0,a.contVisible=!0,a.subTitle="선물 확인",a.order_no=e.query.orderNo,a.key=decodeURI(e.query.key),a.test=decodeURI(e.query.test),a.presentListUrl=b.presentListUrl+"?"+baseParam,a.presentShop=b.mainUrl+"?"+baseParam+"&dispNo=5556743",a.appBanner=null,d.get(b.mainPopupData,{params:{}}).success(function(b){a.appBanner=b.app_down_popup[0]}),a.load=function(){var e={orderNo:a.order_no,KEY:a.key,mbr_no:a.loginInfo.mbrNo};d({url:b.giftCheckUrl,data:$.param(e),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(a.giftData=b,"0"==a.test&&(a.giftData.gift_state=0),"1"==a.giftData.gift_state)location.href=a.presentListUrl;else if("2"==a.giftData.gift_state||"3"==a.giftData.gift_state)a.state=2,a.subTitle="선물 확인 완료",a.checkGiftPage=!0,a.getGoodsList();else if("4"==a.giftData.gift_state)a.state=4,a.subTitle="선물 확인",a.checkGiftPage=!0,a.getGoodsList();else{if(a.giftData.gift_state==c)return void console.log("데이타 로드 실패");a.loading=!0}if(a.giftData.gift_msg_info.msg!=c&&(a.giftData.gift_msg_info.msg=a.giftData.gift_msg_info.msg.replace(/\n/g,"<br />")),a.loginInfo.isLogin&&a.giftData.user_addr_info!=c&&(a.myAddr_tab=!0),a.giftData.gift_msg_info.bg_color==c&&(a.giftData.gift_msg_info.bg_color="#ffffff"),a.zeroOpt=[],a.giftData.gift_prd_info.opt_item_lst!=c){var d=a.giftData.gift_prd_info.opt_item_lst;if(d.length>1)for(var e=0;e<d.length;e++)a.zeroOpt.push(d[e].opt_tval.split(" x "))}a.giftData.orderNo=a.order_no,a.giftData.ordDtlSn=a.giftData.gift_prd_info.ord_dtl_sn,a.giftData.ord_addr_info!=c&&null!=a.giftData.ord_addr_info&&a.giftData.ord_addr_info.addr_post!=c&&a.myAddrChange(!1)}).error(function(){})},setTimeout(function(){a.load()},500)}]),d.directive("lotteContainer",["LotteCommon","$http","LotteLink",function(b,d,e){return{templateUrl:"/lotte/resources_dev/mylotte/giftcheck_container.html",replace:!0,link:function(f,g,h){f.gotoApp=function(){e.appDeepLink("lotte","http://m.lotte.com",null,null)},f.checkGiftPage=!1,f.confirm_submit=function(e){var g={order_no:f.order_no,key:f.key,ordDtlSn:f.giftData.gift_prd_info.ord_dtl_sn,addr1:"",addr2:"",addr_name:"",addr_post:"",addr_tel:"",password:"",r_name:"",message:"",dlvp_sn:""};if(e){if(g=f.getlastAddress(),g.message==c)return;if(f.checkField("비밀번호를","#pass1")||f.checkField("비밀번호를","#pass2"))return;if($("#pass1").val()!=$("#pass2").val())return alert("비밀번호가 일치하지 않습니다."),$("#pass2").val(""),void $("#pass2").focus();if(0==$("#agreeInfoCheck:checked").length)return void alert("선물 수령을 위한 정보제공에 대하여 동의해주세요.");g.ordDtlSn=f.giftData.gift_prd_info.ord_dtl_sn,g.order_no=f.order_no,g.key=f.key,g.password=$("#pass1").val(),g.reject_msg=""}else{if(""==$("#refuse_message").val())return void alert("거절 메시지를 선택해주세요.");g.reject_msg=$("#refuse_message").val(),f.state=2}d.get(b.confirm_gift,{params:g}).success(function(b){if("0000"==b.result.result_code)$(a).scrollTop(0),f.subTitle="선물 확인 완료",f.checkGiftPage=!0,f.getGoodsList();else{if(b.result!=c){var d=b.result.error_msg;(d==c||""==d)&&(d="선물 확인 중 에러가 발생했습니다."),alert(d),console.log(b.result.result_code,b.result.error_msg)}e||location.reload()}}).error(function(a){console.log(a.result.result_code,a.result.error_msg),"ETC"==a.result.result_code&&location.reload()})},f.getGoodsList=function(){d.get(b.gift_epilogue,{params:null}).success(function(a){f.recom_prd_lst=a.recom_prd_lst}).error(function(){})},f.refuseLayerFlag=!1,f.refuse_rLayer=function(b){b&&$(a).scrollTop(0),f.refuseLayerFlag=b},f.optFlag=!1,f.changeOpt=function(){f.optFlag=!f.optFlag,f.optFlag&&f.initOptCheck()},f.getOptionString=function(){for(var a,b=[],c=f.giftData.gift_prd_info.opt_list.length,d=0;c>d;d++)a=$("#prod_option_"+d),b.push(a.val());return b.join(" x ")},f.saveOpt=function(){if(f.giftData.gift_prd_info.opt_item_lst!=c){for(var a,e=f.getOptionString(),g=-1,h=f.giftData.gift_prd_info.opt_item_lst,i=h.length,j="",k="",l=0,m=0;m<f.giftData.gift_prd_info.opt_list.length;m++)m>0&&(j+=" x "),j+=f.giftData.gift_prd_info.selected_opt[m].opt_value;for(m=0;i>m;m++)a=h[m],a.opt_tval==e&&(g=a.item_no,l=a.inv_qty),a.opt_tval==j&&(k=a.item_no);if(k==g)return void alert("동일한 옵션을 선택하셨습니다.");if(0==l)return void alert("재고 수량이 부족합니다.");if(!(0>g)){var n=b.presentDetailOption,o={ord_no:f.order_no,ord_dtl_sn:f.giftData.gift_prd_info.ord_dtl_sn,goods_no:f.giftData.gift_prd_info.goods_no,item_no:k,chg_item_no:g,rel_qty:f.giftData.gift_prd_info.rel_qty};d.get(n,{params:o}).success(function(a){if("0000"==a.result_code){alert("저장하였습니다."),f.optFlag=!1;for(var b=0;b<f.giftData.gift_prd_info.selected_opt.length;b++)f.giftData.gift_prd_info.selected_opt[b].opt_value=$("#prod_option_"+b).val();f.giftData.gift_prd_info.ord_dtl_sn=a.ord_dtl_sn}else{var d=a.error_msg;(d==c||""==d)&&(d="변경 사항을 저장하지 못했습니다."),alert(d)}}).error(function(){console.log("Data Error : 옵션 변경")})}}},f.productDetailPop=!1,f.detailHtml="",f.ProductDetailLayer=function(){var a={goods_no:f.giftData.gift_prd_info.goods_no};d.get(b.productProductDetailHtmlData,{params:a}).success(function(a){var b=a.max;b=f.replaceAll(b,'\\"','"'),b=f.replaceAll(b,"&#34;","'"),f.detailHtml=f.replaceAll(b,"\r\n",""),f.productDetailPop=!0}).error(function(){})},f.closeProductDetailLayer=function(){f.productDetailPop=!1},f.replaceAll=function(a,b,d){return a!=c&&null!=a&&""!=a&&(a=a.split(b).join(d)),a},f.gotoLink=function(c,d){var e="&tclick=m_DC_SrhResult_Clk_Prd_idx"+(d+1);a.location.href=b.prdviewUrl+"?"+f.baseParam+"&goods_no="+c.goods_no+e},f.initOptCheck=function(){for(var a=[0],b=f.giftData.gift_prd_info.opt_list,c=0;c<b[0].opt_value_lst.length;c++)a[0]=b[0].opt_value_lst[c],b.length>1?f.treecheck(a,1,b)&&$("#prod_option_0").find("option").eq(c+1).hide():f.checkZero(a)&&$("#prod_option_0").find("option").eq(c+1).hide()},f.checkOptCnt=function(a){var b=f.giftData.gift_prd_info.opt_list;if(b.length>1)for(var c,d=[],e=!0,g=0;g<b.length;g++)if(g>a){if($("#prod_option_"+g).find("option").show(),b[g].selectID=0,g<b.length-1){if(e){d.push(0);for(var h=0;h<b[g].opt_value_lst.length;h++)d[g]=b[g].opt_value_lst[h],f.treecheck(d,g+1,b)&&$("#prod_option_"+g).find("option").eq(h+1).hide();e=!1}}else if(e){d.push(0);for(var h=0;h<b[g].opt_value_lst.length;h++)d[g]=b[g].opt_value_lst[h],c=f.checkZero(d),c&&$("#prod_option_"+g).find("option").eq(h+1).hide()}}else{if(0==b[g].selectID){for(;g<b.length;g++)b[g].selectID=0;break}d.push($("#prod_option_"+g).val())}},f.treecheck=function(a,b,c){var d,e,g=!0;if(b<c.length-1)for(d=a.concat(0),e=0;e<c[b].opt_value_lst.length;e++)d[b]=c[b].opt_value_lst[e],f.treecheck(d,b+1,c)||(e=c[b].opt_value_lst.length,g=!1);else for(d=a.concat(0),e=0;e<c[b].opt_value_lst.length;e++){d[b]=c[b].opt_value_lst[e];var h=f.checkZero(d);h||(e=c[b].opt_value_lst.length,g=!1)}return g},f.checkZero=function(a){for(var b=0,c=!0,d=0;d<f.zeroOpt.length;d++){b=0;for(var e=0;e<f.zeroOpt[d].length;e++)a[e]==f.zeroOpt[d][e]&&b++;b==f.zeroOpt[d].length&&(d=f.zeroOpt.length,c=!1)}return c},f.appObj.isApp||(f.appDownBann=!0),f.appDownBnrClose=function(){f.appDownBann=!1}}}}])}(window,window.angular);
//# sourceMappingURL=/giftcheck.min.js.map