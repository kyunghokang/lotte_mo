!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter"]);d.controller("MyLotteMainCtrl",["$scope","$http","$window","$timeout","commInitData","LotteCommon","LotteCookie","LotteUtil","LotteGA","LotteStorage","LotteUserService",function(b,d,e,f,g,h,i,j,k,l,m){b.showWrap=!0,b.contVisible=!0,b.subTitle="마이롯데",b.isShowThisSns=!1,b.memberLoginPopup=!1,b.welcomeFlag=!1,b.isShowLoadingImage=!0,b.gaCtgName="MO_마이롯데",b.grockle_yn=!1;var n=null!=g.query.grockle_yn?g.query.grockle_yn:"N";if(b.grockle_yn="Y"==n?!0:!1,b.schema="",b.schema=null!=g.query.schema?g.query.schema:"",b.dummyProfileUrl="http://image.lotte.com/lotte/mo2018/reviews/default_profile.png",b.todayDate=new Date,g.query.testDate){var o=g.query.testDate,p=new Date(o.substring(0,4),parseInt(o.substring(4,6))-1,o.substring(6,8),o.substring(8,10),o.substring(10,12),o.substring(12,14));b.todayDate=p}b.newVer=!1,b.todayDate.getTime()>=new Date(2017,11,1).getTime()&&(b.newVer=!0),this.getCookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""},b.reviewPopHide=i.getCookie("reviewNotice")||"N","Y"!=b.reviewPopHide&&(b.reviewPopFlag=!0);var q="";typeof SEED_DATA!=c&&(q=SEED_DATA);var r=this.getCookie("SIMPLESIGNYN"),s=(j.getLoginSeed().toUpperCase(),encodeURIComponent((""==b.schema?h.baseUrl:b.schema+h.baseUrl.replace("http",""))+"/"+(j.isSmp()?"main_smp.do":"main.do")+b.baseParam,"UTF-8"),"");s=""==b.schema?encodeURIComponent(a.location.href,"UTF-8"):a.location.href.replace(/^http(s)?/,b.schema);var t=(navigator.userAgent,h.mylotteMainData+"?smartAlarmViewTime="+l.getLocalStorage("smart_alarm_view_time")+"&viewGoods="+l.getLocalStorage("latelyGoods")),u=t+"&"+b.baseParam+"&_ts="+Date.now();d.get(u).success(function(a){1e3==a.resultCode?(b.contents={},b.subTitle="마이롯데",b.noData=!0,b.contVisible=!1):(b.myLotteMainInfo=a.mylotte,b.myLotteMainInfo.clover>=1e5&&(b.myLotteMainInfo.clover="99,999+"),b.myLotteMainInfo.couponCnt>=1e3&&(b.myLotteMainInfo.couponCnt="999+"),b.myGradeType=a.mylotte.mbrGradeCd,"80"==a.mylotte.mbrGradeCd&&"Y"!=a.mylotte.couponInfo.mbr_down_yn&&(b.welcomeFlag=!0),b.alarmFlag=!1,"Y"==b.myLotteMainInfo.newAlarmYn&&(b.alarmFlag=!0)),b.isShowLoadingImage=!1}).error(function(a,c,d,e){console.log("Error Data : ",c,d,e),b.isShowLoadingImage=!1}),b.myLotteMainLinkObj={ordLstUrl:{key:h.ordLstUrl+"?"+b.baseParam+"&searchFlag=D15&ordDtlStatCd=10&tclick=m_DC_MyPage_Clk_Btn_9",act:"주문배송조회",lab:"주문배송조회"},ordLstM1Url:h.ordLstUrl+"?"+b.baseParam+"&searchFlag=M1&ordDtlStatCd=10&tclick=m_DC_MyPage_Clk_Btn_9",ordCancelUrl:{key:h.ordCancelUrl+"?"+b.baseParam+"&fromPg=3&ordListCase=3&tclick=m_DC_MyPage_Clk_Btn_10",act:"문의하기",lab:"취소/교환/반품조회"},ecouponListUrl:h.baseUrl+"/smartpick/smp_cpn_rfd_list.do?c=mlotte&udid=&v=&cn=&cdn=&tclick=m_DC_MyPage_Clk_Btn_11",attendEventUrl:{key:h.baseUrl+"/event/m/directAttend.do?"+b.baseParam+"&tclick=m_dc_MyPage_Clk_Btn_attendcheck",act:"이벤트",lab:"출석체크이벤트"},critViewUrl:h.critViewUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_12",eventGumeUrl:{key:h.eventGumeUrl+"?"+b.baseParam+"&search_div=event_list&tclick=m_DC_MyPage_Clk_Btn_13",act:"이벤트",lab:"이벤트응모내역"},mylotteReinquiryListUrl:h.mylotteReinquiryListUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_14",lPayEasyUrl:{key:h.lPayEasyUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_14",act:"간편결제",lab:"L.pay간편결제신청"},orderAlarmYnUrl:h.orderAlarmYnUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_17",smartpayUrl:{key:h.smartpayUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_15",act:"간편결제",lab:"스마트페이관리"},questionUrl:h.questionUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_16",cscenterAnswerUrl:h.cscenterAnswerUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_19",friendCouponUrl:h.baseUrl+"/event/couponBook.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_1",gdBenefitUrl:{key:h.gdBenefitUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_29",act:"회원보유자산",lab:"멤버십/쿠폰존"},talkUrl:{key:h.talkUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_28",act:"문의하기",lab:"실시간채팅상담"},smartAlarmUrl:{key:h.smartAlarmUrl+"?"+b.baseParam+"&curDispNoSctCd=22&tclick=m_DC_MyPage_Clk_Btn_23",act:"알림",lab:"알림내역보기"},wishLstUrl:{key:h.wishLstUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_25",act:"관심상품",lab:"위시리스트"},cscenterMain:{key:"/custcenter/cscenter_main.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_18",act:"문의하기",lab:"1:1문의/답변"},QandA:{key:"/mylotte/product/m/mylotte_reinquiry_list.do?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_16",act:"문의하기",lab:"나의상품Q&A"},ordLst2Url:h.ordLstUrl+"?"+b.baseParam+"&fromPg=3&tclick=m_DC_MyPage_Clk_Btn_10",presentList:{key:h.presentListUrl+"?"+b.baseParam,act:"선물함",lab:"선물함"}},b.myLotteMainPopLinkObj={gdBenefitUrl:h.gdBenefitUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_29"},b.hybLink=function(a){var c=b.myLotteMainLinkObj[a];k.evtTag(b.gaCtgName,c.act,c.lab),e.location.href=b.myLotteMainLinkObj[a].key},b.myLotteLateProd=function(){k.evtTag(b.gaCtgName,"관심상품","최근본상품"),setTimeout(function(){e.location.href=h.lateProdUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_26&viewGoods="+l.getLocalStorage("latelyGoods")})},b.myLotteOftenProd=function(){k.evtTag(b.gaCtgName,"관심상품","자주구매"),setTimeout(function(){e.location.href=h.oftenProdUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_29&viewGoods="+l.getLocalStorage("latelyGoods")})},b.lPointClick=function(){k.evtTag(b.gaCtgName,"회원보유자산","엘포인트"),e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=lt_point&tclick=m_DC_MyPage_Clk_Btn_3"},b.lMoneyClick=function(){k.evtTag(b.gaCtgName,"회원보유자산","엘머니"),e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=l_point&tclick=m_DC_MyPage_Clk_Btn_4"},b.depositClick=function(){k.evtTag(b.gaCtgName,"회원보유자산","보관금"),e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=deposit&tclick=m_DC_MyPage_Clk_Btn_5"},b.couponClick=function(){k.evtTag(b.gaCtgName,"회원보유자산","쿠폰"),e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=coupon&tclick=m_DC_MyPage_Clk_Btn_6"},b.cloverClick=function(){k.evtTag(b.gaCtgName,"회원보유자산","클로버"),e.location.href=h.pointInfoUrl+"?"+b.baseParam+"&point_div=clover&tclick=m_DC_MyPage_Clk_Btn_7"},b.smartPickClick=function(){k.evtTag(b.gaCtgName,"교환권","스마트픽/e-쿠폰교환권"),e.location.href=h.smartPickListUrl+"?"+b.baseParam+"&tclick=m_DC_MyPage_Clk_Btn_8"},b.ordDetailClick=function(a){var c=a.toString().substr(1,1),d=["주문접수","주문완료","출고지시","상품준비","발송완료"];k.evtTag(b.gaCtgName,"주문배송조회",d[c-1]),e.location.href=h.ordLstUrl+"?"+b.baseParam+"&searchFlag=D15&ordDtlStatCd=10&orderListType="+a+"&tclick=m_DC_MyPage_Clk_Lnk_"+c},b.welcomeClose=function(){b.welcomeFlag=!1},b.goPointCoupon=function(){var a=$location.protocol()+"://"+$location.host();e.location.href=a+"/mylotte/pointcoupon/point_info.do?"+b.baseParam+"&point_div=coupon"},b.memeberChagne=function(){if(k.evtTag(b.gaCtgName,"회원정보","회원정보수정"),b.loginInfo.isLogin)if(0==b.myLotteMainInfo.valid_login)console.log("2015년4월20일 이전 로그인 유저"),b.memberLoginPopup=!0,b.dimmedOpen({target:"memberPopup",callback:b.closePopup});else{if("Y"==r)return alert("간편회원의 정보변경/탈퇴는 PC에서만 가능합니다."),!1;if(b.sendTclick("m_DC_MyPage_Clk_Btn_20"),!b.aliveSso||!i.getCookie("SSO_ACES_TKN"))return alert("L.POINT 로그인 오류로 인해 일시적으로 회원정보수정/회원탈퇴가 불가합니다.\n잠시 후 다시 시도해주세요."),!1;m.callSsoScreen("/view/manage/mbrManage_01_000",a.location.href)}else alert("로그인 후 이용 가능합니다.")},b.memberOut=function(){if(k.evtTag(b.gaCtgName,"회원정보","회원 탈퇴"),b.loginInfo.isLogin)if(0==b.myLotteMainInfo.valid_login)console.log("2015년4월20일 이전 로그인 유저"),b.memberLoginPopup=!0,b.dimmedOpen({target:"memberPopup",callback:b.closePopup});else{if("Y"==r)return alert("간편회원의 정보변경/탈퇴는 PC에서만 가능합니다."),!1;if(b.sendTclick("m_DC_MyPage_Clk_Btn_21"),!b.aliveSso||!i.getCookie("SSO_ACES_TKN"))return alert("L.POINT 로그인 오류로 인해 일시적으로 회원정보수정/회원탈퇴가 불가합니다.\n잠시 후 다시 시도해주세요"),!1;var a="&targetUrl="+encodeURIComponent(e.location.href,"UTF-8");m.callSsoScreen("/view/manage/mbrSes_01_001",h.ssoDropGate+"?"+b.baseParam+a)}else alert("로그인 후 이용 가능합니다.")},b.goLoginClick=function(){k.evtTag(b.gaCtgName,"로그인","로그인");var a="&tclick=m_DC_MyPage_Clk_Btn_27&targetUrl="+encodeURIComponent(h.mylotteUrl+"?"+b.baseParam,"UTF-8");e.location.href=h.loginUrl+"?"+b.baseParam+a},b.goFamilySite=function(c){if(k.evtTag(b.gaCtgName,"회원가입","회원가입"),b.appObj.isIOS&&b.appObj.isApp){b.sendTclick("m_DC_Mypage_Clk_Btn_28");$.ajax({type:"post",async:!1,url:h.getJoinBtnViewAjaxUrl,success:function(b){if(b=b.result.trim(),"Y"==b)alert("[아이디/비밀번호 찾기, 회원가입] 서비스는 일시적으로 롯데닷컴/엘롯데 PC를 통해 이용가능합니다. 이용에 불편을 드려 죄송합니다.");else{var d="";a.location.href;"id"==c?d="/exView/manage/fdId_01_001":"passwd"==c?d="/exView/manage/fdPassword_01_001":"mem_reg"==c&&(d="/exView/join/mbrJoin_01_001"),m.callSsoScreen(d,a.location.href)}},error:function(a){alert(a.message)}})}else b.goFamilySite2(c)},b.goFamilySite2=function(c){if("id"==c?b.sendTclick("m_DC_login_clk_Lnk_1"):"passwd"==c?b.sendTclick("m_DC_login_clk_Lnk_2"):"mem_reg"==c&&b.sendTclick("m_DC_Mypage_Clk_Btn_28"),"N"==b.joinBtnViewYn){var d=/iphone|ipad/gi.test(navigator.appVersion);if(("id"==c||"passwd"==c||"mem_reg"==c)&&d)return void alert("[아이디/비밀번호 찾기, 회원가입] 서비스는 일시적으로 롯데닷컴/엘롯데 PC를 통해 이용가능합니다. 이용에 불편을 드려 죄송합니다.")}var e="";a.location.href;"id"==c?(b.sendTclick("m_DC_login_clk_Lnk_1"),e="/exView/manage/fdId_01_001"):"passwd"==c?(b.sendTclick("m_DC_login_clk_Lnk_2"),e="/exView/manage/fdPassword_01_001"):"mem_reg"==c&&(b.sendTclick("m_DC_Mypage_Clk_Btn_28"),e="/exView/join/mbrJoin_01_001"),m.callSsoScreen(e,a.location.href)},b.closePopup=function(){b.memberLoginPopup=!1,b.dimmedClose()},b.lsOftenBuyClick=function(){k.evtTag(b.gaCtgName,"오늘장보기","오늘장보기#자주구매");var a=b.appObj.isSuperApp?"M389197":"M389184";b.appObj.isApp||(a="M389469"),b.gotoLotteSuperUrl(h.SuperQuickBuyUrl,a)},b.lsOrderClick=function(){k.evtTag(b.gaCtgName,"오늘장보기","오늘장보기주문내역");var a=b.appObj.isSuperApp?"M389199":"M389186";b.appObj.isApp||(a="M389470"),b.gotoLotteSuperUrl(h.SuperOrderListUrl,a)},b.lsWishlistClick=function(){k.evtTag(b.gaCtgName,"오늘장보기","오늘장보기위시리스트");var a=b.appObj.isSuperApp?"M389202":"M389187";b.appObj.isApp||(a="M389471"),b.gotoLotteSuperUrl(h.SuperWishListUrl,a)},b.lsMainClick=function(){k.evtTag(b.gaCtgName,"오늘장보기","오늘장보기로이동");var a=b.appObj.isSuperApp?"M389204":"M389188";b.appObj.isApp||(a="M389472"),b.gotoLotteSuperUrl(h.SuperMainUrl,a)},b.goProfile=function(){k.evtTag(b.gaCtgName,"회원정보","프로필수정"),f(function(){location.href=b.myLotteMainInfo.prfSetUrl+"?"+b.baseParam},300)},b.goMyReview=function(){k.evtTag(b.gaCtgName,"관심상품","내상품평"),f(function(){location.href=b.myLotteMainLinkObj.critViewUrl+"?"+b.baseParam},300)}}]),d.directive("lotteContainer",function(){return{templateUrl:"/lotte/resources_dev/mylotte/m/mylotte_main_container_2018.html",replace:!0,link:function(a,b,c){}}}),d.filter("textOrNumber",["$filter",function(a){return function(b,c){return isNaN(b)?b:a("number")(b,c)}}]),d.directive("memberPopup",["$window","$location",function(a,b){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_mem.html",replace:!0,link:function(a,b,c){}}}]),d.directive("welcomePopup",["$window","$location",function(a,b){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_welcomePop.html",replace:!0,link:function(a,b,c){}}}]),d.directive("reviewPopup",["$window","$location","$timeout","LotteCookie","LotteGA",function(a,b,c,d,e){return{templateUrl:"/lotte/resources_dev/mylotte/m/popup_review.html",replace:!0,link:function(a,b,f){function g(a){return 10>a?"0"+a:a}a.saveReviewPop=function(){e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","7일간 다시보지않기 체크"),"Y"==a.reviewPopHide?d.setCookie("reviewNotice",a.reviewPopHide,7):d.delCookie("reviewNotice")},a.goRegComment=function(b,d){e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","상품평_"+g(d),b.goodsNo),c(function(){location.href=b.regCommentUrl+"&"+a.baseParam},300)},a.closeReviewPop=function(){a.reviewPopFlag=!1,e.evtTag(a.gaCtgName,"미작성 고객대상 레이어팝업","닫기 버튼")}}}}]),d.directive("onErrorSrc",function(){return{link:function(a,b,c){b.bind("error",function(){a.myLotteMainInfo.prfImgUrl!=a.dummyProfileUrl&&(a.myLotteMainInfo.prfImgUrl=a.dummyProfileUrl)})}}})}(window,window.angular);