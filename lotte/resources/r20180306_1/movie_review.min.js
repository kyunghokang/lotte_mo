!function(a,b,c){"use strict";var d=b.module("lotteSns",[]),e="[롯데닷컴 이거어때?]\n";d.controller("smsBoxCtrl",["$scope","$http","LotteCommon",function(a,b,c){a.sendSMSData=function(){var d={msg:a.smsTxt,phone_no:a.sms_phoneNo};b({url:c.sendEventSms,data:$.param(d),method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(b){b.indexOf("정상적으로 처리되었습니다")>-1?alert("문자가 발송되었습니다."):alert(b),a.hideSharePop()}).error(function(a){console.log("Error Data : 데이터 로딩 에러")})}}]),d.directive("shareBox",["$window","$location","LotteCommon","commInitData","$http","$timeout",function(d,e,f,g,h,i){return{templateUrl:"/lotte/resources_dev/sns/share_box.html",replace:!0,link:function(e,j,k){function l(a){return 10>a?"0"+a:a+""}function m(a,b,c,d,e,f){var g=new Date(a,b,c,d,e,f);return a&&b&&c&&(g.setFullYear(a),g.setMonth(b-1),g.setDate(c),d&&g.setHours(d),e&&g.setMinutes(e),f&&g.setSeconds(f)),g.getTime()}function n(a){return(a+"").length>1?a:"0"+a}function o(){return g.query.goods_no?void h.get("/product/regBestProd.do",{params:{goods_no:g.query.goods_no,sum_dt:v}}).success(function(a){}).error(function(){}):!1}function p(){if(e.share_img&&""!=e.share_img)var a=e.share_img;else if(y<m(2017,4,24,0,0))var a="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg";else var a="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png";e.cnShareUrl=e.cnShareUrl.replace(/(&)/g,"%26"),e.subTitle=e.getDearPetShareTitle(e.subTitle).replace(/(&)/g,"")+e.prdComment.replace(/(&)/g,"");var b="http://m.facebook.com/sharer.php?s=100&u="+encodeURIComponent(f.facebookUrl+"?fb_yn=Y&shareUrl="+e.cnShareUrl+"&shareTitle="+e.getDearPetShareTitle(e.subTitle)+"&shareImg="+a);d.open(b)}function q(){var a=(e.subTitle+e.prdComment,"https://twitter.com/share?text="+encodeURIComponent(e.getDearPetShareTitle(e.subTitle)+e.prdComment+" ")+"&url="+encodeURIComponent(e.cnShareUrl));d.open(a)}var r=new Date,s=r.getFullYear()+"",t=r.getMonth()+1+"",u=r.getDate()+"",v=s+n(t)+n(u),w=new Date,x=w.getFullYear()+l(w.getMonth()+1)+l(w.getDate()),y=w.getTime();if(g.query.testDate){g.query.testDate;x=g.query.testDate,y=m(x.substring(0,4),x.substring(4,6),x.substring(6,8),x.substring(8,10),x.substring(10,12),x.substring(12,14))}var z=function(){i(function(){b.element(document.querySelector("#sms_phoneNo")).focus()})};e.shareSNS=function(a,b){if(("/product/m/product_view.do"==d.location.pathname||"/product/m/product_view_dev.html"==d.location.pathname)&&o(),e.loginInfo.isLogin){var g=f.baseUrl+"/event/regEvent.do?"+e.baseParam,i=f.baseUrl+"/event/saveClover.do?"+e.baseParam,j=e.share_evt_no;b!=c&&""!=b&&(j=b);h({method:"POST",url:g,data:{evt_no:j},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),h({method:"POST",url:i,data:{evt_no:j},transformRequest:transformJsonToParam,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}if(e.appObj.isApp)return e.sendAppShare(a),!1;switch(a){case"sms":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.smsCdn,e.showSmsBox();break;case"kakaotalk":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.talkCdn,e.sendKakaoTalk();break;case"kakaostory":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.stotyCdn,e.sendKakaoStory();break;case"facebook":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.faceCdn,e.sendFacebook();break;case"twitter":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.twitCdn,e.sendTwitter();break;case"url_copy":e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.urlCdn,e.urlCopyClick(e.cnShareUrl)}},e.urlCopyClick=function(a){e.sendTclick(e.tClickBase+"share_Clk_Pop_5"),e.urlCopyFlag=!e.urlCopyFlag},e.showSmsBox=function(){if(e.sendTclick(e.tClickBase+"share_Clk_Pop_6"),e.appObj.isTablet)e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl,b.element(document).on("focus","input, textarea",function(a){j[0].style.cssText=""});else if(e.appObj.isAndroid)if(e.appObj.isTablet)e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl;else{var c=encodeURIComponent(e.getDearPetShareTitle(e.subTitle).replace(/(&)/g,"%26")+e.prdComment.replace(/(&)/g,"%26")+" "+e.cnShareUrl.replace(/(&)/g,"%26"));a.open("sms:?body="+c)}else e.sharePopVisible?e.isBeforeShareBox=!0:e.sharePopVisible=!0,e.contVisible=!1,e.shareBoxVisible=!1,e.smsBoxVisible=!0,e.sharePopTl="문자 보내기",e.smsTxt=e.getDearPetShareTitle(e.subTitle)+e.prdComment+" "+e.cnShareUrl,z()},e.sendAppShare=function(a){"sms"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_6"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.smsCdn),"kakaotalk"==a&&(e.appObj.isOldApp?e.kakaoType="":e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_1"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.talkCdn),"kakaostory"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_4"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.stotyCdn),"facebook"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_2"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.faceCdn),"twitter"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_3"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.twitCdn),"url_copy"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_5"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.urlCdn),"moreapp"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_8"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.appCdn),"mail"==a&&(e.kakaoType="",e.sendTclick(e.tClickBase+"share_Clk_Pop_7"),e.cnShareUrl="",e.cnShareUrl=e.noCdnUrl+"&cdn="+e.mailCdn),e.share_img&&""!=e.share_img?e.share_img=e.share_img:y<m(2017,4,24,0,0)?e.share_img="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.share_img="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png";var b={url:e.cnShareUrl,title:e.kakaoType+e.getDearPetShareTitle(e.subTitle).replace(/#/gi,"")+e.prdComment.replace(/#/gi,""),imageUrl:e.share_img};e.appObj.isAndroid?d.lotteshare.callAndroid("lotteshare://"+a+"/query?"+JSON.stringify(b)):e.appObj.isIOS&&(d.location="lotteshare://"+a+"/query?"+JSON.stringify(b))},e.sendKakaoStory=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_4"),e.share_img&&""!=e.share_img?e.share_img=e.share_img:y<m(2017,4,24,0,0)?e.share_img="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.share_img="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png",Kakao.Story.open({url:e.cnShareUrl,text:e.getDearPetShareTitle(e.subTitle)+e.prdComment+"\n",urlInfo:{images:[e.share_img]}})},e.sendKakaoTalk=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_1"),e.share_img&&""!=e.share_img?e.img_url=e.share_img:y<m(2017,4,24,0,0)?e.img_url="http://image.lotte.com/lotte/mobile/common/share_img_50th.jpg":e.img_url="http://image.lotte.com/lotte/mobile/common/share_img2016_v2.png",e.appShareUrl=e.cnShareUrl.replace("http","mlotte001"),Kakao.Link.sendTalkLink({label:e.getDearPetShareTitle(e.subTitle)+e.prdComment+"\n"+e.cnShareUrl,image:{src:e.img_url,width:"280",height:"280"},appButton:{text:"롯데닷컴",execParams:{iphone:{executeurl:e.appShareUrl},android:{executeurl:e.appShareUrl}}},installTalk:!0})},e.sendFacebook=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_2"),p()},e.sendTwitter=function(){e.sendTclick(e.tClickBase+"share_Clk_Pop_3"),q()}}}}]),d.directive("smsBox",["$window",function(a){return{templateUrl:"/lotte/resources_dev/sns/sms_box.html",controller:"smsBoxCtrl",link:function(a,c,d){a.focusInput=!0,a.sendShareSMS=function(){$.isNumeric(a.sms_phoneNo)&&a.sms_phoneNo.length<=11&&a.sms_phoneNo.length>=10?a.sendSMSData():alert("휴대폰 번호를 정상적으로 입력해주세요.")},a.appObj.isIOS&&b.element(document).on("focus","input, textarea",function(a){c[0].style.cssText=""})}}}]),d.directive("numericOnly",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){var b=a?a.replace(/[^\d.-]/g,""):null;return b!=a&&(d.$setViewValue(b),d.$render()),b})}}}),d.directive("sharePop",["$window","$location","LotteCommon","$timeout",function(d,f,g,h){return{templateUrl:"/lotte/resources_dev/sns/share_pop.html",replace:!0,link:function(d,f,i){function j(){var b={};return a.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,c,d){b[c]=d}),b}function k(){var a=j(),b=["c","cdn","cn","schema","tclick","udid","v"],c="",d="";for(var e in a)b.indexOf(e)>=0||(c+=d+e+"="+a[e],d="&");return c}d.isBeforeShareBox=!1,d.sharePopVisible=!1,d.shareBoxVisible=!1,d.snsTitle="친구에게 공유하기",d.getDearPetShareTitle=function(a){try{d.shareCodeis&&(a="["+d.shareCodeis+" "+d.subTitle+"]\n",e="")}catch(b){}try{"DearpetGallary"==d.screenID||"Mombaby"==d.screenID||d.shareNoFixMessage||(a=e+a)}catch(b){a=e+a}try{a=a.replace("[[","["),a=a.replace("]]","]")}catch(b){console.log("shareTitle replace err")}return a},d.showSharePop=function(a,e){try{Kakao.cleanup(),1==d.appObj.isSktApp?Kakao.init("7a460fb5cdebe4589041db57d906ddda"):Kakao.init("574659987ca46095c123d71f72abac14")}catch(f){if(console.log("PC-MODE"),location.host.indexOf("localhost")<0)return}a||(a={}),d.prdComment="",d.share_path=location.pathname,d.testParam=j();try{a.prdComment=a.prdComment.replace(/[<]br[\/][>]/gi,"\n")}catch(f){}var i=new Date,l=i.getFullYear().toString(),m=(i.getMonth()+1).toString(),n=i.getDate().toString();switch(d.nowDate=l+(m[1]?m:"0"+m[0])+(n[1]?n:"0"+n[0]),d.nowDate>=20180301&&d.nowDate<20180401?d.share_evt_no="345838":d.nowDate>=20180401&&d.nowDate<20180501?d.share_evt_no="345839":d.nowDate>=20180201&&d.nowDate<20180301?d.share_evt_no="338339":d.share_evt_no="302853","/mylotte/product/m/mylotte_crit_view.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," "),b.isDefined(a.goodsNo)?d.goodsNo=a.goodsNo:d.goodsNo="",b.isDefined(a.shareImg)?d.share_img=a.shareImg:d.share_img=""):"/product/m/product_view.do"==d.share_path||"/product/m/sub/product_comment.do"==d.share_path||"/product/m/sub/product_comment_detail.do"==d.share_path?(d.share_path="/product/m/product_view.do",b.isDefined(a.prdComment)?"Y"==a.healthfood_yn?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.goodsNm,d.prdComment=""):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.goodsNm,d.prdComment="")):"/product/m/photoreview.do"==d.share_path?"Y"==a.healthfood_yn?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=a.mgoods_nm,d.prdComment=""):(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=" [상품평] ",d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/mall/pet/mitou_gallery.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.bbsNo=a.bbsNo,d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/mall/baby/baby_main.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.prdComment=a.prdComment.replace(/\<br[\/]*\>/g," ")):"/product/m/product_list.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg):"/planshop/m/planshop_view.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg):"/product/m/product_view_gucci.do"==d.share_path?(d.snsTitle="친구에게 공유하기",d.share_img=a.shareImg,d.goodsNo=a.goodsNo,d.subTitle=d.$$childHead.BasicData.product.mgoods_nm):(d.snsTitle="친구에게 공유하기",d.prdComment="",d.share_img=""),d.param="","/product/m/product_view.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo),"/product/m/photoreview.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo,d.share_path="/product/m/product_view.do"),"/mylotte/product/m/mylotte_crit_view.do"==d.share_path&&(d.param="?goods_no="+d.goodsNo),("/product/m/comment_rewrite.do"==d.share_path||"/product/m/comment_write.do"==d.share_path)&&(d.param="?goods_no="+d.testParam.goods_no),"/product/m/product_list.do"==d.share_path&&(b.isDefined(d.testParam.ss_yn)?d.testParam.ss_yn="&ss_yn="+d.testParam.ss_yn:d.testParam.ss_yn="",b.isDefined(d.testParam.shoppingholicYn)?d.testParam.shoppingholicYn="&shoppingholicYn="+d.testParam.shoppingholicYn:d.testParam.shoppingholicYn="",b.isDefined(d.testParam.planShopGubun)?d.testParam.planShopGubun="&planShopGubun="+d.testParam.planShopGubun:d.testParam.planShopGubun="",d.param="?curDispNo="+d.testParam.curDispNo+d.testParam.ss_yn+d.testParam.shoppingholicYn+d.testParam.planShopGubun),"/planshop/m/planshop_view.do"==d.share_path&&(d.param="?spdp_no="+d.testParam.spdp_no),"/event/m/eventSaunMain.do"==d.share_path&&(d.param="?evt_no="+d.testParam.evt_no),"/styleshop/styleshop.do"==d.share_path&&(d.param="?disp_no="+d.testParam.disp_no),"/styleshop/styleshopmen.do"==d.share_path&&(d.param="?keyword="+d.testParam.keyword),"/mall/pet/dearpet_gallery.do"==d.share_path&&(d.param="?curDispNo="+d.testParam.curDispNo+"&beforeNo="+d.testParam.beforeNo+"&cateDepth="+d.testParam.cateDepth),"/mall/baby/baby_main.do"==d.share_path&&(d.param="?dispNo="+d.testParam.dispNo+"&dcate="+d.testParam.dcate+"&mcate="+d.testParam.mcate),"/event/m/kids/experience_view.do"==d.share_path&&(d.param="?evt_no="+d.testParam.evt_no),"/product/m/product_view_gucci.do"==d.share_path&&(d.param="?goods_no="+d.testParam.goods_no),"/category/m/brand_prod_list.do"==d.share_path&&(d.param="?upBrdNo="+(d.testParam.upBrdNo||"")),"/brand/bestbrandMain.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/brand/bestbrandSub.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/mall/samsung/bestsamsung_main.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),"/mall/samsung/bestsamsung_sub.do"==d.share_path&&(d.param="?curDispNo="+(d.testParam.curDispNo||"")),d.share_path){case g.styleRecomUrl:case g.specialMallUrl:case g.specialSubUrl:a!=c&&a.shareImg!=c&&(d.share_img=a.shareImg),d.param="?"+k()}(d.param+"").length>0&&(d.param+="&"),-1==(d.param+"").indexOf("?")&&(d.param="?"+d.param),1==d.appObj.isSktApp?d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"cn=171127":"/mylotte/product/m/mylotte_crit_view.do"==d.share_path||"/product/m/comment_rewrite.do"==d.share_path||"/product/m/comment_write.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/product/m/product_view.do"+d.param+"&cn=123624":"/mall/pet/dearpet_gallery.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/mall/pet/dearpet_gallery.do"+d.param:"/category/m/brand_prod_list.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/category/m/brand_prod_list.do"+d.param+"curDispNoSctCd="+(d.testParam.curDispNoSctCd||"")+"&cn=123624":"/brand/bestbrandMain.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/brand/bestbrandMain.do"+d.param+"curDispNo="+(d.testParam.curDispNo||"")+"&cn=123624":"/brand/bestbrandSub.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+"/brand/bestbrandSub.do"+d.param+"curDispNo="+(d.testParam.curDispNo||"")+"&cateSelected="+(d.testParam.cateSelected||"")+"&cn=123624":"/mall/samsung/bestsamsung_sub.do"==d.share_path?d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"&cateSelected="+(d.testParam.cateSelected||"")+"&cn=123624":d.noCdnUrl=location.protocol+"//"+location.hostname+d.share_path+d.param+"cn=123624",1==d.appObj.isSktApp?(d.talkCdn="3093671",d.twitCdn="3093668",d.stotyCdn="3093670",d.smsCdn="3093672",d.mailCdn="3158697",d.faceCdn="3093669",d.urlCdn="3158696",d.appCdn="3158696"):(d.talkCdn="2929723",d.twitCdn="2929720",d.stotyCdn="2929722",d.smsCdn="2929725",d.mailCdn="2929724",d.faceCdn="2929721",d.urlCdn="2929719",d.appCdn="2929719"),console.log("opt",e),b.isDefined(e)||(d.talkFlag=!0,d.twitFlag=!0,d.stotyFlag=!0,d.smsFlag=!0,d.mailFlag=!0,d.faceFlag=!0,d.appObj.isAndroid?(d.urlFlag=!0,d.urlCopyFlag=!1):d.appObj.isIOS?d.appObj.isOldApp?(d.urlFlag=!1,d.urlCopyFlag=!1):(d.urlFlag=!0,d.urlCopyFlag=!1):(d.urlFlag=!1,d.urlCopyFlag=!1),d.appObj.isApp&&(d.appObj.isAndroid?d.appFlag=!0:d.appFlag=!1)),"crit"==e&&(d.talkFlag=!0,d.twitFlag=!1,d.stotyFlag=!0,d.smsFlag=!0,d.mailFlag=!0,d.faceFlag=!0,d.urlFlag=!1,d.urlCopyFlag=!1,d.appFlag=!1),d.sharePopVisible=!0,d.shareBoxVisible=!0,d.sharePopTl="이거어때?",a.tclick?d.sendTclick(a.tclick):"/mall/pet/dearpet_gallery.do"==d.share_path?d.sendTclick("m_DC_SpeDisp_Dearpet_Clk_Shr"+d.testParam.curDispNo):"/brand/bestBrandMain.do"==d.share_path||"/brand/bestBrandSub.do"==d.share_path?d.sendTclick("m_DC_"+d.screenID+"_"+d.mallID+"_share"):"/mall/samsung/bestsamsung_main.do"==d.share_path||"/mall/samsung/bestsamsung_sub.do"==d.share_path?d.sendTclick("m_DC_SpeMall_Samsung_share"):d.sendTclick("m_RDC_ProdDetail_Clk_SNS"),d.dimmedOpen({target:"pop_sns",callback:this.hideSharePop}),d.LotteDimm.dimmedOpacity="0.6",h(function(){b.element("#lotteDimm").css("z-index","110")})},d.hideSharePop=function(){d.isBeforeShareBox?(d.shareBoxVisible=!0,d.smsBoxVisible=!1,d.sharePopTl="이거어때?",d.isBeforeShareBox=!1,d.dimmedClose({target:"pop_sns"})):(d.contVisible=!0,d.sharePopVisible=!1,d.shareBoxVisible=!1,d.smsBoxVisible=!1,d.sharePopTl="",d.smsTxt="",d.sms_phoneNo="",d.dimmedClose({target:"pop_sns"}))}}}}])}(window,window.angular);var transformJsonToParam=function(a){var b=[];for(var c in a)if(Array.isArray(a[c]))for(var d=0;d<a[c].length;d++)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]));else b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};!function(a,b,c){"use strict";var d=b.module("lotteVideo",[]);d.controller("LotteVideoCtrl",["$scope",function(a){}]),d.directive("lotteVideo",["$window","$timeout","LotteUtil",function(c,d,e){return{controller:"LotteVideoCtrl",link:function(c,f,g,h){function i(){n.src="",d(function(){n.src=j},300),q.appObj.isIOS||n.removeAttribute("controls"),c.movMode=0,c.$apply()}c.movMode=0,c.mute=!1;var j=g.lvSrc,k=g.lvDetailUrl,l=g.lvNoAlert,m=g.lvPoster,n=b.element(f).find("video")[0],o=g.lvTime||2e3;n.setAttribute("poster",m),n.addEventListener("ended",i,!1);var p={play:function(){a.videoStateModel.setPlay(!0,String(9999999*Math.random()))},pause:function(){a.videoStateModel.setPlay(!1)}};n.addEventListener("play",p.play,!1),n.addEventListener("pause",p.pause,!1);var q=e.getAbsScope(c);c.playVideo=function(){if(l||confirm("3G/LTE에서 재생시 데이터 요금이 부과할 수 있으니 유의하세요~")){var a=b.element(document.body).data("play_video")||"";if(a){var e=b.element("#"+a);if(e&&e.length>0){e[0].pause();var g=e.scope();g.movMode=0}}c.movMode=1,n.src||(n.src=j),n.play(),b.element(document.body).data("play_video",b.element(n).attr("id")),d(function(){1==c.movMode&&$(f).find(".btns").fadeOut(600,function(){c.movMode=2,$(this).attr("style",""),c.$apply()})},o)}},c.clickCover=function(){c.movMode=1,d(function(){1==c.movMode&&$(f).find(".btns").fadeOut(600,function(){c.movMode=2,$(this).attr("style",""),c.$apply()})},o)},c.stopVideo=function(){n.pause(),c.movMode=0},c.muteVideo=function(){n.muted?(c.mute=!1,n.muted=!1):(c.mute=!0,n.muted=!0)},c.fullVideo=function(){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.webkitEnterFullscreen&&n.webkitEnterFullscreen(),q.appObj.isIOS||n.setAttribute("controls","controls")},c.goDetailPage=function(){location.href=k},b.element(f).find("video").bind("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(a){var b=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen,d=b?"FullscreenOn":"FullscreenOff";"FullscreenOff"==d&&(c.stopVideo(),q.appObj.isIOS||n.removeAttribute("controls"),c.$apply())})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("lotteSlider",[]);d.controller("LotteSlideCtrl",["$scope",function(b){b.getTranslateXCssObj=function(a,b){var c={"-webkit-backface-visibility":"hidden","-moz-backface-visibility":"hidden","backface-visibility":"hidden","-webkit-transform":"translateX("+a+"px)","-ms-transform":"translateX("+a+"px)","-moz-transform":"translateX("+a+"px)",transform:"translateX("+a+"px)","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""};return b&&b>0&&(c["-webkit-transition"]="-webkit-transform "+b+"ms",c["-moz-transition"]="-moz-transform "+b+"ms",c["-o-transition"]="-o-transform "+b+"ms",c.transition="transform "+b+"ms"),c},b.removeTranslateCSS=function(){return{"-webkit-backface-visibility":"","-moz-backface-visibility":"","backface-visibility":"","-webkit-transform":"","-ms-transform":"","-moz-transform":"",transform:""}},b.getCoordinates=function(a){var b=a.touches&&a.touches.length?a.touches:[a],c=a.changedTouches&&a.changedTouches[0]||a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]||b[0].originalEvent||b[0];return{x:c.clientX,y:c.clientY}},b.getTransXPos=function(b){var c=a.getComputedStyle(b.get(0)),d=new WebKitCSSMatrix(c.webkitTransform);return d.m41}}]),d.directive("lotteSlider",["$window","$timeout","$parse",function(a,c,d){return{controller:"LotteSlideCtrl",link:function(d,e,f,g){function h(){m=k.outerWidth(),l.css({display:"inline-block"}),n=l.outerWidth(),x=-(n-m);var a=d.getTransXPos;(a.x>0||a.x<x)&&i(0,500)}function i(a,b){l.css(d.getTranslateXCssObj(a,b)),k.trigger({type:"slide",posX:a,wrapWidth:m,contWidth:n})}function j(){k.on({"touchstart.lotteSlider":function(a){m=k.outerWidth(),n=l.outerWidth(),y=!1,z=!1,n>m&&(a.stopPropagation(),o=!0,q=d.getCoordinates(a),p=d.getTransXPos(l),t=Date.now())},"touchmove.lotteSlider":function(a){if(o){var b,c;if(r=d.getCoordinates(a),b=Math.abs(r.x-q.x),c=Math.abs(r.y-q.y),y||(z=b>c,y=!0),z){b>5&&a.preventDefault(),a.stopPropagation();var e=p+r.x-q.x;e>0?e/=3:x>e&&(e=x+(e-x)/3),i(e,0)}}},"touchend.lotteSlider":function(a){if(s=d.getCoordinates(a),o&&q.x!=s.x&&(Math.abs(q.x-s.x)>5&&a.preventDefault(),event.stopPropagation(),y=!1,z)){m=k.outerWidth();var b=d.getTransXPos(l);u=Date.now(),w=q.x>s.x?-1:1,v=u-t;var c=Math.abs(q.x-s.x),e=.4,f=c*e/v,g=b+m*f*w;g>0?g=0:x>g&&(g=x),(Math.abs(b-g)>30||0==g||g==x)&&i(g,500)}},"touchcancel.lotteSlider":function(a){}}),b.element(a).on("resize.lotteSlider orientationchange.lotteSlider",function(){h()})}var k=b.element(e),l=k.find(">").eq(0),m=k.width(),n=l.width(),o=!1,p=0,q=null,r=null,s=null,t=0,u=0,v=0,w=0,x=0;d.lotteSliderMoveXPos=function(a,b){m=k.width(),n=l.width(),a>0?a=0:Math.abs(a)>n-m&&(a=-(n-m)),b||(b=0),i(a,b)},d.reset=function(){o=!1,i(0,0),c(function(){h()})};var y=!1,z=!1;c(function(){h(),j()})}}}])}(window,window.angular),function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteSns","lotteCommFooter","lotteVideo","lotteSlider"]);d.controller("movieReviewCtrl",["$http","$scope","$timeout","$window","LotteCommon",function(b,c,d,e,f){c.showWrap=!0,c.contVisible=!0,c.isShowThisSns=!0,c.subTitle="사전보고",c.screenID="movieReview",c.shareNoFixMessage=!0,c.shareCodeis="영상매장",c.shareRendingURL=location.href,c.tclick=c.tClickBase+c.screenID,c.vComDispNo,(c.screenDataReset=function(){c.pageOptions={},c.screenData={page:0,pageSize:20,pageEnd:!1}})(),c.tabClick=function(b,d){c.ctgll.tabIdx=d,c.vComDispNo=5586113,c.vComTabIdx=b.text_disp_prio_rnk,c.rScope.sendTclick("m_DC_SpeDisp_Reviewer_Clk_("+c.vComTabIdx+")");var e=f.movieReviewData;c.loadData(e,c.vComDispNo,c.vComTabIdx),console.log(c.product),c.product.mov=c.product.items,c.isMovie=!0,c.movPrdNum();for(var g=0;g<c.product.items.length;g++){var h="autoMovie"+[g+1];c.product.mov[g].movid=h}var i=d,j=d+1,k=c.ctgll3,l=$(a).width(),m=l/2;console.log("ctg3 : "+k);for(var n=k[j],o=n/2,p=0,g=0;i>=g;g++)p+=k[g];var q=p-(m-o);$(".swipe_wrap").animate({scrollLeft:q},"slow")};var g=f.movieReviewData;b.get(g).success(function(a){c.reviewer_mall=a.reviewer_mall,c.ctgll=a.reviewer_mall.tab_nm_list,c.ctgll2=a.reviewer_mall.tab_nm_list.items,c.ctgll3=[],c.ctgll4=[],c.ctgll.tabIdx=0,c.product=a.reviewer_mall.product,c.product.moviePage=1,c.product.moviePrd=[],c.product.mov=c.product.items,c.isMovie=!0,c.movPrdNum();var b=(c.ctgll2.length,[]),d=0;setTimeout(function(){$(".slide_ul li").each(function(a){b.push($(this).outerWidth());var c=d+=$(this).outerWidth();$(".slide_ul").width(c+1)}),c.ctgll3=b,c.ctgll4=c.ctgll3.unshift(0)},500);for(var e=0;e<c.product.items.length;e++){var f="autoMovie"+[e+1];c.product.mov[e].movid=f}}).error(function(a,b,c,d){console.log("Error Data : ",b,c,d)}),c.loadData=function(a,d,e){var f={method:"get",url:a,params:{dispNo:d,tabIdx:e}};c.ajaxLoadFlag=!0,b(f).success(function(a){console.log(a),c.reviewer_mall.main_banner=a.reviewer_mall.main_banner,c.product=a.reviewer_mall.product,c.product.moviePage=1,c.product.moviePrd=[],c.product.mov=c.product.items,c.movPrdNum();for(var b=0;b<c.product.items.length;b++){var d="autoMovie"+[b+1];c.product.mov[b].movid=d}console.log(c.product)})["finally"](function(){c.ajaxLoadFlag=!1})},c.movPrdNum=function(){for(var a=c.product.moviePage,b=15*a,d=c.product.moviePrd.length,e=d;b>e;e++){if(e>=c.product.mov.length){c.isMovie=!1;break}c.product.moviePrd.push(c.product.mov[e]),c.isMovie=!0}},c.petShare=function(a){c.sendTclick("m_DC_SpeDisp_Vcom_Clk_shr"),c.showSharePop(a)}}]),d.directive("lotteContainer",["$rootScope","$http","$timeout","$window","$location","LotteCommon","LotteCookie","LotteStorage","LotteUtil",function(a,c,d,e,f,g,h,i,j){return{templateUrl:"/lotte/resources_dev/movie_review/movie_review_container.html",replace:!0,link:function(a,c,f){function h(){var c=b.element(".top_tit_img_wrap"),d=c[0].offsetHeight;i.scrollTop()>=d?a.isMainHeaderFixed=!0:a.isMainHeaderFixed=!1}a.mallMainClick=function(b){a.sendTclick(b)},a.bnTclick=function(){var b="m_DC_SpeDisp_Reviewer_Clk_banner_(01)";a.sendTclick(b)},a.rScope=j.getAbsScope(a),a.product,a.setSliderIdxPos=function(a,b){d(function(){var d=c.find("div[lotte-slider]"),e=d.find(">ul"),f=e.find(">li"),g=f.eq(a),h=0,i=b?0:200;d.length>0&&e.length>0&&g.length>0&&d.width()<e.width()&&(h=d.width()/2+e.offset().left-(g.offset().left+g.outerWidth()/2),d.scope().lotteSliderMoveXPos(h,i))},300)},a.moremov=function(){a.product.moviePage++,a.movPrdNum();for(var b=0;b<a.product.items.length;b++){var c="autoMovie"+[b+1];a.product.mov[b].movid=c}var d="m_DC_SpeDisp_Reviewer_Clk_("+(a.ctgll.tabIdx+1)+")_more";a.sendTclick(d)},a.linkClick=function(b,c){console.log("linkUrl",b),e.location.href=j.setUrlAddBaseParam(b,a.pageUI.baseParam+"&tclick="+c)},a.movPlayTclick=function(b){var c="m_DC_SpeDisp_Reviewer_Clk_("+(a.ctgll.tabIdx+1)+")_item_("+(b+1)+")_play";a.sendTclick(c)},a.movPauseTclick=function(b){var c="m_DC_SpeDisp_Reviewer_Clk_("+(a.ctgll.tabIdx+1)+")_item_("+(b+1)+")_pause";a.sendTclick(c)},a.preBotTclick=function(b,c){if(!b.soldout){var d="m_DC_SpeDisp_Reviewer_Clk_("+(a.ctgll.tabIdx+1)+")_item_("+(c+1)+")_prd";b.curDispNo=5586113,b.curDispNoSctCd=86,$(".btn_move_stop").trigger("click"),a.productView(b,"","",d)}},a.movVolume=function(b){var c=a.tclick+($("#"+b).hasClass("mute")?"_Clk_Video_vol":"_Clk_Video_mute");a.sendTclick(c)},a.mainProductClick=function(b,c,d){if($(".btn_move_stop").trigger("click"),b.goods_no){var f=g.prdviewUrl+"?"+a.rScope.baseParam+"&goods_no="+b.goods_no;e.location.href=f+("&tclick="+c)}},a.getProductUrl=function(b,c,d){if(b.goods_no){var e=g.prdviewUrl+"?"+a.rScope.baseParam+"&goods_no="+b.goods_no+"&tclick="+c;return e}return""},a.topImg2Bn=function(a,b){linkUrl(a,b)},a.isMainHeaderFixed=!1;var i=b.element(e);a.$on("winScroll",function(a,b){h()})}}}]),d.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}])}(window,window.angular);