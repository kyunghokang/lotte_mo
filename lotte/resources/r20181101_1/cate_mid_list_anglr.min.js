!function(a,b,c){"use strict";var d=b.module("app",["lotteComm","lotteSrh","lotteSideCtg","lotteCommFooter","lotteProduct","lotteNgSwipe","lotteMainPop"]);d.controller("CateMidListCtrl",["$window","$location","$http","$scope","$timeout","$filter","LotteStorage","LotteCommon","commInitData","LotteUtil",function(d,e,f,g,h,i,j,k,l,m){function n(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function o(){var b=l.query.cateDepth1?decodeURIComponent(l.query.cateDepth1):"none",c=l.query.cateDepth2?decodeURIComponent(l.query.cateDepth2):"none",e=l.query.title?decodeURIComponent(l.query.title):"none",f=decodeURIComponent(d.location.href),g="none"==c?e:c+" / "+e;a.utag_data={event_type:"partner_prodcatview",product_cat:b,product_ocat:g,url:f,partner_name:"Lotte",country_code:"KR"}}if(g.rScope=m.getAbsScope(g),g.showWrap=!0,g.contVisible=!0,g.productMoreScroll=!0,g.screenID="cateTpl",g.pageLoading=!0,g.subTitle=" ",g.todayDate=new Date,l.query.testDate){var p=l.query.testDate,q=new Date(p.substring(0,4),parseInt(p.substring(4,6))-1,p.substring(6,8),p.substring(8,10),p.substring(10,12),p.substring(12,14));g.todayDate=q}g.chusBanner=!1,g.todayDate.getTime()>=new Date(2018,7,24,11).getTime()&&g.todayDate.getTime()<=new Date(2018,8,19,23,59,59).getTime()&&(g.chusBanner=!0),j.delSessionStorage("cateListLoc"),j.delSessionStorage("cateListData"),j.delSessionStorage("cateListScrollY"),g.control=null,g.sb_index=1,g.mom_index=1,g.getControl1=function(a){g.control=a},g.setInfo=function(a){g.sb_index=a+1},g.midSlide=function(a){g.control.moveIndex(g.sb_index-1+a)},g.setInfoMom=function(a){g.mom_index=a+1},g.control2=null,g.sb_index2=1,g.getControl2=function(a){g.control2=a},g.setInfo2=function(a){g.sb_index2=a+1},g.midSlide2=function(a){g.control2.moveIndex(g.sb_index2-1+a)},g.getProductImage2=function(a){var b="";if(null==a.img_url)return"";var d=a.img_url.replace("_280","_550");return"Y"==l.query.adultChk?d:("19"!=a.pmg_byr_age_lmt_cd||a.pmg_byr_age_lmt_cd==c?""!=a.img_url&&(b=d):g.loginInfo.isAdult?""!=a.img_url&&(b=d):b="http://image.lotte.com/lotte/mobile/sub/img_19_280x280.png",b)},g.screenDataReset=function(){g.screenData={page:0,disp_name:null,disp_no:null,mGrpNo:"",idx:"",smallCate:[],productBestList:[],rankingBestBuy:[],prdPlanList:[],babyBnnerList:[],kidsBannerList:[],brand:[],kids_yn:"",babyBnnRolling:!1},g.superDayShoppingBnr=null},g.screenDataReset(),l.query.curDispNo!=c&&(g.screenData.disp_no=l.query.curDispNo),l.query.idx!=c&&(g.screenData.idx=l.query.idx),l.query.title!=c&&(g.subTitle=decodeURIComponent(l.query.title)),g.curDispNo=g.screenData.disp_no,g.curDispNoSctCd=65,g.loadScreenData=function(){return g.screenData.endPage?!1:(g.screenData.page++,g.productListLoading=!0,void f.get(k.smallCategoryData+"?curDispNo="+g.screenData.disp_no+"&cateDiv=MIDDLE&idx="+g.screenData.idx+"&page="+g.screenData.page).success(function(a){var d=[];if(a.max!=c){d=a.max,d.mgrp_no&&(g.screenData.mGrpNo=d.mgrp_no),d.baby_banner_list&&!g.screenData.babyBnnerList.length&&(g.screenData.babyBnnerList=d.baby_banner_list.items||[],g.screenData.babyBnnRolling=g.screenData.babyBnnerList.length>1?!0:!1,g.babyBnnWidth="100%",setTimeout(function(){g.screenData.babyBnnerList.length&&(g.babyBnnWidth=$(".bnnBlock .main_slide").innerWidth()+"px")},300)),null==g.screenData.disp_name&&(g.subTitle=g.screenData.disp_name=d.disp_nm),g.screenData.smallCate.length||(g.screenData.smallCate=d.small_cate.items),1==g.screenData.page&&(g.screenData.brand=null,d.brand_list&&d.brand_list.items.length>2&&(d.brand_list.items=d.brand_list.items.splice(0,d.brand_list.items.length-d.brand_list.items.length%3),g.screenData.brand=d.brand_list.items));var e=[];g.screenData.productBestList.length||null==d.prd_best_list||(b.forEach(d.prd_best_list.items,function(a,b){a.genie_yn=!0,e.push(a)}),setTimeout(function(){g.screenData.productBestList=e},500)),d.prd_plan_list==c||g.screenData.prdPlanList.length||(g.screenData.prdPlanList=d.prd_plan_list.items),g.screenData.kids_yn||(g.screenData.kids_yn=d.kids_yn),d.kids_banner_list==c||g.screenData.kidsBannerList.length||(g.screenData.kidsBannerList=d.kids_banner_list.items),d.ranking_best_buy&&(d.ranking_best_buy.items.length?b.forEach(d.ranking_best_buy.items,function(a,b){g.screenData.rankingBestBuy.push(a)}):g.productMoreScroll=!1),d.baby_banner_list&&(g.screenData.babyBnnerList=d.baby_banner_list.items||[],g.screenData.babyBnnRolling=g.screenData.babyBnnerList.length>1?!0:!1,g.tdata="123",g.babyBnnWidth="100%",g.screenData.babyBnnerList.length&&(g.babyBnnWidth=$(".bnnBlock .main_slide").innerWidth()+"px")),d.super_day_shopping_ban_list&&(g.superDayShoppingBnr=d.super_day_shopping_ban_list.items),g.getRolling=function(a){return"true"},g.productListLoading=!1}g.pageLoading=!1}).error(function(a){g.pageLoading=!1,g.productListLoading=!1}))},setTimeout(function(){$("span.title").css("color","#000")},500),g.gotoLinkP=function(a,b,c){10>c&&(c="0"+c);var e="/product/m/product_list.do?"+g.baseParam+"&curDispNo="+a+"&tClick="+b+c;d.location.href=e},g.gotoKidsLink=function(a,b){10>b&&(b="0"+b);var c=k.kidsExperienceMainUrl+"?"+g.baseParam;a?d.location.href=c+"&tClick="+a+b:d.location.href=c},g.gotoKidsMoreLink=function(a){var b=k.kidsExperienceMainUrl+"?"+g.baseParam;a?d.location.href=b+"&tClick="+a:d.location.href=b},g.gotoBabyBnnLink=function(a,b){var a=a;a+=-1!=a.indexOf("?")?"&":"?",a+=g.baseParam,b?d.location.href=a+"&tClick="+b:d.location.href=a},g.totalPagePad=function(a){return Math.ceil(a/2)};var r=j.getSessionStorage(g.screenID+"Loc"),s=j.getSessionStorage(g.screenID+"Data"),t=j.getSessionStorage(g.screenID+"ScrollY");if(r==a.location.href&&g.locationHistoryBack){var u=JSON.parse(s);g.pageLoading=!1,g.screenData=u.screenData,g.subTitle=g.screenData.disp_name,h(function(){b.element(d).scrollTop(t)},800)}else g.loadScreenData();b.element(d).on("unload",function(a){var c={};c.screenData=b.copy(g.screenData),!l.query.localtest&&g.leavePageStroage&&(j.setSessionStorage(g.screenID+"Loc",e.absUrl()),j.setSessionStorage(g.screenID+"Data",c,"json"),j.setSessionStorage(g.screenID+"ScrollY",b.element(d).scrollTop()))}),g.cateDepth1={},g.depthCurDispNo={},g.paramCurDispNo=n("curDispNo"),g.paramCateDepth1=n("cateDepth1"),""==n("cateDepth1")?g.cateDepth1="":g.paramCateDepth1.length>=1&&(g.cateDepth1=g.paramCateDepth1),""==n("paramCurDispNo")?g.depthCurDispNo="":g.paramCurDispNo.length>=1&&(g.depthCurDispNo=g.paramCurDispNo),b.element(document).ready(function(){o()})}]),d.directive("lotteContainer",["$window","LotteCommon",function(a,b){return{templateUrl:"/lotte/resources_dev/category/m/cate_mid_list_anglr_container.html",replace:!0,link:function(d,e,f){d.gotoBrand=function(a,b){var c=a.link_url;(""==c||null==c)&&(c="/category/m/brand_prod_list.do?upBrdNo="+a.brand_no),10>b&&(b="0"+b),location.href=d.baseLink(c)+"&tclick=m_DC_CateTpl_Clk_Brd_idx"+b},d.gotoProduct=function(a,c){location.href=d.baseLink(b.prdviewUrl)+"&curDispNo="+a.curDispNo+"&curDispNoSctCd="+a.curDispNoSctCd+"&goods_no="+a.goods_no+"&tclick=m_DC_cateTpl_Swp_Prd_idx"+c},d.showBrandCate=function(){d.sendTclick("m_DC_CateTpl_Clk_Brd_Search"),a.location.href=b.brandSearchUrl+"?"+d.baseParam+"&tclick="+d.tClickRenewalBase+"header_new_cate"},d.subCateClick=function(e){d.cateDepth1="";var f,g=d.sideCtgData.ctgAll.length;a:for(var h=0;g>h;h++){f=d.sideCtgData.ctgAll[h].lctgs.length;for(var i=0;f>i;i++)if(d.sideCtgData.ctgAll[h].lctgs[i].link==d.curDispNo){d.cateDepth1=d.sideCtgData.ctgAll[h].name;break a}}var j="&tclick="+d.tClickBase+"side_cate_catesmall_"+e.disp_no+"&curDispNoSctCd=65",k=b.cateProdListUrl+"?"+d.baseParam+"&curDispNo="+e.disp_no+"&cateDiv=MIDDLE&idx="+d.screenData.idx+"&mGrpNo="+e.mgrp_no+"&curDispNo2="+d.curDispNo+"&cateDepth1="+d.cateDepth1+"&cateDepth2="+d.subTitle+"&title="+encodeURIComponent(e.disp_nm)+j;e.sort!=c&&(k+="&sort="+e.sort),a.location.href=k},d.isTotal=!0,d.lotteSuperTodayView=function(a,b){var c="m_DC_CateTpl_Clk_Ban_idx"+b;return confirm("롯데슈퍼로 이동 후 당일 장보기 서비스 이용이 가능합니다.\n롯데슈퍼로 이동 하시겠습니까?")&&d.sendOutLink(a.img_link),d.sendTclick(c),!1}}}}])}(window,window.angular);var callDownCpn;!function(a,b,c){"use strict";var d=b.module("lotteMainPop",[]);d.controller("lotteMainPopCtrl",["$scope","$window","$location","$http","LotteCommon","LotteUtil","LotteCookie","LotteStorage","AppDownBnrService","LotteLink","commInitData",function(a,c,d,e,f,g,h,i,j,k,l){a.loadMainPopup=function(c){function d(){e.get(f.mainPopupData,{params:n}).success(function(b){if(!i.getSessionStorage("appDownBnrHide")&&!a.appObj.isApp){var d=j.appDownBnrLoadDefer;b.app_down_popup&&b.app_down_popup.length>0&&d.resolve(b.app_down_popup)}a.mainPop=b.current_page_popup,a.hideActionBar=g.isApp()&&"F"==a.mainPop.ppp_prt_tp_cd&&"20"!=c.pppTgtPgCd&&"30"!=c.pppTgtPgCd?!0:!1,0!=a.mainPop.ppp_sn&&(callDownCpn=function(){a.dupCouponIssue("88045"),a.sendTclick("m_abtest_naverbanner_01")},a.dupCouponIssue=function(b){if(a.loginInfo.isLogin)b.length>0&&e({url:f.couponRegCouponData+"?"+a.baseParam,data:"cpn_issu_no="+b,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(b){b.result=b.result.replace("\\n"," "),"undefined"!=typeof g.getParameter("cn")&&"140924"==g.getParameter("cn")&&b.result.indexOf("발급받은")>-1?(alert("이달의 앱 쿠폰을 모두 받으셨습니다. 참좋은혜택 등급 쿠폰도 확인하세요!"),location.href=f.gdBenefitUrl+"?"+a.baseParam):alert(b.result),a.popClose()}).error(function(a){"1000"==a.error.response_code?alert(a.error.response_msg):ajaxResponseErrorHandler(a,function(){})});else{var c="?"+a.baseParam;c+="&targetUrl="+encodeURIComponent(location.href),i.setSessionStorage("alliancePopupPPPSN",a.mainPop.ppp_sn),location.href=f.loginUrl+c}},a.cookieName=a.mainPop.cookie_nm,null!=i.getSessionStorage("alliancePopupPPPSN")&&a.loginInfo.isLogin?a.dupCouponIssue(a.mainPop.cpn_no):a.screenType>1&&10==c.pppTgtPgCd||(a.isOpenPop=!0,a.popOpen()),i.delSessionStorage("alliancePopupPPPSN"))}).error(function(a){console.log("Error Data :  메인팝업")})}var m=l.query,n={ppp_tgt_pg_cd:c.pppTgtPgCd,cn:m.cn,udid:m.udid,schema:m.schema};g.getParameter("testDate")&&(n.testDate=g.getParameter("testDate")),a.hideActionBar=!1,a.cookieName=null,a.appActionBarHide=function(){a.appObj.isApp&&a.hideActionBar&&(location.href="lottebridge://lotteapps/fullscreenhide")},a.appActionBarShow=function(){a.appObj.isApp&&a.hideActionBar&&(location.href="lottebridge://lotteapps/fullscreenshow")},a.popOpen=function(){b.element(".main_popup").show(),$("#wrapper").css("height","97%")},a.popClose=function(){a.sendTclick("m_RDC_popup_Close"),b.element(".main_popup").remove(),$("#wrapper").css("height","auto")},a.popToday=function(){a.sendTclick("m_RDC_popup_stoptoday"),h.setCookie(a.cookieName,"Y",1),a.popClose()},a.chkAlliancePopupObj={flag:!0,imgPath:"",deepLinkFlag:!0,tclick:""},a.closeAlliancePopup=function(){a.chkAlliancePopupObj.flag=!1},a.allianceExcuteApp=function(b){var c=a.chkAlliancePopupObj.deepLinkFlag?null:"http://m.lotte.com";a.chkAlliancePopupObj.tclick?a.chkAlliancePopupObj.tclick:null;k.appDeepLink("lotte",c,a.chkAlliancePopupObj.tclick,b)},d()}}]),d.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/)}]),d.directive("lotteMainPopup",["$window",function(b){return{templateUrl:"/lotte/resources_dev/layer/main_popup.html",controller:"lotteMainPopCtrl",replace:!0,link:function(b,c,d){b.isOpenPop=!1,b.loadMainPopup(d),b.couponBnrLink=function(c){c.isOutLink?getScope().appObj.isApp?openNativePopup("",c.lnk_url_addr):a.open(c.lnk_url_addr):location.href=b.baseLink(c.lnk_url_addr)}}}}]),d.controller("appDownBnrCtrl",["$scope","AppDownBnrService",function(a,b){a.appBnrInfo=null,b.appDownSettingData().then(function(b){a.appBnrInfo=b})}]),d.directive("appDownBnr",["$location","LotteLink","LotteStorage","AppDownBnrService",function(b,c,d,e){return{templateUrl:"/lotte/resources_dev/layer/app_down_bnr.html",controller:"appDownBnrCtrl",replace:!0,link:function(f,g,h){f.appDown_pop=function(){"./"!=e.appDownBnrInfo.linkUrl&&a.open(e.appDownBnrInfo.linkUrl)},f.appDown=function(){var a=null,d=e.appDownBnrInfo.linkUrl+"",g=""!=e.appDownBnrInfo.tclick?e.appDownBnrInfo.tclick:null;"./"!=d&&(a="http"==d.substring(0,4)?e.appDownBnrInfo.linkUrl:"/"==d.substring(0,1)?b.protocol()+"://"+b.host()+d:b.protocol()+"://"+b.host()+"/"+d),g&&f.sendTclick(g),c.appDeepLink("lotte",a,null,e.appDownBnrInfo.referrer)},f.appDownBnrClose=function(){return d.setSessionStorage("appDownBnrHide",!0),e.appDownBnrInfo.isShowFlag=!1,!1}}}}])}(window,window.angular);